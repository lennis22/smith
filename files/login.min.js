/*! optimus v0.1.0 Built at 2015-04-30 17:00 EDT */
function reportErrorMsg(){"undefined"!=typeof reporting&&(s.prop35&&""!==s.prop35&&(s.prop35=reporting_pageName+" | "+s.pageName+" | "+s.prop35),s.linkTrackVars="prop35",reporting.click()),s.prop35=""}function reportSuccessMsg(){reporting_pageName="login",s.pageName="login",s.eVar1="Done-Login",s.prop35="",s.prop36=""}$(function(){$("[autofocus]").focus()}),angular.module("login",["checkbox","config","userLogin","alertBanner","oolCookie","ctaArrowLink","onetCookies","ngCookies","cpcMobileHandler"]).controller("LoginCtrl",["$scope","userLogin","$location","ooluser","Cookies","$cookies","CpcMobileHandler",function(a,b,c,d,e,f,g){for(var h=window.location.search.substr(1).split("&"),i={},j=0,k="";k=h[j];j++){var l=h[j].split("=");i[l[0]]=l[1]}a.isCpc=g.isCpcCheck(),a.disableRememberMe=!1,a.isCpc===!0&&($("#header-wrapper").addClass("hide"),$("#is-cpc-header-wrapper").addClass("show"),$("#is-not-cpc-common-footer-help").addClass("hide"),$("#is-not-cpc-hr").addClass("hide"),$("#is-not-cpc-footer-social-icon").addClass("hide"),$("#is-not-cpc-footer-site-links").addClass("hide"),$("#is-not-cpc-footer-social-icon-phone").addClass("hide"),$("#is-not-cpc-icon-logo").addClass("hide"),$("#is-cpc-footer-site-links").addClass("show"),$("#is-cpc-icon-logo").addClass("show")),a.failedLogin=!1;var m={id:i.id||d.optimumId,password:"",remember:!1,reauth:i.reauth};(void 0===m.id||null===m.id)&&(m.id=void 0===f.loginID||null===f.loginID?e.getCookie("loginID"):f.loginID,document.cookie="loginID=; path=/; expires=Thu, 01 Jan 1970 00:00:00 GMT",void 0===m.id||null===m.id?a.passwordResetSucc=!1:(reporting_pageName="Done-Login",s.prop35="",s.prop36="",a.passwordResetSucc=!0,$(".loginpass").focus(),$(window).scrollTop(0))),a.model=m;var n=null;a.errorMessageConfig={type:"major",message:""},a.passSuccessMessageConfig={type:"success",message:"Your password has been reset. Please sign in with your new password."},a.submit=function(){var c=f.login_failure;c||(c=e.getCookie("login_failure")),a.failedLogin=!1,a.passwordResetSucc=!1;var d=m.password;m.password||($("#loginPagePassword").val()?d=$("#loginPagePassword").val():$("#homeLoginFormPassword").val()&&(d=$("#homeLoginFormPassword").val())),n=m.id,m.id||$("#loginPageUsername").val()&&(n=$("#loginPageUsername").val());var g=i.referer?i.referer:"";g+=window.location.hash,g=g.replace("#/#","~~"),b.authenticate(n,d,g,m.remember,m.reauth,i.area).then(function(a){a=a.replace("~~","#/#"),a=a.replace("%7E%7E","#/#"),window.location=a},function(a){o(a)})};var o=function(b){switch(b.code){case"BAD_CREDENTIALS":a.errorMessageConfig.message=a.model.reauth?"You need to enter the correct password to continue.":p(b),q(b,a.errorMessageConfig);break;case"TEMP_BAN":var c=b.ban_info.ban_time_left/6e4;a.errorMessageConfig.message=Math.round(c)>1?"Your account has been locked as a result of too many failed sign in attempts. Please try again in "+Math.round(c)+" minutes.":"Your account has been locked as a result of too many failed sign in attempts. Please try again in "+Math.round(c)+" minute.",s.prop35="Account locked, temporary ban";break;case"EXPIREDPWD":a.errorMessageConfig.message="The password you attempted to use has expired. Please reset your password again.",a.errorMessageConfig.ctas=[{label:"Reset your current password",href:"/reset-password/",onclick:"reporting.trackClick(this,'Login | Expired Password')"}],s.prop35="Expired Password";break;case"PAVED_ACCOUNT":a.errorMessageConfig.message="At Optimum, your security and privacy are important to us. Through routine monitoring, we've identified some unusual activity linked to your Optimum ID and password. As a safety precaution, we have disabled your password.",a.errorMessageConfig.ctas=[{label:"Create a more secure password",href:"/reset-password/",onclick:"reporting.trackClick(this,'Login | Paved Account')"}],s.prop35="Paved Account";var d=new Date;d.setTime(d.getTime()+18e5);var f=d.toGMTString();void 0!==n&&null!==n?e.setCookie("pavedAccount","true/"+n,{expires:f,path:"/"}):e.setCookie("pavedAccount","true",{expires:f,path:"/"});break;case"WEST_USER":a.errorMessageConfig.message="We are now forwarding you to the Optimum.net page for customers in our Western service areas.",document.cookie="site=oldchecked;path=/;domain=.optimum.net;",document.cookie="sr2=;path=/;domain=.optimum.net;expires=Thu, 01 Jan 1970 00:00:00 GMT",document.cookie="westov=1;path=/;domain=.optimum.net",setTimeout(r,3500),s.prop35="West User";break;default:a.errorMessageConfig.message="We're sorry, but an error has occurred. Please try again.",s.prop35="Server Error"}a.failedLogin=!0;var g=$("#header-wrapper").offset().top;$("html,body").animate({scrollTop:g},"slow"),reportErrorMsg()},p=function(a){var b=a.attempts_remaining,c=a.failed_attempts;return 1===b?(s.prop35="Bad Credentials Locked Warning","Warning: Your account will be locked if you enter incorrect sign in information again."):c>=3&&6>=c?(s.prop35="Bad Credentials","Incorrect Optimum ID or Password. Having trouble remembering your login?"):(s.prop35="Bad Credentials","Incorrect Optimum ID or password.")},q=function(a,b){(a.failed_attempts>=3||a.attempts_remaining<=3)&&(b.ctas=[{label:"Reset your password",href:"/reset-password/"}])},r=function(){window.location.replace("https://signin.optimum.net/signin?referer=http%3A%2F%2Fwest.optimum.net%2F")},t=f.login_failure;if(t||(t=e.getCookie("login_failure")),t){document.cookie="login_failed=;path=/login;domain=."+document.domain+";expires=Thu, 01 Jan 1970 00:00:00 GMT;max-age=-1";var u=JSON.parse(t);u.code=u.status.replace("LOGIN_RESP_FAILURE_",""),a.passwordResetSucc||o(u)}var v=f.RememberMe;v||(v=e.getCookie("RememberMe")),v&&(a.disableRememberMe=!0,m.remember=!0),$(document).ready(function(){$(".loginid").keyup(function(a){var b=a.keyCode?a.keyCode:a.which;13===b&&$(".loginpass").focus()})})}]);