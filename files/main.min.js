/*! optimus v0.1.0 Built at 2015-04-30 17:00 EDT */
function exists(a){return"undefined"!=typeof a&&null!==a}function getRandomInt(a,b){return Math.floor(Math.random()*(b-a+1))+a}function isMobile(){return/Android|Kindle|Silk|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)}function convertNodeListToArray(a){for(var b=[],c=0;c<a.length;c++)b.push(a[c]);return b}function getDurationDisplay(a){var b=[],c=moment(a),d=moment.duration(c.valueOf()).hours(),e=moment.duration(c.subtract(d,"hour").valueOf()).minutes();return d>0&&b.push(d+"h"),e>0&&b.push(e+"m"),b.join(" ")}function trackHistoryURL(){function a(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){var e=$.trim(c[d]);if(0===e.indexOf(b))return e.substring(b.length,e.length)}return""}function b(a,b){document.cookie=a+"="+b+";path=/;"}var c=[];null!==a("historyURL")&&void 0!==a("historyURL")&&""!==a("historyURL")&&(c=a("historyURL").toString().split(" ")),console.log(c);var d=escape(document.URL);if(null!==a("historyURL")&&void 0!==a("historyURL")&&""!==a("historyURL")){if(d!==c[c.length-1]){if($.inArray(d,c)>-1){var e=$.inArray(d,c);c.splice(e,1),c.push(d)}else c.push(d);c.length>maxHistoryURLSize&&c.shift()}b("historyURL",c.join(" "))}else c[0]=escape(document.URL),b("historyURL",c.join(" "));console.log(c)}function JScrollPaneVertical(a,b){function c(a,b){var e,g,h,i,l,m=!1,n=!1;G=a,void 0===H&&(console.log(b),i=b.scrollTop(),l=b.scrollLeft(),b.css({overflow:"hidden",padding:0}),I=b.innerWidth()+ib,J=b.innerHeight(),b.width(I),H=$('<div class="jspPane" />').css("padding",hb).append(b.children()),K=$('<div class="jspContainer" />').css({width:I+"px",height:J+"px"}).append(H).appendTo(b)),H.css("overflow","auto"),L=a.contentWidth?a.contentWidth:H[0].scrollWidth,M=H[0].scrollHeight,H.css("overflow",""),N=L/I,O=M/J,P=O>1,Q||P?(b.addClass("jspScrollable"),e=G.maintainPosition&&(T||W),e&&(g=v(),h=w()),d(),f(),e&&(t(n?L-I:g,!1),s(m?M-J:h,!1)),y(),E(),G.enableKeyboardNavigation&&A(),G.clickOnTrack&&j(),C(),G.hijackInternalLinks&&D()):(b.removeClass("jspScrollable"),H.css({top:0,left:0,width:K.width()-ib}),z(),B(),k()),G.autoReinitialise&&!gb?gb=setInterval(function(){c(G)},G.autoReinitialiseDelay):!G.autoReinitialise&&gb&&clearInterval(gb),i&&(b.scrollTop(0),s(i,!1)),l&&(b.scrollLeft(0),t(l,!1)),b.trigger("jsp-initialised",[P])}function d(){P&&(K.append($('<div class="jspVerticalBar" />').append($('<div class="jspCap jspCapTop" />'),$('<div class="jspTrack" />').append($('<div class="jspDrag" />').append($('<div class="jspDragTop" />'),$('<div class="jspDragBottom" />'))),$('<div class="jspCap jspCapBottom" />'))),X=K.find(">.jspVerticalBar"),Y=X.find(">.jspTrack"),R=Y.find(">.jspDrag"),G.showArrows&&(bb=$('<a class="jspArrow jspArrowUp" />').bind("mousedown.jsp",h(0,-1)).bind("click.jsp",x),cb=$('<a class="jspArrow jspArrowDown" />').bind("mousedown.jsp",h(0,1)).bind("click.jsp",x),G.arrowScrollOnHover&&(bb.bind("mouseover.jsp",h(0,-1,bb)),cb.bind("mouseover.jsp",h(0,1,cb))),g(Y,G.verticalArrowPositions,bb,cb)),_=J,K.find(">.jspVerticalBar>.jspCap:visible,>.jspVerticalBar>.jspArrow").each(function(){_-=$(this).outerHeight()}),R.hover(function(){R.addClass("jspHover")},function(){R.removeClass("jspHover")}).bind("mousedown.jsp",function(a){$("html").bind("dragstart.jsp selectstart.jsp",x),R.addClass("jspActive");var b=a.pageY-R.position().top;return $("html").bind("mousemove.jsp",function(a){m(a.pageY-b,!1)}).bind("mouseup.jsp mouseleave.jsp",l),!1}),e())}function e(){Y.height(_+"px"),T=0,Z=G.verticalGutter+Y.outerWidth(),H.width(I-Z-ib);try{0===X.position().left&&H.css("margin-left",Z+"px")}catch(a){}}function f(){M=H.outerHeight(),O=M/J,P&&(ab=Math.ceil(1/O*_),ab>G.verticalDragMaxHeight?ab=G.verticalDragMaxHeight:ab<G.verticalDragMinHeight&&(ab=G.verticalDragMinHeight),R.height(ab-8+"px"),S=_-ab,n(T))}function g(a,b,c,d){var e,f="before",g="after";"os"===b&&(b=/Mac/.test(navigator.platform)?"after":"split"),b===f?g=b:b===g&&(f=b,e=c,c=d,d=e),a[f](c)[g](d)}function h(a,b,c){return function(){return i(a,b,this,c),this.blur(),!1}}function i(a,b,c,d){c=$(c).addClass("jspActive");var e,f,g=!0,h=function(){0!==a&&jb.scrollByX(a*G.arrowButtonSpeed),0!==b&&jb.scrollByY(b*G.arrowButtonSpeed),f=setTimeout(h,g?G.initialDelay:G.arrowRepeatFreq),g=!1};h(),e=d?"mouseout.jsp":"mouseup.jsp",d=d||$("html"),d.bind(e,function(){c.removeClass("jspActive"),f&&clearTimeout(f),f=null,d.unbind(e)})}function j(){k(),P&&Y.bind("mousedown.jsp",function(a){if(void 0===a.originalTarget||a.originalTarget===a.currentTarget){var b,c=$(this),d=c.offset(),e=a.pageY-d.top-T,f=!0,g=function(){var d=c.offset(),i=a.pageY-d.top-ab/2,j=J*G.scrollPagePercent,k=S*j/(M-J);if(0>e)T-k>i?jb.scrollByY(-j):m(i);else{if(!(e>0))return h(),void 0;i>T+k?jb.scrollByY(j):m(i)}b=setTimeout(g,f?G.initialDelay:G.trackClickRepeatFreq),f=!1},h=function(){b&&clearTimeout(b),b=null,$(document).unbind("mouseup.jsp",h)};return g(),$(document).bind("mouseup.jsp",h),!1}})}function k(){db&&db.unbind("mousedown.jsp"),Y&&Y.unbind("mousedown.jsp")}function l(){$("html").unbind("dragstart.jsp selectstart.jsp mousemove.jsp mouseup.jsp mouseleave.jsp"),R&&R.removeClass("jspActive"),U&&U.removeClass("jspActive")}function m(a,b){P&&(0>a?a=0:a>S&&(a=S),void 0===b&&(b=G.animateScroll),b?jb.animate(R,"top",a,n):(R.css("top",a),n(a)))}function n(b){void 0===b&&(b=R.position().top),K.scrollTop(0),T=b;var c=0===T,d=T===S,e=b/S,f=-e*(M-J);(kb!==c||mb!==d)&&(kb=c,mb=d,a.trigger("jsp-arrow-change",[kb,mb,lb,nb])),q(c,d),H.css("top",f),a.trigger("jsp-scroll-y",[-f,c,d]).trigger("scroll")}function o(a,b){Q&&(0>a?a=0:a>V&&(a=V),void 0===b&&(b=G.animateScroll),b?jb.animate(U,"left",a,p):(U.css("left",a),p(a)))}function p(b){void 0===b&&(b=U.position().left),K.scrollTop(0),W=b;var c=0===W,d=W===V,e=b/V,f=-e*(L-I);(lb!==c||nb!==d)&&(lb=c,nb=d,a.trigger("jsp-arrow-change",[kb,mb,lb,nb])),r(c,d),H.css("left",f),a.trigger("jsp-scroll-x",[-f,c,d]).trigger("scroll")}function q(a,b){G.showArrows&&(bb[a?"addClass":"removeClass"]("jspDisabled"),cb[b?"addClass":"removeClass"]("jspDisabled"))}function r(a,b){G.showArrows&&(eb[a?"addClass":"removeClass"]("jspDisabled"),fb[b?"addClass":"removeClass"]("jspDisabled"))}function s(a,b){var c=a/(M-J);m(c*S,b)}function t(a,b){var c=a/(L-I);o(c*V,b)}function u(a,b,c){var d,e,f,g,h,i,j,k,l,m=0,n=0;try{d=$(a)}catch(o){return}for(e=d.outerHeight(),f=d.outerWidth(),K.scrollTop(0),K.scrollLeft(0);!d.is(".jspPane");)if(m+=d.position().top,n+=d.position().left,d=d.offsetParent(),/^body|html$/i.test(d[0].nodeName))return;g=w(),i=g+J,g>m||b?k=m-G.horizontalGutter:m+e>i&&(k=m-J+e+G.horizontalGutter),isNaN(k)||s(k,c),h=v(),j=h+I,h>n||b?l=n-G.horizontalGutter:n+f>j&&(l=n-I+f+G.horizontalGutter),isNaN(l)||t(l,c)}function v(){return-H.position().left}function w(){return-H.position().top}function x(){return!1}function y(){H.find(":input,a").unbind("focus.jsp").bind("focus.jsp",function(a){u(a.target,!1)})}function z(){H.find(":input,a").unbind("focus.jsp")}function A(){function b(){var a=W,b=T;switch(c){case 40:jb.scrollByY(G.keyboardSpeed,!1);break;case 38:jb.scrollByY(-G.keyboardSpeed,!1);break;case 34:case 32:jb.scrollByY(J*G.scrollPagePercent,!1);break;case 33:jb.scrollByY(-J*G.scrollPagePercent,!1);break;case 39:jb.scrollByX(G.keyboardSpeed,!1);break;case 37:jb.scrollByX(-G.keyboardSpeed,!1)}return d=a!==W||b!==T}var c,d,e=[];P&&e.push(X[0]),H.focus(function(){a.focus()}),a.attr("tabindex",0).unbind("keydown.jsp keypress.jsp").bind("keydown.jsp",function(a){if(a.target===this||e.length&&$(a.target).closest(e).length){var f=W,g=T;switch(a.keyCode){case 40:case 38:case 34:case 32:case 33:case 39:case 37:c=a.keyCode,b();break;case 35:s(M-J),c=null;break;case 36:s(0),c=null}return d=a.keyCode===c&&f!==W||g!==T,!d}}).bind("keypress.jsp",function(a){return a.keyCode===c&&b(),!d}),G.hideFocus?(a.css("outline","none"),"hideFocus"in K[0]&&a.attr("hideFocus",!0)):(a.css("outline",""),"hideFocus"in K[0]&&a.attr("hideFocus",!1))}function B(){a.attr("tabindex","-1").removeAttr("tabindex").unbind("keydown.jsp keypress.jsp")}function C(){if(location.hash&&location.hash.length>1){var a,b,c=escape(location.hash.substr(1));try{a=$("#"+c+', a[name="'+c+'"]')}catch(d){return}a.length&&H.find(c)&&(0===K.scrollTop()?b=setInterval(function(){K.scrollTop()>0&&(u(a,!0),$(document).scrollTop(K.position().top),clearInterval(b))},50):(u(a,!0),$(document).scrollTop(K.position().top)))}}function D(){$(document.body).data("jspHijack")||($(document.body).data("jspHijack",!0),$(document.body).delegate("a[href*=#]","click",function(a){var b,c,d,e,f,g,h=this.href.substr(0,this.href.indexOf("#")),i=location.href;if(-1!==location.href.indexOf("#")&&(i=location.href.substr(0,location.href.indexOf("#"))),h===i){b=escape(this.href.substr(this.href.indexOf("#")+1));try{c=$("#"+b+', a[name="'+b+'"]')}catch(j){return}c.length&&(d=c.closest(".jspScrollable"),e=d.data("jsp"),e.scrollToElement(c,!0),d[0].scrollIntoView&&(f=$(window).scrollTop(),g=c.offset().top,(f>g||g>f+$(window).height())&&d[0].scrollIntoView()),a.preventDefault())}}))}function E(){var a,b,c,d,e,f=!1;K.unbind("touchstart.jsp touchmove.jsp touchend.jsp click.jsp-touchclick").bind("touchstart.jsp",function(g){var h=g.originalEvent.touches[0];a=v(),b=w(),c=h.pageX,d=h.pageY,e=!1,f=!0}).bind("touchmove.jsp",function(g){if(f){var h=g.originalEvent.touches[0],i=W,j=T;return jb.scrollTo(a+c-h.pageX,b+d-h.pageY),e=e||Math.abs(c-h.pageX)>5||Math.abs(d-h.pageY)>5,i===W&&j===T}}).bind("touchend.jsp",function(){f=!1}).bind("click.jsp-touchclick",function(){return e?(e=!1,!1):void 0})}function F(){var b=w(),c=v();a.removeClass("jspScrollable").unbind(".jsp"),a.replaceWith(originalElement.append(H.children())),originalElement.scrollTop(b),originalElement.scrollLeft(c),gb&&clearInterval(gb)}var G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,_,ab,bb,cb,db,eb,fb,gb,hb,ib,jb=this,kb=!0,lb=!0,mb=!1,nb=!1;"border-box"===a.css("box-sizing")?(hb=0,ib=0):(hb=a.css("paddingTop")+" "+a.css("paddingRight")+" "+a.css("paddingBottom")+" "+a.css("paddingLeft"),ib=(parseInt(a.css("paddingLeft"),10)||0)+(parseInt(a.css("paddingRight"),10)||0)),$.extend(jb,{reinitialise:function(a){a=$.extend({},G,a),c(a)},scrollToElement:function(a,b,c){u(a,b,c)},scrollTo:function(a,b,c){t(a,c),s(b,c)},scrollToX:function(a,b){t(a,b)},scrollToY:function(a,b){s(a,b)},scrollToPercentX:function(a,b){t(a*(L-I),b)},scrollToPercentY:function(a,b){s(a*(M-J),b)},scrollBy:function(a,b,c){jb.scrollByX(a,c),jb.scrollByY(b,c)},scrollByX:function(a,b){var c=v()+Math[0>a?"floor":"ceil"](a),d=c/(L-I);o(d*V,b)},scrollByY:function(a,b){var c=w()+Math[0>a?"floor":"ceil"](a),d=c/(M-J);m(d*S,b)},positionDragX:function(a,b){o(a,b)},positionDragY:function(a,b){m(a,b)},animate:function(a,b,c,d){var e={};e[b]=c,a.animate(e,{duration:G.animateDuration,easing:G.animateEase,queue:!1,step:d})},getContentPositionX:function(){return v()},getContentPositionY:function(){return w()},getContentWidth:function(){return L},getContentHeight:function(){return M},getPercentScrolledX:function(){return v()/(L-I)},getPercentScrolledY:function(){return w()/(M-J)},getIsScrollableV:function(){return P},getContentPane:function(){return H},scrollToBottom:function(a){m(S,a)},hijackInternalLinks:$.noop,destroy:function(){F()}}),c(b,a),G=$.extend({},options,G),$.each(["arrowButtonSpeed","trackClickSpeed","keyboardSpeed"],function(){G[this]=G[this]||G.speed})}Function.prototype.bind||(Function.prototype.bind=function(){var a=this,b=Array.prototype.slice.call(arguments),c=b.shift();return function(){return a.apply(c,b.concat(Array.prototype.slice.call(arguments)))}}),_.mixin({noop:function(){},nextCycle:function(a){return _.delay(a,0)},isDefined:function(a){return!_.isUndefined(a)},firstDefined:function(){return _.find(arguments,_.isDefined)},addCssClass:function(a,b){return _.contains(a,b)?a:String(a)+" "+$.trim(String(b))},addCssClassStrict:function(a,b){return _.isString(a)?_.contains(a,b)?a:a+" "+$.trim(String(b)):$.trim(b)},replaceArrayItems:function(a,b){return a.length=0,_.each(b,function(b){a.push(b)}),a},toggle:function(a,b){return _.isDefined(b)?Boolean(b):!a},initialUntilItem:function(a,b,c){c=_.firstDefined(c,!1);var d=_.indexOf(a,b);return a=convertNodeListToArray(a),a.slice(0,d+(c?1:0))},createObject:function(a){function b(){}return Object.create?Object.create(a):(b.prototype=a,new b)},decorate:function(a,b){return a=_.createObject(a),_.extend(a,b),a},arrayify:function(a){return _.isArray(a)?a:[a]},vsprintf:function(a,b){return vsprintf(a,b)},uniquePush:function(a,b){return _.contains(a,b)||a.push(b),a},chunk:function(a,b){if(_.isUndefined(b))return a;if(1>b)throw new Error("chunkSize must be a whole number");var c,d=[];return _.each(a,function(a,e){0===e%b&&(d.push([]),c=d.length-1),d[c].push(a)}),d},mapDeep:function(a,b){return _.isArray(a)?_.map(a,function(a){return _.mapDeep(a,b)}):_.isObject(a)?_.reduce(a,function(a,c,d){return a[d]=_.mapDeep(c,b),a},{}):b(a)}}),angular.module("alertDrawerMock",[]).controller("AlertDrawerMockCtrl",["$scope","AlertAPI",function(a,b){var c={isOpen:!1};a.drawerModel=c;var d=this;return a.$watch(function(){return b.type},function(){d.currentAlert=b.type}),a.$watch(function(){return b.index},function(){d.currentAlertIndex=b.index,null===d.currentAlertIndex&&(c.isOpen=!1)}),a.AlertDrawerMockCtrl=d}]).constant("MockDataOutage",{message:"Your TV, Phone, and Internet is up and running properly. But if you did encounter a service disruption in the future, there are a few simple fixes you could try.",status:"working"}).constant("MockDataAlerts",{_links:{self:{href:"/alert"}},_embedded:{alerts:[{_links:{self:{href:"/alert/cms-2214"}},corpIds:[7801,7802,7803,7804,7806,7808,7816,7817,7818,7819,7828,7836,7837,7839,7840,7844,7848,7858,7862,7864,7865,7866,7867,7868,7869,7870,7872,7873,7874,7875,7876,7877,7881,7882,7883,7896],date:13679649e5,id:2214,regions:["New York","Long Island","New Jersey","Connecticut","Westchester","The Bronx","Hudson Valley","Brooklyn"],summary:"Test Alert",title:"Service Outage"},{_links:{self:{href:"/alert/cms-2405"}},corpIds:[7801,7802,7803,7804,7806,7808,7816,7817,7818,7819,7828,7836,7837,7839,7840,7844,7848,7858,7862,7864,7865,7866,7867,7868,7869,7870,7872,7873,7874,7875,7876,7877,7881,7882,7883,7896],date:13680477e5,id:2405,regions:["New York","Long Island","New Jersey","Connecticut","Westchester","The Bronx","Hudson Valley","Brooklyn","LI"],summary:"This is just a summary of the alert, not the body of the alert.",title:"Alert With Body"},{_links:{self:{href:"/alert/cms-10006"}},corpIds:[7801,7802,7803,7804,7806,7808,7816,7817,7818,7819,7828,7836,7837,7839,7840,7844,7848,7858,7862,7864,7865,7866,7867,7868,7869,7870,7872,7873,7874,7875,7876,7877,7881,7882,7883,7896],date:13730598e5,id:10006,regions:["New York","Long Island","New Jersey","Connecticut","Westchester","The Bronx","Hudson Valley","Brooklyn","LI"],summary:"Test alert. Wooooooooh!",title:"Test"}]}}),angular.module("alertDrawer",["alertsService","ctaArrowLink"]).run(["$rootScope",function(a){var b={};a.once=function(a,c){return a in b||(b[a]=_.once(c)),b[a]}}]).factory("AlertAPI",function(){return{type:null,index:null,currentAlert:function(a){this.type=a},currentAlertIndex:function(a){this.index=a},clear:function(){this.type=null,this.index=null}}}).directive("alertDrawer",function(){return{restrict:"EA",scope:{},transclude:!0,replace:!0,controller:"AlertDrawerCtrl",templateUrl:"/parts/alert-drawer/alert-drawer.html",link:function(){}}}).controller("AlertDrawerCtrl",["$scope","$q","AlertAPI","Alerts","Outage","$cookies",function(a,b,c,d,e,f){function g(){if(l(),o.splice(n,1),o.length)j(m(n)?n:o.length-1),a.api.currentAlertIndex(o.length);else{a.currentAlert=null,a.api.clear();var b=window.location.hostname.replace(/^[\d\D]*?([^\.]+\.[^\.]+)\.?$/,"$1");document.cookie="alrtDrwr=closed;path=/;domain="+b+";"+escape("expires=Sun, 31 Dec 2020 00:00:01 GMT")}}function h(){return 2===o.length?"1 more alert":o.length-1+" more alerts"}function i(){j(m(n+1)?n+1:0)}function j(a){n=a,k(a)}function k(b){o[b]&&(a.currentAlert=o[b],a.api.currentAlert(a.currentAlert.type))}function l(){s&&(s.linkTrackEvents="event3",s.events="event3",s.tl())}function m(a){return a>=0&&a<=o.length-1}d.getAlert=a.$root.once("Alerts",d.getAlert);var n=0,o=[],p={major:"warning-sign",minor:"time"};a.api=c,d.getCombinedAlerts().then(_.once(function(b){if(o=b.alerts,a.alerts=o,0!==o.length){var c=f.alertIds,d=[];void 0!==c&&(c=JSON.stringify(c).replace(/"/g,""),d=c.split(",").map(Number));var e=[];_.each(a.alerts,function(a){void 0!==a.id&&null!==a.id&&e.push(a.id)});for(var g=window.location.hostname.replace(/^[\d\D]*?([^\.]+\.[^\.]+)\.?$/,"$1"),h=!0,i=0;i<e.length;i++)if(_.contains(d,e[i])===!1){h=!1;break}h||(document.cookie="alrtDrwr=true;path=/;domain="+g+";"+escape("expires=Sun, 31 Dec 2020 00:00:01 GMT")),document.cookie="alertIds="+e+";path=/;domain="+g+";"+escape("expires=Sun, 31 Dec 2020 00:00:01 GMT")}a.api.currentAlertIndex(o.length),k(n)})),a.reloadOutageRoute=function(){var b=window.location.href,c=b.indexOf("/support"),d=b.substring(c);d===a.currentAlert.link&&-1!==window.location.href.indexOf("#")&&window.location.reload();var e=window.location.hostname.replace(/^[\d\D]*?([^\.]+\.[^\.]+)\.?$/,"$1");document.cookie="alrtDrwr=false;path=/;domain="+e+";"+escape("expires=Sun, 31 Dec 2020 00:00:01 GMT"),window.location.href=a.currentAlert.link},a.selectNextAlert=i,a.removeAlert=g,a.lookupIconForAlertType=p,a.lookupImgForOutageType=e.outageIcon,a.alerts=o,a.moreAlertsWording=h,a.currentAlert=null,a.drawerIsOpen=!1}]),angular.module("alertMulti",["alertBanner"]).directive("alertMulti",[function(){return{templateUrl:"/parts/alert-multi/alert-multi-template.html",restrict:"EA",scope:{alerts:"=alerts",update:"=update"},link:function(a){function b(){switch(type="major",a.currentAlertConfig.type&&(type=a.currentAlertConfig.type),a.currentBorderTheme="border-"+type,a.currentIconTheme="icons-"+type,a.currentPrevValue="",a.currentNextValue="",type){case"minor":a.currentAlertTheme="theme-secondary",$(".icons-color").addClass("icons-minor");break;case"success":a.currentAlertTheme="theme-success",$(".icons-color").addClass("icons-success");break;default:a.currentAlertTheme="theme-alert",$(".icons-color").addClass("icons-major")}a.currentAlert===a.totalAlerts&&(a.currentNextValue=" not-visible"),1===a.currentAlert&&(a.currentPrevValue=" not-visible")}defaultObj={message:"test",type:"minor",ctas:[],icon:"warning-sign"},a.currentAlertConfig=defaultObj,a.$watch("update",function(){if(console.log("calling alerts"),a.alerts&&a.alerts.length>0){var c=function(a,b){return a&&!b?-1:b&&!a?1:a.actionAlert?-1:b.actionAlert?1:a.type&&!b.type?-1:!a.type&&b.type?1:"success"===a.type&&"success"!==b.type?-1:"success"!==a.type&&"success"===b.type?1:a.priority&&b.priority?a.priority>b.priority?1:-1:"major"===a.type&&"major"!==b.type?-1:"major"!==a.type&&"major"===b.type?1:-1};a.alerts=a.alerts.sort(c),a.showAlerts=!0,a.totalAlerts=a.alerts.length,a.currentAlert=1,a.getCurrentAlertConfig(),b()}else a.showAlerts=!1;$(".linked-anchor.account-activity").live("click",function(){window.location="/pay-bill/account-activity"}),$(".linked-anchor.automatic-payments").live("click",function(){window.location="/pay-bill/automatic-payments"}),$(".linked-anchor.payment-options").live("click",function(){window.location="/pay-bill/payment-options"}),$(".linked-anchor.manage-payments").live("click",function(){window.location="/pay-bill/manage-payments"})}),a.getCurrentAlertConfig=function(){a.alerts&&a.alerts.length>0&&a.alerts.length>a.currentAlert-1?a.currentAlertConfig=a.alerts[a.currentAlert-1]:(console.log("not inside"),a.currentAlertConfig=defaultObj,a.showAlerts=!1),b()},a.nextAlert=function(){a.currentAlert<a.totalAlerts&&(a.currentAlert++,a.getCurrentAlertConfig())},a.prevAlert=function(){a.currentAlert>1&&(a.currentAlert--,a.getCurrentAlertConfig())},a.currentTotalText=function(){return""+a.currentAlert+" of "+a.totalAlerts}}}}]),angular.module("alertBanner",["ctaArrowLink","alertHelpers"]).directive("alertBanner",["bannerConverter",function(a){return{restrict:"EA",templateUrl:"/parts/alerts/alert-banner-template.html",replace:!0,scope:!0,link:function(b,c,d){if(b.model={},_.isDefined(d.config))b.$watch(d.config,function(c){b.model=a(_.clone(c))},!0);else{var e={},f=["title","message","icon","img","type","ctas"];_.each(f,function(c){_.isDefined(d[c])&&b.$watch(d[c],function(d){e[c]=d,b.model=a(_.clone(e))})})}}}}]).factory("bannerConverter",["messageConverter",function(a){function b(a){return _.isString(a.icon)&&a.icon&&"icon-"!==a.icon.substr(0,5)&&(a.icon="icon-"+a.icon),a}return function(c){return b(a(c))}}]),setTimeout(function(){$(".dot.dot--dark-overlay").addClass("dotpie")},2e3),angular.module("alertHelpers",[]).factory("messageConverter",[function(){var a={major:{theme:"theme-alert",icon:"icon-warning-sign"},minor:{theme:"theme-secondary",icon:"icon-pushpin"},resetmajor:{theme:"theme-alert reset-password-exclamation",icon:"icon-exclamation-sign"},success:{theme:"theme-success",icon:"icon-ok"},primary:{theme:"theme-primary",icon:"icon-ok"}};return function(b){function c(a){return a={title:a},d(a)}function d(b){if(b.ctas=b.ctas||[],b.type){var c=["major","minor","success","primary","resetmajor"];if(!_.contains(c,b.type))throw"You asked for an alert model type of "+b.type+", but it must be one "+c.join(",")+"."}else b.type="major";return!b.title&&b.message&&(b.title=b.message,delete b.message),b.icon||b.img||(b.icon=a[b.type].icon),b.cssClass=_.addCssClassStrict(b.cssClass,a[b.type].theme),b}if(_.isString(b))return c(b);if(_.isPlainObject(b))return d(b);throw"alert-helpers.js' messageConverter needs 'newConfig' to be a string or a plain object, but was instead: "+b}}]),angular.module("alertModal",["messages","alertHelpers"]).factory("alertModal",["$timeout","messageModal","messageConverter",function(a,b,c){var d=function(){function d(){f.length&&!g&&(g=!0,f.shift().open().then(function(){a(function(){g=!1,d()},500)}))}var e=this,f=[],g=!1;e.create=function(a){var e=b(c(a));return f.push(e),d(),e.willClose.promise}};return new d}]),angular.module("blockError",[]).directive("blockError",[function(){return{restrict:"EA",templateUrl:"/parts/block-error/block-error-template.html",scope:{fallBacklink:"@link",topic:"@topic"},link:function(){}}}]),angular.module("carousels",["dots","if","dvrRecord","ellipsis","poster","imgAlt","hover","isViewportSize"]).directive("carousel",["$timeout","limitToFilter","isViewportSize",function(a,b,c){return{restrict:"E",scope:{showHide:"=show",localItems:"=items",showMock:"=mock",isLazy:"=lazy",positionWithPosition:"=positionWithPosition",isIndented:"=indent",extraIndent:"=extraIndent",maxSets:"=maxSets",scrollByPixels:"=scrollByPixels",type:"=type"},transclude:!0,replace:!1,templateUrl:"/parts/carousels/carousels-tmpl.html",link:function(d,e){function f(){ib(),hb&&(Q.items=Q.generateMockElements(),ab=Q.items.length),p(),d.$emit("carouselEvent",{eventName:"load",eventTarget:$(e)}),k()?(S.addClass("art"),S.removeClass("block"),Q.isArtwork=!0):(S.addClass("block"),S.removeClass("art"),Q.isArtwork=!1),O(),i()}function g(){console.log("mock: test callback action")}function h(){var a=!1;(d.localItems[0]!==d.items[0]||d.localItems.length<d.items.length)&&(a=!0),Q.items=Q.localItems,O(),i(),a&&N()}function i(){var a;try{delete Q.maxItems}catch(b){}if(null!==(a=l())){var c=0,d=0,e=v();_.each(Q.items,function(b,f){return c+=(b.itemWidth||140)+(k()?28:0),c>e&&(d++,c=c-(k()?28:0)<=e?0:(b.itemWidth||140)+(k()?28:0)),d>=a?(Q.maxItems=f,!1):void 0})}}function j(){a(function(){var a,b=S.width();k()?(Q.isArtwork=!0,S.addClass("art"),S.removeClass("block"),angular.isNumber(b)&&b>100&&(a=Q.getLimitedItems().length*S.find(".item").outerWidth(!0))>10?T.width(a+10+"px"):T.width(""),T.height()<S.find(".poster").height()&&(T.css("height",S.find(".poster").height()),V.css("top",0),W.css("top",0))):(Q.isArtwork=!1,S.addClass("block"),S.removeClass("art"),T.width(""),T.css("max-height",fb)),p()})}function k(){var a=!1;return"block"===Q.type?!1:"art"===Q.type?!0:($.each(Q.items,function(b,c){return c.artwork?(a=!0,!1):void 0}),a)}function l(){var a=Q.maxSets;return angular.isString(a)&&a.match(/^\d+$/)&&(a=parseInt(a,10)),angular.isNumber(a)&&a>0?a:null}function m(a){return parseInt(a.toString().match(/-(\d+)$/)[1],10)}function n(a,b){if(a.attr("id")){var c=Q.getLimitedItems()[m(a.attr("id"))];return b===!0?c.secondItem.action:c.action}console.warn("warning, item.attr(id) is undefined")}function o(a){return Q.getLimitedItems()[m(a.parents(".item").attr("id"))].buttons[a.attr("value")].action}function p(){gb=Q.isIndented?0===Q.getLimitedItems().length?[]:new Array(1+Math.ceil((T.width()-A(z()))/v())):0===Q.getLimitedItems().length?[]:new Array(Math.ceil(T.width()/v())),d.dots=gb}function q(a,b){var c="first"===a?0:"next"===a?G():I(),e=L()&&Q.isIndented?z():0;T.animate({left:c},eb,"swing",function(){"function"==typeof b&&setTimeout(function(){var a;b(),angular.isNumber(d.scrollByPixels)&&(a=S.find(".item"),a.each(function(a,b){b=$(b);var d=b.position().left,e=z()-c;return d===e||e>d&&d+b.outerWidth()>e?(D(a),!1):void 0})),Q.onScroll(Z,c,e)},eb)})}function r(){isMobile()||(L()?(S.removeClass("show-prev-ui"),M()?S.removeClass("show-next-ui"):S.addClass("show-next-ui")):M()?(S.addClass("show-prev-ui"),S.removeClass("show-next-ui")):(S.addClass("show-prev-ui"),S.addClass("show-next-ui")),bb=!0)}function s(){!isMobile()&&bb&&(S.removeClass("show-prev-ui"),S.removeClass("show-next-ui"),bb=!0)}function t(){bb&&r()}function u(){S.css("left",0),S.width(v()),S.removeClass("indented")}function v(){return Q.isIndented?$(window).width():$(e).offsetParent().width()-$(e).position().left}function w(){Q.isIndented&&(S.css("left",z()),S.width(A(z())),S.addClass("indented"),T.css("left",0))}function x(){var a=v();S.width(!isNaN(a)&&a>1?a:"")}function y(){return S.hasClass("indented")}function z(){return U[Q.positionWithPosition?"position":"offset"]().left+(angular.isNumber(Q.extraIndent)?Q.extraIndent:0)}function A(a){return v()-a}function B(){return y()?v()-z():angular.isNumber(d.scrollByPixels)?v()-$(S.find(".item")[Z]).offset().left:v()}function C(a){var b=0,c=-1,d=0,e=$(S.find(".item")),f=Z;if(e.size()*e.outerWidth(!0)>v())for(;Math.round(b)<B()&&c!==b&&-1!==f;)c=b,b+=$(e[f]).outerWidth(!0),d++,f=a?f-=1:f+=1;return d-1}function D(a){try{}catch(b){}Z=a}function E(){return Z}function F(a){var b,c=S.find(".item");b=a?$(c[E()-C(a)]).index():$(c[C()-1+E()]).index();try{}catch(d){}return b}function G(){return L()&&Q.isIndented?-1*(H()-z()):K()+-1*H()}function H(){var a=$(S.find(".item")[F()+1]).offset().left;return Q.isIndented||(a-=$(S).offset().left),angular.isNumber(d.scrollByPixels)&&(a=d.scrollByPixels*Math.floor(B()/d.scrollByPixels)),a}function I(){return K()+Math.abs(J())}function J(){var a=$(S.find(".item")[F(!0)]).offset().left;return Q.isIndented||(a-=$(S).offset().left),angular.isNumber(d.scrollByPixels)&&(a=d.scrollByPixels*Math.floor(Math.max(0,B())/d.scrollByPixels)),a}function K(){return $(S).find(".slide")[Q.isIndented?"offset":"position"]().left}function L(){return 1===Q.currentSet}function M(){return Q.currentSet===gb.length}function N(){q("first",function(){Q.currentSet=1,D(0)})}function O(){L()&&Q.isIndented?w():Q.isIndented?u():x(),j(),a(t,eb)}var P=500,Q=d,R=$(e).attr("id"),S=$(e).find(".carousel"),T=$(e).find(".slide");$(e).find(".item");var U=$(e).find(".dots"),V=$(e).find(".carousel-next"),W=$(e).find(".carousel-prev"),X=0;Q.currentSet=1;var Y,Z=0,ab=0,bb=!1,cb=!1,db="",eb=200,fb=60,gb=[],hb=Q.showMock?parseInt(Q.showMock,10):!1;Q.items=[],Q.load=function(){};var ib=function(){var a=function(a){var d=$(a.target),e={targetElem:d,clickedItem:d.is("li")?d:d.parents(".item"),clickedBtn:d.is("button")?d:d.closest("button").length>0?d.closest("button"):!1,clickedDVRRecord:d.is("dvr-record, [dvr-record]")||d.closest("dvr-record, [dvr-record]").length>0?d:!1,clickedInfoBlock:d.is(".info-block")?d:d.closest(".info-block")};if(e.clickedSecondItem=e.clickedInfoBlock.prev().is(".info-block"),e.clickedItem){if(isMobile()&&!cb&&!c.phone&&db!==e.clickedItem.attr("id"))return db=e.clickedItem.attr("id"),void 0;isMobile()&&!cb?Y=setTimeout(function(){b(a,e)},P):isMobile()||cb||b(a,e)}},b=function(a,b){b.clickedDVRRecord||(!b.clickedBtn&&n(b.clickedItem,b.clickedSecondItem)&&angular.isFunction(n)?n(b.clickedItem,b.clickedSecondItem)():b.clickedBtn&&o(b.clickedBtn)&&angular.isFunction(o)&&o(b.clickedBtn)()),d.$emit("carouselEvent",{eventName:"click",eventTarget:a.target})};e.bind("click",function(b){a(b)}),Q.isPast=function(a){return angular.isDate(a)&&a.getTime()<(new Date).getTime()},$(window).resize(function(){Q.$apply(function(){O(),i(),p()})}),$(e).mouseover(function(){r()}),$(e).mouseout(function(){s()}),W.click(function(){q("previous",function(){Q.currentSet--,D(F(!0))})}),V.click(function(){q("next",function(){Q.currentSet++,D(F()+1)})}),T.swipe({tap:function(b){(3!==b.which||2!==b.button)&&a(b)},swipe:function(a,b){Y&&clearTimeout(Y),isMobile()&&!cb&&("left"!==b||M()?"right"!==b||L()||(cb=!0,q("previous",function(){Q.currentSet--,D(F(!0)),cb=!1})):(cb=!0,q("next",function(){Q.currentSet++,D(F()+1),cb=!1})))},threshold:75}),Q.$watch("localItems",function(a){a&&(ab=d.localItems.length,setTimeout(function(){Q.$apply(p)},100),h())}),Q.$watch("localItems.length",function(a){a&&h()}),Q.$watch("showHide",function(){d.showHide===!0?($(e).removeClass("hidden"),O()):$(e).addClass("hidden")}),Q.$watch("isIndented",function(){O(),i()}),Q.onScroll=function(a,b,c){O(),d.$emit("carouselEvent",{carouselId:R,eventName:"scroll",eventTarget:S.find(".item")[a],offset:b,offsetDelta:b-X-c}),X=b}};Q.generateMockElements=function(){var a=[];switch(hb){case 1:for(var b=1;20>=b;b++)a.push({id:"item",action:g,artwork:"/parts/carousels/images/art"+b+".jpg",info:"Null am mollis elit eget eros feugiat commodo.",buttons:[{label:"Record",icon:"icon-stop",action:g},{label:"Add to Cart",icon:"icon-shopping-cart",action:""}]});break;case 2:for(;20>=b;b++)a.push({id:"item",action:g,itemWidth:getRandomInt(10,200),info:"Null am mollis elit eget eros feugiat commodo.",buttons:[{label:"Record",icon:"icon-stop",action:g},{label:"Add to Cart",icon:"icon-shopping-cart",action:""}]})}return a},Q.getLimitedItems=function(){return angular.isNumber(Q.maxItems)?b(Q.items,Q.maxItems):Q.items},f()}}}]),angular.module("checkbox",[]).directive("checkbox",["$parse","$interpolate",function(a,b){return{restrict:"C",require:"?ngModel",scope:!0,replace:!0,templateUrl:"/parts/checkbox/checkbox-template.html",link:function(c,d,e,f){function g(a){e.$observe(a,function(d){_.isDefined(d)&&(h[a]=b(d)(c))})}var h={isChecked:e.hasOwnProperty("checked"),isDisabled:!1,isPartial:!1,trueValue:!0,falseValue:!1};_.each(["trueValue","falseValue"],g);var i,j=a(e.group);j.assign&&(i=j(c),_.isArray(i)||(j.assign(c,[]),i=j(c)),i.push(h));var k=[];c.$watch(a(e.groupOwner),function(a){_.isArray(a)&&(k=a)}),h.onCheck=function(){e.disabled||d.is("[disabled]")||(h.isChecked=!h.isChecked)},c.$watch("checkbox.isChecked",function(a){h.isPartial=!1,_.each(k,function(b){b.isChecked=a}),f&&f.$setViewValue(a)}),c.$watch("$parent."+e.groupOwner,function(a){if(_.isArray(a)){var b=_.unique(_.pluck(a,"isChecked"));1===b.length?(h.isChecked=_.first(b),h.isPartial=!1):h.isPartial=!0}},!0),f&&(f.$render=function(){h.isChecked=f.$modelValue===h.trueValue},f.$parsers.push(function(a){return a?h.trueValue:h.falseValue})),c.$on("$destroy",function(){f&&f.$setViewValue(void 0),_.isArray(i)&&i.splice(_.indexOf(i,h),1)}),c.checkbox=h}}}]),angular.module("clickout",[]).directive("clickout",["$parse","$rootScope",function(a,b){var c=[];return $(document).on("click",function(a){0!==c.length&&b.$apply(function(){_.each(c,function(b){$.contains(b.elm[0],a.target)||b.callback(b.scope)})})}),function(b,d,e){var f={elm:d,scope:b,callback:a(e.clickout)};c.push(f),d.on("$destroy",function(){var a=_.indexOf(c,f);-1!==a&&c.splice(a,1)}),b.$on("$destroy",function(){var a=_.indexOf(c,f);
-1!==a&&c.splice(a,1)})}}]),angular.module("cmsNavigation",[]).directive("cmsNavigation",[function(){return{restrict:"EA",transclude:!0,template:"<div ng-transclude ></div>",link:function(a,b){var c=0,d=[],e=0,f=!1;setTimeout(function(){a.getMenu(),f=!0},100),$(window).resize(function(){c=0,d=[],e=0,f===!0&&a.getMenu()}),a.getMenu=function(){var a=0;if(b.width("auto"),b.find("li:visible").each(function(){c=c+parseInt($(this).width(),10)+parseInt($(this).css("padding-right"),10)+parseInt($(this).css("padding-left"),10),c>parseInt(b.width(),10)&&(0===a&&(a=c-(parseInt($(this).width(),10)+parseInt($(this).css("padding-right"),10)+parseInt($(this).css("padding-left"),10)),b.width(a+parseInt($(this).css("padding-right"),10)+"px")),d.push({title:$(this).get(0).outerHTML}))}),d.length>0){b.next(".moreItems").remove();var e="<div class='moreItems'><ul class='show-more'><li class='size dropdown-section'><div><span class='options'>More</span> <span class='downarrow'></span></div></li>";0!==d.length&&(e+="<div class='more-items' style='display:none'>",$.each(d,function(a,b){e+=b.title}),e+="</div></ul></div>",b.after(e))}angular.element(".subnav li").click(function(){$(this).parents("ul").next(".moreItems").find(".more-items").hide(),$(this).parents("ul").next(".moreItems").find(".dropdown-section").show(),$(this).parents("ul").next(".moreItems").find("ul").addClass("show-more"),$(this).parents("ul").next(".moreItems").find("ul").removeClass("list")}),angular.element(".more-items li").click(function(){$(this).parent().prev("li").is(":hidden")?($(this).parent().prev("li").show(),$(this).siblings().show(),$(this).parents("ul").addClass("list"),$(this).parents("ul").removeClass("show-more"),$(this).find("span").remove()):($(this).parent().prev("li").hide(),$(this).siblings().hide(),$(this).parents("ul").removeClass("list"),$(this).parents("ul").addClass("show-more"),$(this).find("a").after("<span class='downarrow'></span>"))}),angular.element(".dropdown-section").click(function(){$(this).parent("ul").hasClass("show-more")?($(this).next("div").css("display","block"),$(this).parent("ul").removeClass("show-more"),$(this).parent("ul").addClass("list"),$(this).parent("ul").find(".more-items").find("li").show(),$(this).next("div").find("li span").remove()):($(this).parent("ul").removeClass("list"),$(this).parent("ul").addClass("show-more"),$(this).parent("ul").find(".more-items").find("li").hide())})}}}}]),angular.module("commonFooter",["config"]).controller("CommonFooterCtrl",["$scope","Config",function(a,b){var c=this,d={INTERNET:"/internet",PAYBILL:"/pay-bill",TV:"/tv"},e=b.getValuesBySelector("*").endpoint.api.faqSearch;c.footerSearchVal="",c.fullYear=(new Date).getFullYear(),c.isESI={common:!1,internet:!1,paybill:!1,tv:!1};var f=function(){var a=window.location.pathname,b="common";a.indexOf(d.TV)>=0?b="tv":a.indexOf(d.INTERNET)>=0?b="internet":a.indexOf(d.PAYBILL)>=0&&(b="paybill"),c.isESI[b]=!0};return c.faqSearch=function(){window.location=e+c.footerSearchVal},c.init=function(){f()},c.init(),c.isEspanolLang=b.isEspanolLang,a.CommonFooterCtrl=c}]),angular.module("commonHeader",["config","oolCookie","supportService","sheet","checkbox","webdvrResource","webmailService","outageService","alertsService","phoneService","dropdowns","spinner","alertDrawer","ctaArrowLink","drawer","payBillResource","stickyStack","searchResource","ngSanitize","payBillUtils","dvrRecordingModel","ellipsis","isDeviceWidth","filters","ngCookies","onetCookies","serverUserAgentService","alertsService","userService","cookieLoggerService"]).controller("CommonHeaderCtrl",["$rootScope","$scope","$timeout","Config","ooluser","Support","WebDVR","WebDVRs","Webmail","Outage","ServerUserAgent","Phone","PayBillService","AlertAPI","SearchService","PayBillUtils","Alerts","$window","recordingModel","isDeviceWidth","ServiceAppointment","$q","$cookies","Cookies","User","CookieLogger",function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z){function A(a){for(var b=window.location.search.substring(1),c=b.split("&"),d=0;d<c.length;d++){var e=c[d].split("=");if(e[0]===a)return decodeURIComponent(e[1])}}function B(a){if(a&&a.status&&a.status.statusCode&&a.status.statusCode.length>0&&0===parseInt(a.status.statusCode,10)){b.globalBP=a,b.dueAmount=a.amountDue,a.dueDays>=0&&(b.dueDays=a.dueDays),b.systemDate=a.systemDate,b.dueDate=a.dueDate,b.dueDate=a.dueDate,b.payment=a.defaultPmNickname,b.nextstmtdate=a.nextStatementDate,b.receivedPayDate=a.recentPayDate,b.receivedPayAmount=a.recentPayAmount,b.scheduledPayment=a.hasScheduledPayment,b.hasAutoPay=a.hasAutoPay,b.pastDue=a.pastDueAmount,b.scheduledPayAmount=a.scheduledPayAmount,b.scheduledPayDate=a.scheduledPayDate,b.scheduledPayNickname=a.scheduledPayNickname,b.numPaymentMethods=0,b.wrt=a.wrt,b.currentAccountNumber||(b.currentAccountNumber=a.accountNumber),a.csrId&&$(".csr-div").removeClass("hidden"),void 0!==b.payment&&(b.numPaymentMethods=1),parseFloat(b.dueAmount,0)>0?b.positiveBalance=!0:0===parseFloat(b.dueAmount,0)?b.zeroBalance=!0:parseFloat(b.dueAmount,0)<0&&(b.negativeBalance=!0,b.negativeBalanceValue=-b.dueAmount),b.negativeBalance&&b.wrt&&0!==b.wrt&&(b.hasWriteOff=!0),b.enrolled=b.hasAutoPay?"Y"===b.scheduledPayment?!0:!1:"Y"===b.scheduledPayment?!0:!1;var c=N.testValue(b.hasAutoPay,"Y"),d=N.testValue(b.scheduledPayment,"Y");b.autopayscheduled=!1,b.autopaynoscheduled=!1,b.noautopayscheduled=!1,b.noautopaynoscheduled=!1,c&&d?b.autopayscheduled=!0:c&&!d?b.autopaynoscheduled=!0:!c&&d?b.noautopayscheduled=!0:c||d||(b.noautopaynoscheduled=!0),b.pastDueAvailable=0!==parseFloat(b.pastDue,0)?!0:!1}else Z.mainError=!0,Z.mainErrorMsg="Server Error",b.bpGlobalError=!0}function C(){Z.mainError=!0,Z.mainErrorMsg="Server Error",b.bpGlobalError=!0}function D(c){if(b.toAcctType=null,a.acctDetail){var d=p.getObjInArrayByValue(a.acctDetail,"active",!0),e=d.accountType;"2"===e&&(b.toAcctType="2"),"3"===e&&(b.toAcctType="1")}else b.toAcctType="0";b.clickedLink=c,m.toggleAccount(E,F,b.toAcctType)}function E(a){if(m.checkSuccess(a))switch(b.clickedLink){case"linkPayment":window.location="/pay-bill/payment-options/";break;case"linkManage":window.location="/pay-bill/manage-payments/";break;case"linkAuto":window.location="/pay-bill/automatic-payments/";break;case"linkAccount":window.location="/pay-bill/account-activity/";break;case"linkPayBill":window.location="/pay-bill/"}else D(b.clickedLink)}function F(a,c){if(console.log("in error"),a&&401===c){var d="";switch(b.refererUrl="/pay-bill",b.clickedLink){case"linkPayment":b.refererUrl=b.refererUrl+"/payment-options";break;case"linkManage":b.refererUrl=b.refererUrl+"/manage-payments";break;case"linkAuto":b.refererUrl=b.refererUrl+"/automatic-payments";break;case"linkAccount":b.refererUrl=b.refererUrl+"/account-activity";break;case"linkPayBill":b.refererUrl=b.refererUrl}d=N.currentLoggedInUser.hasSession?b.refererUrl:R.LOGIN+"?referer="+escape(b.refererUrl),window.location=d}}function G(){b.input=!1,N.searchTerm=""}function H(){return"undefined"==typeof N.searchTerm||""===N.searchTerm||0===N.searchTerm.length?!1:!0}function I(){$("section").each(function(){"common_header"!==$(this).attr("id")&&$(this).addClass("auto_complete_display_none")})}function J(){$("section").each(function(){$(this).removeClass("auto_complete_display_none")})}function K(){/\bSilk\b/.test(navigator.userAgent)&&($("div.internet-menu").css("margin-left","-11px"),$("div.support-ddmenu").css("margin-left","-4px")),null!=navigator.vendor&&navigator.userAgent.match(/Nexus 7/)&&($("div.internet-menu").css("margin-left","-15px"),$("div.support-ddmenu").css("margin-left","-8px"))}function L(){/(signin.optimum.net|idcenter.services.optimum.net)$/.test(window.location.hostname.toLowerCase())&&window.location.replace("https://www.optimum.net"+window.location.pathname+window.location.search)}var M={};b.bpGlobalError=!1,$("#global-input").live("focus",function(){b.inputFocus=!0,$("#global-input-form").addClass("increaseInputSize"),$("#global-input").addClass("inputBackground"),$("#search-btn").addClass("overlay")}),$("#global-input").live("focusout",function(){b.inputFocus=!1}),$("#mobile-global-input").live("focus",function(){b.inputFocus=!0}),$("#global-input").live("focusout",function(){$("#global-input-form").removeClass("increaseInputSize"),$("#global-input").removeClass("inputBackground"),$("#search-btn").removeClass("overlay")});var N=this,O=window.location.href;N.isEspanolLang=!1,-1!==O.indexOf("espanol")&&(N.isEspanolLang=!0),a.fnCloseMobileFlyOut=function(){a.rootShowingMobileMenu&&c(function(){$("#menubutton").trigger("click")},0)};var P,Q="Sign in with your Optimum ID",R={PROFILE:"/profile/",LOGIN:"/login/"},S=t.desktop||t.largeDesktop||$("body.ie8").length>0,T=$("body.ie9").length>0?!0:!1,U=function(){return k.getServerUserAgent().then(function(a){return console.log("ServerUserAgent: "+a),""===a&&(a=navigator.userAgent),null!==a.match(/msie 7/i)&&-1!==a.indexOf("Trident")})},V={},W="",X={isOpen:!1,cookieChecked:!1};b.drawerModel=X;var Y="/support/outage/#/UnauthenticatedUserOutage";N.gsaResult={status:{code:0,description:""},token:"",results:[]},N.veveoResult={status:{code:0,description:""},token:"",results:[]},N.googleResult={status:{code:0,description:""},token:"",results:[]},N.showDeprecatedBrowserBanner=!1,N.showIEBrowserIcon=!1,N.showDeprecatedBrowserMsg=!1,N.showCompatModeMsg=!1,N.currentMenuSelection="",N.helloMessage={text:"",link:"#"},N.currentLoggedInUser={corpId:"",hasSession:!1,optimumId:"",inbox:{emails:[],messageCount:0},phone:{count:0,messages:[]},hasService:{internet:!1,phone:!1,eMail:!1,tv:!1,dvr:!1}},N.showingMobileMenu=!1,N.showingMobileSearchBar=!1,N.serviceStatus={outage:{init:!1},messages:{init:!1},support:{init:!1},webmail:{init:!1}},N.userInput={signinForm:{remember_bool:!1,remember_string:"no",isNotValidOptimumId:!1,isNotValidPassword:!1},paybillForm:{remember_bool:!1,remember_string:"no",isNotValidOptimumId:!1,isNotValidPassword:!1}},N.loginFormAction="",N.loginFormReferer="";var Z={};b.model=Z,b.reloadOutageRoute=function(){-1!==window.location.href.indexOf("#")&&window.location.reload(),window.location.href=N.outage.link},b.currency=p.currency,N.checkBPUnAuthorized=function(){var a=!0,b=document.cookie;null!==b&&(b=unescape(b));for(var c=b.split(";"),d=0;d<c.length;d++){var e=c[d].split("="),f=e[0];f=f.replace(" ","");var g=e[1];if("oolp_"===f&&g&&""!==g&&(g=JSON.parse(g),g.p&&1===g.p.bp))return!1}return a},N.secondmodel=!1,void 0===w.s_p_a?N.softPavedAccount=!1:void 0===w.s_p_a_Checked?(x.setCookie("s_p_a_Checked","true",{path:"/"}),N.softPavedAccount=!0):N.softPavedAccount=!1,N.showSecondModel=function(){N.secondmodel=!0,N.softPavedAccount=!1},N.closeSecondModel=function(){N.secondmodel=!1,N.softPavedAccount=!1},N.goToChangePass=function(){x.setCookie("fromModal","true",{path:"/"}),window.location="/profile/change-password/?id="+N.currentLoggedInUser.optimumId};var ab=new Date;b.currentDate=ab.getMonth()+"/"+ab.getDate()+"/"+ab.getFullYear(),b.isunAuthorized=this.checkBPUnAuthorized(),b.getGlobal=function(){if(Z.mainError=!1,Z.mainErrorMsg="",!b.isunAuthorized){var a={};a.accountType="0",a.system="Portal",m.getBPGlobal(a,B,C)}},N.testValue=function(a,b){return a?(a=$.trim(String(a).toUpperCase()),b=b.toUpperCase(),a!==b?!1:!0):!1},"true"===A("e")&&(b.enrolled=!0),A("pm")&&(b.numPaymentMethods=parseInt(A("pm"),10)),b.getGlobal(),b.getPaymentText=function(){return b.numPaymentMethods>0?null!==b.payment&&""!==b.payment?p.currency(b.dueAmount)+" now with "+p.truncateName(b.payment):p.currency(b.dueAmount)+" now":p.currency(b.dueAmount)+" now"};var bb={MILLI_TO_SECONDS:1e3,SECONDS_IN_HOUR:3600},cb=function(a){var b=!1,c=d.getValuesBySelector("cookie.expirationTimeToCheck"),e=(new Date).getTime(),f=e/bb.MILLI_TO_SECONDS,g=f-a,h=g/bb.SECONDS_IN_HOUR;return h>=c&&(b=!0),b};b.refererUrl="",N.checkingSession=function(a){var c=cb(e.t);if(!N.currentLoggedInUser.hasSession||c){switch(b.refererUrl="/pay-bill",a){case"linkPayment":b.refererUrl=b.refererUrl+"/payment-options";break;case"linkManage":b.refererUrl=b.refererUrl+"/manage-payments";break;case"linkAuto":b.refererUrl=b.refererUrl+"/automatic-payments";break;case"linkAccount":b.refererUrl=b.refererUrl+"/account-activity";break;case"linkPayBill":b.refererUrl=b.refererUrl}var d=R.LOGIN+"?referer="+escape(b.refererUrl);window.location.href=d}else D(a)},N.outage={className:"",icon:"",message:"",status:"",link:""},N.dvrMenu={scheduledRecordings:[],nextThreeRecordings:[],alertNoScheduled:!1,alertNoService:!1},N.basePhoneMenuUrl="",N.webmailLink="",N.ooluser=e;var db=function(){var a=N.currentLoggedInUser;e.hasOOLSession&&(a.isPrimary=e.primary,a.hasSession=!0,a.optimumId=e.optimumId,a.corpId=e.corpId||"",a.hasService={internet:e.ool,eMail:1===e.p.email?!0:!1,phone:e.ov,tv:e.io,dvr:e.p?e.p.dvr&&1===e.p.dvr?!0:!1:!1})},eb=function(){var a=/Windows NT 6.0/.test(navigator.userAgent),b=/Windows NT 6.1/.test(navigator.userAgent),c=/Windows NT 6.2/.test(navigator.userAgent),d=a||b||c;return d},fb=function(){return 1===window.location.pathname.indexOf("service-appointments")?"":-1===window.location.pathname.indexOf("login")?"?referer="+escape(window.location.href):""},gb=function(){var a=N.helloMessage,b=N.currentLoggedInUser,c=b.hasSession;a.text=c?"Hi "+b.optimumId:Q,a.link=c?R.PROFILE:R.LOGIN+fb()},hb=function(a){var c=!$(a.target).closest(".global-nav-primary__item").length&&!$(a.target).closest(".global-nav-secondary__item").length;c&&b.$apply(function(){N.currentMenuSelection=""})},ib=function(){if(""!==N.currentMenuSelection){var a="";switch(N.currentMenuSelection){case"profile":a+=N.currentLoggedInUser.hasSession?R.PROFILE:R.LOGIN+fb();break;case"phone":a=N.basePhoneMenuUrl;break;default:a+="/"+N.currentMenuSelection+"/"}window.location.href=a}},jb=function(a){var b=$("#"+a+"OptimumId").val(),c=$("#"+a+"Password").val();angular.isString(b)&&(b.match(/^\s+/)||b.match(/\s+$/))&&$("#"+a+"OptimumId").val(b=b.replace(/^\s+/,"").replace(/\s+$/,"")),angular.isString(c)&&(c.match(/^\s+/)||c.match(/\s+$/))&&$("#"+a+"Password").val(c=c.replace(/^\s+/,"").replace(/\s+$/,""));var d={isValidId:!1,isValidPassword:!1,optimumId:b,password:c};return""!==d.optimumId&&(d.isValidId=!0),""!==d.password&&(d.isValidPassword=!0),d},kb=function(){var a=N.serviceStatus;a.support.init||lb(),a.outage.init||(N.currentLoggedInUser.hasSession?nb():(a.outage.init=!0,mb("User not logged in","")))},lb=function(){var a=N.currentLoggedInUser.corpId;f.getSupportNumber(a).then(function(){N.serviceStatus.support.init=!0},function(){})},mb=function(a,c){var d={ERROR:"round-circle primary","USER NOT LOGGED IN":"round-circle secondary",OUTAGE_ON_ACCOUNT:"round-circle alert",RECENTLY_CLEARED:"round-circle primary",NO_OUTAGE:"round-circle primary",OFFLINE:"round-circle primary",NON_PAY:"round-circle alert",VOD_HOLD:"round-circle primary",PLANNED_MAINTENANCE:"round-circle primary",NODE_DISTRESS:"round-circle primary"};N.outage={className:d[a.toUpperCase()],icon:j.outageIcon(a.toUpperCase()),message:j.outageCopy("menu",a.toUpperCase()),status:a,link:""===c?Y:c},"USER NOT LOGGED IN"===a.toUpperCase()&&(b.mobileOutageStatus=a,b.mobileOutageclassName=N.outage.className,b.mobileOutageIcon=N.outage.icon,b.mobileOutageMessage=N.outage.message)},nb=function(){j.getProcessedOutagePromise().then(function(c){var d=c.outageStatus?c.outageStatus.toUpperCase():"ERROR",e=a.currentOutageLink;"User not logged in"!==c.outageStatus&&null!=c.accountSummary&&("NON_PAY"===c.accountSummary.accountPaymentStatus?d="NON_PAY":c.accountSummary.serviceOutageReported&&"RECENTLY_CLEARED"!==d?d="OUTAGE_ON_ACCOUNT":"VOD_HOLD"===c.accountSummary.accountPaymentStatus?d="VOD_HOLD":c.accountSummary.plannedMaintenance&&c.accountSummary.nodeInDistress&&c.accountSummary.devicesOffline?d="PLANNED_MAINTENANCE":c.accountSummary.plannedMaintenance&&!c.accountSummary.nodeInDistress&&c.accountSummary.devicesOffline?d="PLANNED_MAINTENANCE":!c.accountSummary.plannedMaintenance&&c.accountSummary.nodeInDistress&&c.accountSummary.devicesOffline?d="OFFLINE":c.accountSummary.plannedMaintenance||c.accountSummary.nodeInDistress||!c.accountSummary.devicesOffline?c.accountSummary.plannedMaintenance&&c.accountSummary.nodeInDistress&&!c.accountSummary.devicesOffline?d="PLANNED_MAINTENANCE":c.accountSummary.plannedMaintenance||!c.accountSummary.nodeInDistress||c.accountSummary.devicesOffline?c.accountSummary.nodeInDistress||c.accountSummary.devicesOffline||!c.accountSummary.plannedMaintenance||(d="PLANNED_MAINTENANCE"):d="NODE_DISTRESS":d="OFFLINE"),mb(d,e),b.mobileOutageStatus=d,b.mobileOutageclassName=N.outage.className,b.mobileOutageIcon=N.outage.icon,b.mobileOutageMessage=N.outage.message},function(){console.log("Error")})},ob=function(){N.currentLoggedInUser.hasService.dvr&&!N.dvrMenu.scheduledRecordings.length&&pb()},pb=function(){var a=4;N.loadingScheduledRecordings=!0,g.queryMultipleDVRs(a,function(b){N.dvrMenu.scheduledRecordings=b,0===b.length?(N.loadingScheduledRecordings=!1,N.dvrMenu.alertNoScheduled=!0):(b=_.sortBy(b,function(a){return a.Program.StartTime.valueOf()}),qb(b,a))},function(){N.dvrMenu.alertNoService=!0})},qb=function(a,b){for(var c,d,e=b?b:4,f=[],g=0;e>g&&g<a.length;g++)d=moment(a[g].Program.StartTime),d=d.format("MMDDYYYY[T]HHmm"),c={thumb:a[g].thumbUrl,href:"/tv/dvr-program/"+a[g].Program.tribid+"/"+d+"/"+a[g].Program.callsign,title:a[g].Title},f.push(c);N.loadingScheduledRecordings=!1,f.length<=e?N.dvrMenu.nextThreeRecordings=f:N.dvrMenu.alertNoScheduled=!0},rb=function(){N.currentLoggedInUser.hasService.phone&&(N.serviceStatus.messages.init||sb())},sb=function(){l.getVoicemailCounter().then(function(a){a.data&&200===a.status&&(N.serviceStatus.messages.init=!0,tb(a.data))},function(){})},tb=function(a){var b=N.currentLoggedInUser.phone;b.count=a.count||0},ub=function(){var a=N.serviceStatus.webmail;N.currentLoggedInUser.hasService.eMail&&(a.init||(vb(),setInterval(vb,V.timer.webmail)))},vb=function(){N.serviceStatus.webmail,i.getEmailDetails()};N.isActiveMenu=function(a){return N.currentMenuSelection===a},N.handleMenuBlur=function(){S&&(N.currentMenuSelection="")},N.handleMenuFocus=function(a){S&&(N.currentMenuSelection=a)},N.handleMenuSelect=function(a){N.currentMenuSelection===a?ib():N.currentMenuSelection=a},N.closeDeprecatedBrowserBanner=function(){var a=window.location.hostname.replace(/^[\d\D]*?([^\.]+\.[^\.]+)\.?$/,"$1"),b=(new Date).getTime();N.showDeprecatedBrowserBanner=!1,document.cookie=escape("browserDepCheck")+"="+escape(b)+";path=/;domain="+a},N.toggleMobileMenuDisplay=function(){N.showingMobileMenu=!N.showingMobileMenu,a.rootShowingMobileMenu=N.showingMobileMenu;var c=N.currentLoggedInUser,d=c.hasService,e={showingMobileMenu:N.showingMobileMenu,hasSession:c.hasSession,optimumId:c.optimumId,helloMessage:N.helloMessage,mobileOutageStatus:b.mobileOutageStatus,mobileOutageclassName:b.mobileOutageclassName,mobileOutageIcon:b.mobileOutageIcon,mobileOutageMessage:b.mobileOutageMessage,hasService:{tv:d.tv,internet:d.internet,eMail:d.eMail,phone:d.phone},badge:{tv:d.tv?!0:!1,internet:d.eMail?c.inbox.messageCount:!1,phone:d.phone?c.phone.count:!1,support:N.currentAlertIndex},link:{phone:N.basePhoneMenuUrl,webmail:N.webmailLink,signout:W,outage:c.hasSession?a.currentOutageLink:Y}};a.$emit("mobileMenuDisplayToggle",e)},N.toggleMobileSearchBarDisplay=function(){$("#search_auto_phone").removeClass("hidden"),N.showingMobileSearchBar=!N.showingMobileSearchBar,N.showingMobileSearchBar?($("#mobile-global-input").focus(),$("#phone_header").addClass("auto_complete_display_none"),"undefined"!=typeof N.searchTerm&&N.searchTerm.length>0&&I(),$("#phone-search").removeClass("auto_complete_display_none")):(b.inputFocus=!1,$("#phone_header").removeClass("auto_complete_display_none"),$("#phone-search").addClass("auto_complete_display_none"),J())},N.toggleUserInputRemember=function(a){N.userInput[a].remember_bool=!N.userInput[a].remember_bool,N.userInput[a].remember_string=N.userInput[a].remember_bool?"yes":"no"},N.handleUserSignout=function(){var a=W+fb();document.cookie="createOptimumIdMenuShow=;Expires=Thu, 01 Jan 1970 00:00:01 GMT;",window.location=a},N.handleUserLogin=function(a){var b=jb(a);if(b.isValidId&&b.isValidPassword)$("#"+a).attr("action",N.loginFormAction),$("#"+a).submit();else{var c=N.userInput[a];b.isValidId?b.isValidPassword||(c.isNotValidOptimumId=!1,c.isNotValidPassword=!0):(c.isNotValidOptimumId=!0,c.isNotValidPassword=!1)}},N.showSearchDropDown=!1,N.googleSuggestionFailed=!1,N.gsaSuggestionFailed=!1,N.veveoSuggestionFailed=!1,N.loadingGoogle=!0,N.loadingGsa=!0,N.loadingVeveo=!0,N.supportNavReqd=!1,N.doSearch=function(){""!==N.searchTerm&&0!==N.searchTerm.length&&($("#desktop_auto_complete").removeClass("hidden"),o.getSuggestions(N.searchTerm,"google").then(function(a){200===a.status?(N.googleResult=a.data,N.googleSuggestionFailed=0!==N.googleResult.status.code?!0:!1):N.googleSuggestionFailed=!0,N.loadingGoogle=!1,N.showSearchDropDown=!0}),o.getSuggestions(N.searchTerm,"gsa").then(function(a){200===a.status?(N.gsaResult=a.data,N.gsaSuggestionFailed=0!==N.gsaResult.status.code?!0:!1):N.gsaSuggestionFailed=!0,N.loadingGsa=!1,N.showSearchDropDown=!0}),o.getSuggestions(N.searchTerm,"veveo").then(function(a){200===a.status?(N.veveoResult=a.data,N.veveoSuggestionFailed=0!==N.veveoResult.status.code?!0:"null"!==N.veveoResult.results&&angular.isArray(N.veveoResult.results)?!1:!0):N.veveoSuggestionFailed=!0,N.loadingVeveo=!1,N.showSearchDropDown=!0}))},b.$watch("CommonHeaderCtrl.searchTerm",function(a){("undefined"==typeof a||""===a||0===a.length)&&(N.loadingVeveo=!0,N.loadingGoogle=!0,N.loadingGsa=!0,N.googleSuggestionFailed=!1,N.gsaSuggestionFailed=!1,N.veveoSuggestionFailed=!1)}),N.loading="Data Loading",N.truncateText=function(a,b){if(""===a)return a;var c=/<b>/g,d=/<\/b>/g,e=(a.match(c)||[]).length;if(a&&a.length>b+7*e){var f=a.substring(0,b+7*e);return(f.match(c)||[]).length!==(f.match(d)||[]).length&&(f+="</b>"),f+"..."}return a},N.searchCategory={optimum:"/search/#/allOptimum/",support:"/search/#/optimumSupport/",google:"/search/#/google/",ondemand:"/search/#/tvOnDemand/"},N.searchThis=function(a,b){if(window.location=b===N.searchCategory.support?b+a+"/true":b+a,reporting&&"/search/"===window.location.pathname){var c=decodeURI(a);reporting.srchterm(c)}G()},N.goToSearch=function(a){H()&&(a===N.searchCategory.support?N.supportNavReqd?(window.location=a+N.searchTerm+"/true",N.supportNavReqd=!1):window.location=a+N.searchTerm+"/false":window.location=a+N.searchTerm,reporting&&"/search/"===window.location.pathname&&reporting.srchterm(N.searchTerm),G())},N.phoneGoToSearch=function(a){H()&&(N.goToSearch(a),N.toggleMobileSearchBarDisplay())},N.phoneSearchThis=function(a,b){N.toggleMobileSearchBarDisplay(),N.searchThis(a,b)},N.init=function(){V=d.getValuesBySelector("*"),L(),db(),z.checkSanity();var a=function(){return U().then(function(a){if(a)return N.showCompatModeMsg=a,!0;N.showDeprecatedBrowserMsg=!0;var b=V.deprecatedBrowserCheckTime,c=w.browserDepCheck,d=$("body.ie8").length?!0:!1,e=!1;if(c){c=parseInt(c,10);var f=c+b,g=(new Date).getTime();g>f&&(e=!0)}else e=!0;return d&&e})};a().then(function(a){N.showDeprecatedBrowserBanner=a}),N.showIEBrowserIcon=eb(),K(),gb();var c=N.serviceStatus;c.outage.init||(N.currentLoggedInUser.hasSession?nb():(c.outage.init=!0,mb("User not logged in",""))),rb(),ub(),W=V.link.processSignout,N.basePhoneMenuUrl=V.link.basePhoneMenuUrl,N.loginFormAction=V.link.processLogin,N.loginFormReferer=window.location.href,N.webmailLink=V.link.webmail,N.managedRouterLink=V.link.managedRouterSettings,N.searchTerm="",b.inputFocus=!1},a.$on("webmailDetailsResponse",function(a,c){b.$apply(function(){N.currentLoggedInUser.inbox.emails=c.webmail||[],N.currentLoggedInUser.inbox.messageCount=c.messageCount||0,N.currentLoggedInUser.inbox.dateFormat=angular.isObject(c)?c.dateFormat:""})}),b.$watch("CommonHeaderCtrl.searchTerm",function(){""===N.searchTerm&&(N.showSearchDropDown=!1),"undefined"!=typeof N.searchTerm&&N.showingMobileSearchBar&&(0===N.searchTerm.length?J():I())}),b.$watch("CommonHeaderCtrl.currentMenuSelection",function(a,b){if(a&&a!==b&&a!==P){switch(P=a,a){case"tv":ob();break;case"phone":rb();break;case"internet":ub();break;case"profile":break;case"paybill":break;case"support":kb();break;case"":N.showSearchDropDown=!1;break;case"search":return}N.showSearchDropDown=!1}});var wb=function(){if(T){var a={signin:$("div.signin-profile"),paybill:$("div.paybill-menu"),support:$("div.support-ddmenu")},b=X.isOpen?144:35;for(var c in a)a[c].css("top",b+"px")}if(X.isOpen&&_.isNull(x.getCookie("alertEventLogged"))){xb();var d=function(a,b){var c=new Date;c.setTime(c.getTime()+1e3*a),x.setCookie(b,"true",{expires:c.toGMTString(),path:"/"})};d(1800,"alertEventLogged")}};b.$watch(function(){return n.type},function(){N.currentAlert=n.type}),b.$watch(function(){return n.index},function(){N.currentAlertIndex=n.index;var b="false"===x.getCookie("alrtDrwr")?!1:!0,c=N.currentAlertIndex?!0:!1;console.log("closedCookie=="+b),"/support/outage/#/PendingVOD"===a.currentOutageLink&&(c=!1),console.log("openDrawer=="+c),!c||b||X.cookieChecked||(c=!1,X.cookieChecked=!0),X.isOpen=c,wb()}),N.toggleAlertDrawer=function(){X.isOpen=!X.isOpen;var a=window.location.hostname.replace(/^[\d\D]*?([^\.]+\.[^\.]+)\.?$/,"$1");document.cookie="alrtDrwr="+X.isOpen+";path=/;domain="+a+";"+escape("expires=Sun, 31 Dec 2020 00:00:01 GMT"),wb()},N.init(),N.switchStyles=function(){return N.showingMobileSearchBar&&0===N.searchTerm.length?"dim_background":N.showingMobileSearchBar&&N.searchTerm.length>0&&b.inputFocus?"auto_complete_display_block":"auto_complete_display_none"},$(window).resize(function(){$(window).width()>=768&&N.showingMobileSearchBar&&N.toggleMobileSearchBarDisplay()}),$("#mobile-global-input").keypress(function(a){13===a.which&&N.phoneGoToSearch(N.searchCategory.support)}),$("#global-input").keypress(function(a){13===a.which&&N.goToSearch(N.searchCategory.support)}),$(document).ready(function(){$("#site-wrapper").on("touchstart",hb),jQuery(function(){Modernizr.input.placeholder||($(this).find("#global-input[placeholder]").each(function(){""===$(this).val()&&$(this).val($(this).attr("placeholder"))}),$("#global-input[placeholder]").focus(function(){$(this).val()===$(this).attr("placeholder")&&($(this).val(""),$(this).addClass("placeholder-text"))}).blur(function(){(""===$(this).val()||$(this).val()===$(this).attr("placeholder"))&&($(this).val($(this).attr("placeholder")),$(this).addClass("placeholder-text"))}),$("#global-input[placeholder]").closest("form").submit(function(){$(this).find("[placeholder]").each(function(){$(this).val()===$(this).attr("placeholder")&&$(this).val("")})}))})}),b.seleniumMarker="CommonHeaderCtrl in common-header.js loaded!";var xb=function(){var a="";q.getCombinedAlerts().then(function(b){angular.forEach(b.alerts,function(b){a+="outage"===b.source?"System Outage Alert":b.primaryMessage}),reporting.setAttrs({eVar24:a}),reporting.sendAttrs(!0)})};return e.hasOOLSession&&e.primary&&(M=new y,_.isNull(x.getCookie("createOptimumIdMenuShow"))&&(optimumId=e.optimumId,M.getOptimumIds().then(function(a){var b=new Date;b.setTime(b.getTime()+6e5);var c=b.toGMTString();0===a.data.allowedRemaining||"0"===a.data.allowedRemaining?x.setCookie("createOptimumIdMenuShow","false",{expires:c,path:"/"}):x.setCookie("createOptimumIdMenuShow","true",{expires:c,path:"/"})}))),b.getMaxHousholdIdReached=function(){var a=x.getCookie("createOptimumIdMenuShow");return null===x.getCookie("createOptimumIdMenuShow")?a=!1:showMenushowMenu=x.getCookie("createOptimumIdMenuShow"),a},b.CommonHeaderCtrl=N}]),angular.module("ctaArrowLink",["dots"]).directive("ctaArrowLink",[function(){return{restrict:"A",scope:!0,transclude:!0,replace:!0,templateUrl:"/parts/cta-link/cta-link-template.html",compile:function(a,b){var c=a.find("a"),d=["ngHref","href","target","type","rel","ping","media","hreflang","download"];return _.each(b,function(a,b){_.contains(d,b)&&("nghref"===b.toLowerCase()&&(b="ng-href"),c.attr(b,a))}),function(a,b,c){a.iconClass="icon-arrow-right",_.isDefined(c.icon)&&a.$watch(c.icon,function(b){a.iconClass=b})}}}}]),angular.module("displayLoading",["spinner"]).directive("displayLoading",[function(){return{transclude:!0,template:'<div>  <div spinner ng-show="displayLoading" class="vpadding-m block-align-center" data-length="1" data-radius="10"></div>  <div ng-transclude ng-hide="displayLoading"></div></div>',scope:{displayLoading:"="}}}]),angular.module("doc",["escape","filters","dots","dropdownDoc","ngSanitize"]).directive("doc",["$controller","$compile",function(a,b){return{restrict:"EA",scope:!0,terminal:!0,controller:["$attrs","$filter","$scope",function(a,b,c){function d(a){var b={directive:"icon-pencil",filter:"icon-filter",service:"icon-cog",css:"icon-eye-open"};if(!_.contains(_.keys(b),a))throw a+" is not a valid type; must be one of: "+_.keys(b).join(", ");return b[a]}this.title=a.title||"Part",this.slug=b("slugify")(a.title),this.sections=[],this.addDemo=function(a){this.sections.push(this.processTitle(a))},this.processTitle=function(a){var b=this.sections.length;return a||"Demo"+(2>b?"":b)},this.types=_((a.types||a.type||"directive").split(",")).map(function(a){return _.str.trim(a)}).invoke("toLowerCase").unique().map(function(a){return{name:a,cssClass:d(a)}}).valueOf(),c.DocCtrl=this,c.docTitle=this.title,c.docSlug=this.slug,c.types=this.types}],link:function(c,d,e){function f(b,c){var d,f=e.controller||_.str.classify(e.title)+"DocCtrl";try{d=a(f,{$scope:c})}catch(g){if(e.controller)throw g}return d?$(b).find(".doc__body").data("$ngControllerController",d).end():b}var g='<div id="{{docSlug}}" class="container doc-container"><header class="doc__header hflow grid-gutters-margin align-children-middle"><a class="inline-block doc-title doc__title inherited" href="#{{docSlug}}" ng-bind-html="docTitle"></a><div ng-repeat="type in types" title="{{type.name}}" class="doc__type-icon dot" ng-class="\'doc__type-\'+type.name+\'-icon\'"><i ng-class="type.cssClass"></i></div></header><div class="doc__body">'+d.html()+"</div>"+"</div>",h=c.$new();d.html(b(f(g,h))(h))}}}]).directive("docDemo",["$filter",function(a){return{restrict:"EA",transclude:!0,replace:!0,scope:!0,template:'<section id="{{docSlug}}" class="doc__demo"><a class="inline-block doc-title doc__demo__title" href="#{{docSlug}}" ng-bind-html="demoTitle"></a><div class="doc__demo__body" ng-transclude></div></section>',link:function(b,c,d){var e=b.DocCtrl;e.addDemo(d.title),b.demoTitle=e.processTitle(d.title),b.docSlug=a("slugify")(e.title+"-"+b.demoTitle)}}}]),angular.module("dotsDoc",["doc","dots"]).controller("DotsDocCtrl",["$scope",function(){}]),angular.module("dots",[]).directive("dot",function(){return{restrict:"C",transclude:!0,template:'<span class="dot-inner" ng-transclude></span>'}}),angular.module("drawerGrid",["drawerRow"]).directive("drawerGrid",[function(){return{restrict:"EA",transclude:!0,scope:!0,templateUrl:"/parts/drawer-grid/drawer-grid-template.html",link:function(a,b,c){a.customRowItem=a.$eval(c.templateRowItem),a.customDrawer=a.$eval(c.templateDrawer),a.currentRow=null,a.data=[],a.isCurrentRow=function(b){return _.isEqual(b,a.currentRow)},a.setCurrentRow=function(b){a.currentRow=b},a.$watch(c.data,function(b){a.data=b},!0)}}}]),angular.module("drawerRow",["drawer","filters","panel"]).directive("drawerRow",["$rootScope","$parse",function(a,b){return{restrict:"EA",transclude:"element",templateUrl:"/parts/drawer-row/drawer-row-template.html",replace:!0,scope:!0,compile:function(){return function(a,c,d){function e(){var a=c.find(".drawer-row__item").eq(_.indexOf(f.items,f.currentItem)),b=c.find(".drawer-row__drawer__tip");if(a.length){var d=a.position(),e=a.width(),g=d.left+e/2-b.outerWidth()/2;b.css({left:g})}}var f={items:[1,2,3,4,5],currentItem:null,currentItemSelected:null,columnSize:"auto",getColumnSize:function(){return"auto"===f.columnSize?12/Math.floor(f.items.length):f.columnSize}};a.drawerRowID=_.uniqueId("drawerRowID_"),d.columnSize&&(f.columnSize=a.$eval(d.columnSize)),d.data&&a.$watch(d.data,function(a){f.items=a
},!0),_.isDefined(d.open)&&a.$watch(d.open,function(a){a||(f.currentItemSelected=null)}),a.isCurrentItem=function(a){return a===f.currentItemSelected},a.toggleItem=function(b,c){c=_.firstDefined(c,!a.isCurrentItem(b)),c===!0?a.setCurrentItem(b):c===!1&&(f.currentItemSelected=null)},a.toggleCurrentItem=function(b){a.toggleItem(f.currentItemSelected,b)},a.setCurrentItem=function(c){return a.isCurrentItem(c)?!1:(f.currentItem=c,f.currentItemSelected=c,d.onItemSelect&&b(d.onItemSelect)(a,{$event:{itemSelected:c}}),e(),void 0)},a.isDrawerOpen=function(){return f.currentItemSelected},a.templateForRowItem=(a.$eval(d.templateRowItem)||"default-drawer-row-row-item")+".html",a.templateForDrawer=(a.$eval(d.templateDrawer)||"default-drawer-row-drawer")+".html",a.drawerRowModel=f,window.drawerRowModel=f,$(window).on("resize",e)}}}}]),angular.module("drawer",[]).directive("drawer",[function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"/parts/drawer/drawer-template.html",scope:!0,link:function(a,b,c){function d(a){a&&b.addClass("js-suppress-animation");var d={marginTop:null},e={height:null};f.direction=c.direction,"up"===c.direction?e.height=f.isOpen?g.outerHeight():0:d.marginTop=f.isOpen?0:-1*g.outerHeight(),g.outerHeight()>0&&(g.css(d),b.css(e)),_.nextCycle(function(){a&&b.removeClass("js-suppress-animation")})}function e(){g.is(":visible")&&d(!0)}var f={isOpen:!1,direction:"down",animate:!0},g=b.children();_.has(c,"open")&&a.$watch(c.open,function(a){f.isOpen=Boolean(a),d()}),_.has(c,"closed")&&a.$watch(c.closed,function(a){f.isOpen=!Boolean(a),d()}),d(!0),g.on("resize",e),a._drawerModel=f}}}]),angular.module("dropdownsdate",["clickout","ngSanitize","toggle","sheetdate","if","isViewportSize"]).directive("dropdowndate",["$compile","$parse","$rootScope","isViewportSize",function(a,b,c,e){function f(a,b){return a.selectFirstFound(_.arrayify(b)).outerHtml()}function g(a,b,c){a.find(c).attr("ng-bind-html",null).attr("ng-bind",null).html(b)}var h=[{sourceSelector:"[handle-template]",destSelector:".dropdown__selected"},{sourceSelector:"[option-template]",destSelector:".dropdown__option"},{sourceSelector:["[option-phone-template]","[option-template]"],destSelector:".dropdown-sheet__option"}];return{restrict:"EA",require:["toggle","?ngModel"],transclude:"element",scope:{isDateValid:"=isDateValid",startDate:"=startdate",endDate:"=enddate",selectedDate:"=date",errorClass:"@errorClass"},replace:{model:"=ngModel"},templateUrl:"/parts/dropdown-date/dropdown-date-template.html",compile:function(a,i,j){return j(c,function(b){b.hasContent()&&_.each(h,function(c){g(a,f(b,c.sourceSelector),c.destSelector)})}),function(a,f,g,h){function i(a,b,c){var d=new Date(a,b-1,c),e=""+d.getFullYear()+(d.getMonth()+1)+d.getDate(),f=""+a+b+c;return f===e&&d>p&&q>d}function j(a){a&&(s.currentOption=a)}var k=f.find(".dateInputTxt"),l=f.find(".ddPicker"),n=h[0];h[1];var o,p=null,q=null,r=function(a){if(a&&3===a.split("/").length){year=a.split("/")[2],2===a.split("/")[2].length&&(year=parseInt(String((new Date).getFullYear()).substring(0,2)+year,10));var b=new Date(year,parseInt(a.split("/")[0],10)-1,parseInt(a.split("/")[1],10));return b.setHours(0,0,0,0),b}return null};a.$watch("startDate",function(a){s.setStartDate(a)}),a.$watch("endDate",function(a){s.setEndDate(a)}),e.phone||(o=l.datepicker(),p&&o.datepicker("setStartDate",p),q&&o.datepicker("setEndDate",q),o.hide(),o.on("changeDate",function(b){a.dropdown.updateDate(b.format)}));var s={currentOption:"",inSheet:f.closest(".sheetdate").length>0,updateDate:function(b){return"invalid"===b?(a.$apply(function(){a.isDateValid=!1}),void 0):(l.removeClass(a.errorClass),k.removeClass(a.errorClass),s.currentOption=b,s.displayText=b,this.applyDate(b),void 0)},applyDate:function(b){a.selectedDate=b,a.isDateValid=!0},setStartDate:function(a){var b=r(a);b&&(p=b),o&&o.datepicker("setStartDate",p)},setEndDate:function(a){var b=r(a);b&&(q=b),o&&o.datepicker("setEndDate",q)},selectOptionByIndex:function(a){j(s.options[a])},selectOptionByValue:function(a){j(_.find(s.options,{value:a}))},options:[],loadOptions:function(){},clearOptions:function(){s.options=[]},appendOption:function(){},prependOption:function(){},formatOption:function(a,b){function c(a){return _(a).isPlainObject()&&_(a).has("value")&&_(a).has("label")}return c(a)?a:{label:a,value:b}},addPlaceholderAttribute:function(){g.placeholder&&s.prependOption(g.placeholder,"")},toggle:function(b){if(n.toggle(b),o)if(n.isToggle()){if(3===s.currentOption.split("/").length&&a.isDateValid){var c=s.currentOption.replace("///g","-"),d=c;o.data({date:d}).datepicker("update").children("input").val(d)}o.show()}else o.hide()},isOpen:!1,isDisabled:!1};_.has(g,"disabled")&&a.$watch(b(g.disabled),function(a){s.isDisabled=Boolean(a)}),s.addPlaceholderAttribute(),c.$broadcast("initialised"),a.$watch("selectedDate",function(a){a&&s.currentOption!==a&&s.updateDate(a)}),k.live("focus",function(){isMobile()||s.toggle()}),k.live("keyup",function(b){switch(b.keyCode){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 191:case 8:case 37:case 39:case 46:validKeyCode=!0;break;default:b.preventDefault()}if(3===this.value.split("/").length)if(m=parseInt(this.value.split("/")[0],10),d=parseInt(this.value.split("/")[1],10),y=parseInt(this.value.split("/")[2],10),$(this).removeClass(a.errorClass),i(y,m,d)){s.updateDate(this.value);var c=this.value.replace("///g","-"),e=c;o.data({date:e}).datepicker("update").children("input").val(e)}else a.dateValid=!1,$(this).addClass(a.errorClass),s.updateDate("invalid");else a.dateValid=!1,$(this).addClass(a.errorClass),s.updateDate("invalid")}).live("keydown",function(a){switch(a.keyCode){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 191:case 8:case 37:case 39:case 46:case 32:case 9:break;default:return a.preventDefault(),a.stopPropagation(),!1}}),a.dropdown=s}}}}]),angular.module("dropdownDvr",["dropdowns","webdvrResource","errorHandler","config"]).controller("dropdownDvr",["$rootScope","WebDVR","WebDVRs","Config",function(a,b,c,d){a.dvrs=c;var e=_.partialRight(_.map,function(a){return a.deviceimg&&(a.deviceimgsrc=d.select("paths.assets.images")+"/dvr-boxes/"+a.deviceimg+"_large.png"),{value:a.boxSerialNumber,label:a}}),f={box:{},boxSerial:"",boxOptions:e(a.dvrs),loading:!0,loadUsersDvr:function(){var b=_.find(c,{boxSerialNumber:f.boxSerial});b&&f.box.boxSerialNumber!==b.boxSerialNumber&&(f.box=b,a.$broadcast("dropdownDvr.change",f))}};a.$watch("dvrs",function(a){_.isEmpty(a)||(f.loading=!1,f.boxes=a,f.boxOptions=e(a),f.loadUsersDvr())},!0),_.isEmpty(c)&&b.query(angular.noop,function(){dvr.isLoadingRecordings=!1}),a.dvrdrop=a.dvrdrop||f}]),angular.module("dropdowninternet",["dropdowns","webdvrResource","errorHandler","config"]).directive("dropdownInternet",["$compile","$parse","$rootScope","transcludeTemplates",function(a,b,c,d){return{restrict:"EA",require:["toggle","?ngModel"],scope:!0,transclude:"element",replace:!0,templateUrl:"/parts/dropdown-internet/dropdown-internet-template.html",compile:function(a,e,f){return f(c,function(b){d(a,b),b.hasContent()&&a.find(".text-truncate").removeClass("text-truncate").children().addClass("text-truncate")}),function(a,c,d,e){function f(){var b;a.$watch(function(){angular.equals(b,i.$viewValue)||(b=angular.copy(i.$viewValue),i.$render())})}function g(a){var b,c,d;if(k.isMultiple){if(0===k.options.length)return;angular.isArray(a)?(b=a,j=_.map(b,function(a){return _.find(k.options,{value:a})})):null===a.value||angular.isString(a.value)&&""===a.value?j=[]:-1!==(c=_.findIndex(j,a))?j.splice(c,1):j.push(a),1===j.length?k.currentOption=j[0]:j.length>1?(k.currentOption={label:j.length+" selected"},j=_.sortBy(j,function(a){return _.indexOf(k.options,_.find(k.options,a))})):k.currentOption=_.find(k.options,function(a){return null===a.value||""===a.value}),k.isAlwaysPlaceholder&&(k.currentOption=_.find(k.options,function(a){return null===a.value||""===a.value})),0===j.length&&angular.isArray(b)?b.length=0:b=_.map(j,function(a){return a.value}),i&&(angular.isArray(i.$viewValue)?(d=i.$viewValue,d.length=0,_.each(b,function(a){d.push(a)}),i.$setViewValue(d)):i.$setViewValue(b))}else a&&(k.currentOption=k.isAlwaysPlaceholder?_.find(k.options,function(a){return null===a.value||""===a.value}):a,j=[a],i&&i.$setViewValue(a.value))}var h=e[0],i=e[1],j=[],k={currentOption:null,inSheetAccordion:c.closest(".sheet").length>0&&c.is(".dropdown--accordion"),selectOptionByIndex:function(a){g(k.options[a])},selectOptionByValue:function(a){k.isMultiple&&_.isArray(a)?g(a):g(_.find(k.options,{value:a}))},options:[],loadOptions:function(a){k.clearOptions(),_.each(a,k.appendOption),k.addPlaceholderAttribute(),i&&i.$modelValue?k.selectOptionByValue(i.$modelValue):k.selectOptionByIndex(0)},clearOptions:function(){k.options=[]},appendOption:function(){k.options.push(k.formatOption.apply(null,arguments))},prependOption:function(){k.options.unshift(k.formatOption.apply(null,arguments))},formatOption:function(a,b){function c(a){return _(a).isPlainObject()&&_(a).has("value")&&_(a).has("label")}return c(a)?a:{label:a,value:b}},isSelected:function(a){return _.contains(j,a)},valueIsEmpty:function(a){return null===typeof a.value||""==typeof a.value},addPlaceholderAttribute:function(){d.placeholder&&k.prependOption(d.placeholder,"")},maybeToggle:function(){k.isMultiple||k.isAccordion||k.toggle()},toggle:function(a){k.options&&k.options.length>1&&h.toggle(a)},isPagination:!1,isOpen:!1,isDisabled:!1,isAlwaysPlaceholder:!1,isMultiple:!1,isAccordion:c.is(".dropdown--accordion")};_.has(d,"alwaysPlaceholder")&&a.$watch(b(d.alwaysPlaceholder),function(a){k.isAlwaysPlaceholder=Boolean(a)}),_.has(d,"multiple")&&a.$watch(b(d.multiple),function(a){k.isMultiple=Boolean(a),k.isMultiple&&f(),c.toggleClass("dropdown--multiple",k.isMultiple)}),_.has(d,"disabled")&&a.$watch(b(d.disabled),function(a){k.isDisabled=Boolean(a)}),_.has(d,"pagination")&&(k.isPagination=!0),a.$watch(d.toggle,function(){$(document).ready(function(){$(".js-add-ddfix .sheet__body").height=$(window).height()})}),k.addPlaceholderAttribute(),k.selectOptionByIndex(0),_.has(d,"options")&&a.$watch(d.options,function(a){a?k.loadOptions(a):k.clearOptions()},!0),i&&(i.$render=function(){k.selectOptionByValue(i.$modelValue)}),a.dropdown=k}}}}]).directive("textTruncateJs",[function(){return{restrict:"C",link:function(a,b){function c(){b.hide(),_.nextCycle(function(){b.css({width:b.parent().width()}),b.show()})}_.nextCycle(c),a.$watch(function(){return b.width()},function(){c()});var d=!1;setInterval(function(){var a=b.is(":visible");a&&a!==d&&(c(),d=!0)},150)}}}]);var sheetHeight=$(".js-add-ddfix .sheet__body").height()+$(".js-add-ddfix .sheet__head").height(),windowHeight=$(window).height();$(".dropdown").click(function(){$(".js-add-ddfix").height=windowHeight}),angular.module("dropdowns",["clickout","ngSanitize","toggle","sheet","if","isViewportSize","transcludeTemplates"]).directive("dropdownSimple",["$compile","$parse","$rootScope","transcludeTemplates",function(a,b,c,d){return{restrict:"EA",require:["toggle","?ngModel"],scope:!0,transclude:"element",replace:!0,templateUrl:"/parts/dropdown-simple/dropdown-simple-template.html",compile:function(a,e,f){return f(c,function(b){d(a,b),b.hasContent()&&a.find(".text-truncate").removeClass("text-truncate").children().addClass("text-truncate")}),function(a,c,d,e){function f(){var b;a.$watch(function(){angular.equals(b,i.$viewValue)||(b=angular.copy(i.$viewValue),i.$render())})}function g(a){var b,c,d;if(k.isMultiple){if(0===k.options.length)return;angular.isArray(a)?(b=a,j=_.map(b,function(a){return _.find(k.options,{value:a})})):null===a.value||angular.isString(a.value)&&""===a.value?j=[]:-1!==(c=_.findIndex(j,a))?j.splice(c,1):j.push(a),1===j.length?k.currentOption=j[0]:j.length>1?(k.currentOption={label:j.length+" selected"},j=_.sortBy(j,function(a){return _.indexOf(k.options,_.find(k.options,a))})):k.currentOption=_.find(k.options,function(a){return null===a.value||""===a.value}),k.isAlwaysPlaceholder&&(k.currentOption=_.find(k.options,function(a){return null===a.value||""===a.value})),0===j.length&&angular.isArray(b)?b.length=0:b=_.map(j,function(a){return a.value}),i&&(angular.isArray(i.$viewValue)?(d=i.$viewValue,d.length=0,_.each(b,function(a){d.push(a)}),i.$setViewValue(d)):i.$setViewValue(b))}else a&&(k.currentOption=k.isAlwaysPlaceholder?_.find(k.options,function(a){return null===a.value||""===a.value}):a,j=[a],i&&i.$setViewValue(a.value))}var h=e[0],i=e[1],j=[],k={currentOption:null,inSheetAccordion:c.closest(".sheet").length>0&&c.is(".dropdown--accordion"),selectOptionByIndex:function(a){g(k.options[a])},selectOptionByValue:function(a){k.isMultiple&&_.isArray(a)?g(a):g(_.find(k.options,{value:a}))},options:[],loadOptions:function(a){k.clearOptions(),_.each(a,k.appendOption),k.addPlaceholderAttribute(),i&&i.$modelValue?k.selectOptionByValue(i.$modelValue):k.selectOptionByIndex(0)},clearOptions:function(){k.options=[]},appendOption:function(){k.options.push(k.formatOption.apply(null,arguments))},prependOption:function(){k.options.unshift(k.formatOption.apply(null,arguments))},formatOption:function(a,b){function c(a){return _(a).isPlainObject()&&_(a).has("value")&&_(a).has("label")}return c(a)?a:{label:a,value:b}},isSelected:function(a){return _.contains(j,a)},valueIsEmpty:function(a){return null===typeof a.value||""==typeof a.value},addPlaceholderAttribute:function(){d.placeholder&&k.prependOption(d.placeholder,"")},maybeToggle:function(){k.isMultiple||k.isAccordion||k.toggle()},toggle:function(a){h.toggle(a)},isOpen:!1,isDisabled:!1,isAlwaysPlaceholder:!1,isMultiple:!1,isAccordion:c.is(".dropdown--accordion")};_.has(d,"alwaysPlaceholder")&&a.$watch(b(d.alwaysPlaceholder),function(a){k.isAlwaysPlaceholder=Boolean(a)}),_.has(d,"multiple")&&a.$watch(b(d.multiple),function(a){k.isMultiple=Boolean(a),k.isMultiple&&f(),c.toggleClass("dropdown--multiple",k.isMultiple)}),_.has(d,"disabled")&&a.$watch(b(d.disabled),function(a){k.isDisabled=Boolean(a)}),a.$watch(d.toggle,function(){$(document).ready(function(){$(".js-add-ddfix .sheet__body").height=$(window).height()})}),k.addPlaceholderAttribute(),k.selectOptionByIndex(0),_.has(d,"options")&&a.$watch(d.options,function(a){a?k.loadOptions(a):k.clearOptions()},!0),i&&(i.$render=function(){k.selectOptionByValue(i.$modelValue)}),a.dropdown=k}}}}]);var sheetHeight=$(".js-add-ddfix .sheet__body").height()+$(".js-add-ddfix .sheet__head").height(),windowHeight=$(window).height();$(".dropdown").click(function(){$(".js-add-ddfix").height=windowHeight}),angular.module("dropdowns").directive("dropdown",["$compile","$parse","$rootScope","transcludeTemplates",function(a,b,c,d){return{restrict:"EA",require:["toggle","?ngModel"],scope:!0,transclude:"element",replace:!0,templateUrl:"/parts/dropdown/dropdown-template.html",compile:function(a,e,f){return f(c,function(b){d(a,b),b.hasContent()&&a.find(".text-truncate").removeClass("text-truncate").children().addClass("text-truncate")}),function(a,c,d,e){function f(){var b;a.$watch(function(){angular.equals(b,i.$viewValue)||(b=angular.copy(i.$viewValue),i.$render())})}function g(a){var b,c,d;if(k.isMultiple){if(0===k.options.length)return;angular.isArray(a)?(b=a,j=_.map(b,function(a){return _.find(k.options,{value:a})})):null===a.value||angular.isString(a.value)&&""===a.value?j=[]:-1!==(c=_.findIndex(j,a))?j.splice(c,1):j.push(a),1===j.length?k.currentOption=j[0]:j.length>1?(k.currentOption={label:j.length+" selected"},j=_.sortBy(j,function(a){return _.indexOf(k.options,_.find(k.options,a))})):k.currentOption=_.find(k.options,function(a){return null===a.value||""===a.value}),k.isAlwaysPlaceholder&&(k.currentOption=_.find(k.options,function(a){return null===a.value||""===a.value})),0===j.length&&angular.isArray(b)?b.length=0:b=_.map(j,function(a){return a.value}),i&&(angular.isArray(i.$viewValue)?(d=i.$viewValue,d.length=0,_.each(b,function(a){d.push(a)}),i.$setViewValue(d)):i.$setViewValue(b))}else a&&(k.currentOption=k.isAlwaysPlaceholder?_.find(k.options,function(a){return null===a.value||""===a.value}):a,j=[a],i&&i.$setViewValue(a.value))}var h=e[0],i=e[1],j=[],k={currentOption:null,inSheetAccordion:c.closest(".sheet").length>0&&c.is(".dropdown--accordion"),selectOptionByIndex:function(a){g(k.options[a])},selectOptionByValue:function(a){k.isMultiple&&_.isArray(a)?g(a):g(_.find(k.options,{value:a}))},options:[],loadOptions:function(a){k.clearOptions(),_.each(a,k.appendOption),k.addPlaceholderAttribute(),i&&i.$modelValue?k.selectOptionByValue(i.$modelValue):k.selectOptionByIndex(0)},clearOptions:function(){k.options=[]},appendOption:function(){k.options.push(k.formatOption.apply(null,arguments))},prependOption:function(){k.options.unshift(k.formatOption.apply(null,arguments))},formatOption:function(a,b){function c(a){return _(a).isPlainObject()&&_(a).has("value")&&_(a).has("label")}return c(a)?a:{label:a,value:b}},isSelected:function(a){return _.contains(j,a)},valueIsEmpty:function(a){return null===typeof a.value||""==typeof a.value},addPlaceholderAttribute:function(){d.placeholder&&k.prependOption(d.placeholder,"")},maybeToggle:function(){k.isMultiple||k.isAccordion||k.toggle()},toggle:function(a){k.isDisabled||k.options&&k.options.length>1&&h.toggle(a)},isPagination:!1,isOpen:!1,isDisabled:!1,isAlwaysPlaceholder:!1,isMultiple:!1,isAccordion:c.is(".dropdown--accordion")};_.has(d,"alwaysPlaceholder")&&a.$watch(b(d.alwaysPlaceholder),function(a){k.isAlwaysPlaceholder=Boolean(a)}),_.has(d,"multiple")&&a.$watch(b(d.multiple),function(a){k.isMultiple=Boolean(a),k.isMultiple&&f(),c.toggleClass("dropdown--multiple",k.isMultiple)}),_.has(d,"disable")&&a.$watch(b(d.disable),function(a){k.isDisabled=Boolean(a)}),_.has(d,"pagination")&&(k.isPagination=!0),a.$watch(d.toggle,function(){$(document).ready(function(){$(".js-add-ddfix .sheet__body").height=$(window).height()})}),k.addPlaceholderAttribute(),k.selectOptionByIndex(0),_.has(d,"options")&&a.$watch(d.options,function(a){a?k.loadOptions(a):k.clearOptions()},!0),i&&(i.$render=function(){k.selectOptionByValue(i.$modelValue)}),a.dropdown=k}}}}]).directive("textTruncateJs",[function(){return{restrict:"C",link:function(a,b){function c(){b.hide(),_.nextCycle(function(){b.css({width:b.parent().width()}),b.show()})}_.nextCycle(c),a.$watch("currentOption.label",function(){return b.width()},function(){c()});var d=!1;setInterval(function(){var a=b.is(":visible");a&&a!==d&&(c(),d=!0)},150)}}}]);var sheetHeight=$(".js-add-ddfix .sheet__body").height()+$(".js-add-ddfix .sheet__head").height(),windowHeight=$(window).height();$(".dropdown").click(function(){$(".js-add-ddfix").height=windowHeight}),angular.module("dvrParts",["dots","displayLoading","poster"]).directive("programItem",[function(){return{restrict:"EA",scope:!0,transclude:!0,replace:!0,templateUrl:"/parts/dvr-parts/program-item.html",link:function(a,b,c){a.programItem=a.$eval(c.data),c.data&&a.$watch(c.data,function(b){a.programItem=b[0]||b,a.series=b})}}}]).directive("buttonRemoveRecordings",[function(){return{restrict:"EA",replace:!0,template:'<button  class="btn btn--secondary"  ng-click="remove.startFlow()"  ng-disabled="!remove.selected.length">  <i class="icon-trash"></i>  <span ng-bind-html="l.dvr.remove.series[dvr.recordingType][remove.localeParams.seriesSelectionCount].mobileButtonLabel | s:remove.localeParams"></span></button>'}}]).directive("buttonConfirmRemoveRecordings",[function(){return{restrict:"EA",replace:!0,template:'<button  class="btn btn--secondary"  ng-show="remove.status == \'confirm\'"  ng-click="remove.removeRecordings(remove.selected)"  ng-bind-html="l.dvr.remove[remove.quantityType][dvr.recordingType][remove.localeParams.seriesSelectionCount][remove.status].continueButtonLabel | s:remove.localeParams"></button>'}}]).directive("recordingItemPhone",[function(){return{restrict:"EA",scope:!0,template:'<div class="recording-item padding-s theme-white">  <div class="hbeam full-width">    <div>      <h4>{{series[0].Title}}</h4>      <p>{{series[0].displayDuration}}</p>    </div>    <div class="align-right align-middle">      <p ng-hide="remove.mode" ng-bind-html="series[0].displayShowTime"></p>      <input        ng-show="remove.mode"        ng-model="remove.model[series[0].id]"        ng-change="remove.addRecording(series[0].id, series)"        class="checkbox checkbox--secondary"      >    </div>  </div></div>'}}]),angular.module("dvrRecord",["modal","escape","panel","radio","spinner","webdvrResource","dropdownDvr","dropdowns","filters","notice","oolCookie","program","errorHandler","tvListings"]).directive("dvrRecord",["WebDVR","$log","$rootScope","$rootElement","$compile","$notice","ooluser","Program","getRecordedState",function(a,b,c,d,e,f,g,h,i){c.recordingItem=0,c.currentRecording=0;var j,k,l,m=[],n=!1,o=!1;return{restrict:"EA",transclude:!0,replace:!1,scope:{program:"=",outlineStyle:"="},template:['<a class="btn btn--primary"','  ng-show="haveDVR && program.dvrRecorded"','  ng-click="remove(program)"',"  >Cancel recording</a>",'<a class="btn btn--primary"','   ng-show="haveDVR && !program.dvrRecorded && program.dvrScheduled && !program.seriesButton"','   ng-click="remove(program)"',"   >Cancel recording</a>",'<a class="btn btn--primary"','   ng-show="haveDVR && !program.dvrRecorded && program.dvrScheduled && program.seriesButton"','   ng-click="remove(program)"',"   >Cancel Series</a>",'<a class="btn"',"   ng-class=\"{'btn--primary': ! outlineStyle, 'btn--primary-outline': !! outlineStyle}\"",'   ng-click="record(program)"','   ng-hide="!haveDVR || program.dvrRecorded || program.dvrScheduled || program.alreadyAired || ! program"',"   >Record</a>",'<a class="btn "',"   ng-class=\"{'btn--primary': ! outlineStyle, 'btn--primary-outline': !! outlineStyle}\"",'   ng-href="/login?referer={{windowHref}}"','   ng-show="program && needLogin"',"   >Record</a>"].join(""),link:function(b){function p(){var a="/parts/dvr-record/record-show-card-tmpl.html",b=_.template('<div id="recordShowCard" ng-include="\'<%= templateUrl %>\'"></div>',{templateUrl:a});d.find("#recordShowCard").length||e(b)(c,function(a){d.append(a)})}var q=b;q.$watch("program",function(a){i(a)}),q.$watch("program.loading",function(a,b){a!==b&&i(q.program)}),q.windowHref=window.location.href,p(),o=!0,a.query(function(a){a.length>0?(k=a[0].recording(),l=a[0].boxAlias,_.each(a,function(a,b){var c=a.boxAlias;angular.isString(c)&&""!==c||(c="DVR "+b+1),m.push(c)}),b.defaultBoxAlias=j=a[0].boxAlias||"Manage",b.haveDVR=n=!0,b.needLogin=!1,calledBack=!0):(b.haveDVR=n=!1,b.needLogin=!1)},function(){b.haveDVR=n=!1,b.needLogin=!0}),b.ooluser=g,b.notifyNoDVR=function(){f.add("Sorry, we could not connect to your DVR. Please try again later.","error")},b.record=function(a){programModel=new h(a);var c=programModel.toRecording();b.$emit("dvrRecord.click",c,a)},b.remove=function(a){console.log("Inside scope.remove"),programModel=new h(a);var c=programModel.toRecording();b.$emit("dvrRemove.click",c,a)}}}}]).factory("getRecordedState",["$log","$rootScope","WebDVR",function(a,b,c){function d(b,d,e){return console.log("179"),e&&(n=!1,o=!1,p=!1),p?(angular.isFunction(d)&&d(),void 0):o?(b(),void 0):(m.push(b),n||(n=!0,c.query(function(b){function c(){if(d--,a.log("Outstanding DVR requests",d),0===d)for(o=!0;m.length>0;)m.pop()()}var d=0;b.length>0?(DvrRecording=b[0].recording(),h=b[0].boxAlias,_.each(b,function(a,b){var e=a.boxAlias;DvrRecording=a.recording(),angular.isString(e)&&""!==e||(e="DVR "+b+1),l.push(e),d+=2,j[e]=DvrRecording.query({scheduled:!1},c,c),k[e]=DvrRecording.query({scheduled:!0},c,c)}),i=b[0].boxAlias||"Manage"):p=!0},function(){p=!0})),void 0)}function e(a,b){var c="MM-DD-YY HHmmss",d=moment(a.StartTime,c).toDate(),e=moment(a.EndTime,c).toDate(),f=b.startTime,g=b.endTime;return(angular.isUndefined(f)||!angular.isDate(f))&&(f=b.start_time),(angular.isUndefined(g)||!angular.isDate(g))&&(g=b.end_time),(Math.abs(d.getTime()-f.getTime())<12e3||d.getTime()<g.getTime()&&d.getTime()>f.getTime())&&Math.abs(e.getTime()-g.getTime())<12e3}function f(a){b.displayTd=!1,a.seriesButton=!1,angular.isObject(a)&&((angular.isDefined(a.endTime)&&a.endTime.getTime()<(new Date).getTime()||angular.isDate(a.end_time)&&a.end_time.getTime()<(new Date).getTime())&&(a.alreadyAired=!0),_.each(l,function(b){var c=!1;return angular.isUndefined(a.cs)&&angular.isString(a.channel_callsign)&&(a.cs=a.channel_callsign),_.each(j[b].concat(k[b]),function(d){if(angular.isObject(d)){if(angular.isObject(d.RecordedProgElement)&&angular.isObject(d=d.RecordedProgElement.Program)&&d.callsign===a.cs&&e(d,a))return a.dvrRecorded=b,a.recStartTime=d.StartTime,c=!0,!1;if(angular.isObject(d.SchProgElement)&&angular.isObject(d=d.SchProgElement.Program)&&d.callsign===a.cs&&e(d,a))return a.dvrScheduled=b,a.recStartTime=d.StartTime,g(b,d,a),c=!0,!1}}),c?!1:void 0}),b.displayTd=!0,a.loadingDVRState=!1)}function g(a,c,d){b.seriesidCount=0,_.each(k[a],function(a){angular.isObject(a.SchProgElement)&&angular.isObject(a=a.SchProgElement.Program)&&a.callsign===d.cs&&(angular.isDefined(c.SeriesId)&&a.SeriesId===c.SeriesId?b.seriesidCount=b.seriesidCount+1:b.currentRecording=a)}),(b.seriesidCount>1||"series"===b.currentRecording.Scope&&b.currentRecording.Save>1)&&(d.seriesButton=!0)}var h,i,j={},k={},l=[],m=[],n=!1,o=!1,p=!1,q=function(a,b,c){angular.isObject(a)&&(a.loadingDVRState=!0),d(function(){f(a),angular.isFunction(b)&&b(a)},function(){angular.isObject(a)&&(a.loadingDVRState=!1)},c)};return q.addScheduledRecording=function(a,c,d,e){var f=!1;d.startTime<e&&(f=!0);var g="MM-DD-YY HHmmss";angular.isUndefined(k[a])&&(k[a]=[]),k[a].push({SchProgElement:{Program:{callsign:c,StartTime:moment(angular.isDate(d.startTime)?d.startTime:d.start_time).format(g),EndTime:moment(angular.isDate(d.endTime)?d.endTime:d.end_time).format(g),Save:b.recordingItem.save,Scope:b.recordingItem.scope}}}),q(d,null,f)},q.CancelScheduledRecording=function(a,b,c){c.dvrScheduled=!1,k[a]=_.reject(k[a],function(a){return console.log(a.SchProgElement.Program.callsign+"=="+c.cs+"====="+e(a.SchProgElement.Program,c)),angular.isObject(a.SchProgElement)&&angular.isObject(a=a.SchProgElement.Program)&&a.callsign===c.cs&&e(a,c)?a:void 0}),j[a]=_.reject(j[a],function(a){return console.log(a.RecordedProgElement.Program.callsign+"=="+c.cs+"====="+e(a.RecordedProgElement.Program,c)),angular.isObject(a.RecordedProgElement)&&angular.isObject(a=a.RecordedProgElement.Program)&&a.callsign===c.cs&&e(a,c)?a:void 0}),q(c),c.dvrScheduled=!1,c.dvrRecorded=!1},q}]).controller("recordShowCard",["$rootScope","$scope","WebDVR","WebDVRs","dvrUser","getRecordedState",function(a,b,c,d,e,f){var g={isOpen:!1,setup:!0,waiting:!1,success:!1,error:!1,errorMessage:"",unAuthorized:!1,states:["setup","waiting","success","error"],moveTo:function(a){var b=this;_.each(this.states,function(c){b[c]=c===a})},close:function(){this.isOpen=!1,this.moveTo("setup")},wait:function(){this.moveTo("waiting")},confirm:function(){var a=g.recording;this.moveTo("success"),a.count=a.save?a.save:"All",4===a.filter&&(a.count+=" new")},alert:function(a){this.moveTo("error"),this.recording.error=a||"There was an error while scheduling your recording."},getRecording:function(){var a=g.recording,b=a.box,c=b.recording(),d="YYYYMMDDHHmmss";return new c({call_sign:a.call_sign,start_time:a.start_time.format(d),end_time:a.isRSDVR()?a.end_time.format(d):a.end_time.add(a.end,"seconds").format(d),time:moment().valueOf(),rec_type:"series"===a.scope?1:0,save_days:"series"===a.scope&&a.isRSDVR()?a.keep_series_mrdvr:"series"!==a.scope||a.isRSDVR()?a.keep:0,save_episodes:a.save,all_episodes:a.filter,showEndTime:a.isRSDVR()?a.end_time.add(a.end,"seconds").format(d):a.end_time.format(d),quality:a.isRSDVR()?a.quality:b.is_hd?"hd":"sd",dvrAlias:a.program.dvrScheduled?a.program.dvrScheduled:a.program.dvrRecorded,startTime:a.program.recStartTime})},checkUnAuthorized:function(){console.log("Recording error==="+this.recording.error),"Not Authorized to Record"===this.recording.error&&(this.recording.error="You're trying to record a program on a channel that you do not currently receive. You can add it now by going to channel 902 and choosing the TV package that includes the channel you'd like to see.",this.unAuthorized=!0)},getDay:function(){var a,b=new Date,c=new Array(7);c[0]="Sunday",c[1]="Monday",c[2]="Tuesday",c[3]="Wednesday",c[4]="Thursday",c[5]="Friday",c[6]="Saturday";var d=c[b.getDay()];return a=d.substr(0,3)},getTime:function(){var a,b=new Date,c=b.getHours(),d=b.getMinutes();return 10>d&&(d="0"+d),a=c>11?"PM":"AM",c+":"+d+" "+a},record:function(){this.wait(),this.unAuthorized=!1;var b=this.getRecording(),c=this;b.$save(function(){c.confirm(),a.$emit("dvrRecording.schedule",b),console.log("in record in dev-record.js at line: 391"),f.addScheduledRecording(c.recording.box.boxAlias,c.recording.call_sign,c.recording.program,b.time)},function(a){c.alert(a),c.checkUnAuthorized()})}},h={isOpen:!1,setup:!0,waiting:!1,success:!1,error:!1,states:["setup","waiting","success","error"],errorMessage:"",moveTo:function(a){var b=this;_.each(this.states,function(c){console.log("in moveTo"),b[c]=c===a})},close:function(){console.log("in close"),this.isOpen=!1,this.moveTo("setup")},wait:function(){this.moveTo("waiting")},confirm:function(){this.moveTo("success")},alert:function(a){this.moveTo("error"),this.errorMessage=a||"There was an error while cancelling your recording."},cancel:function(){this.wait();var b=g.getRecording(),c=d,e=c[0].recording();angular.forEach(c,function(a){a.boxAlias===b.dvrAlias&&(e=a.recording())});var i=function(){a.$emit("dvrRecording.cancel",b),h.confirm(),f.CancelScheduledRecording(b.dvrAlias,g.recording.call_sign,g.recording.program)},j=function(a){h.alert(a)};e.destroySingle(b,i,j)}},i={start:["On time"],endTimeDisabled:["On time"],end:[{value:0,label:"On time"},{value:60,label:"1 min"},{value:120,label:"2 min"},{value:300,label:"5 min"},{value:600,label:"10 min"},{value:900,label:"15 min"},{value:1800,label:"30 min"},{value:3600,label:"60 min"},{value:5400,label:"90 min"},{value:7200,label:"2 hrs"},{value:10800,label:"3 hrs"}],save:[{value:0,label:"All Episodes"},{value:5,label:"5 Episodes"},{value:4,label:"4 Episodes"},{value:3,label:"3 Episodes"},{value:2,label:"2 Episodes"},{value:1,label:"1 Episode"}],keep_series_mrdvr:[{value:99,label:"Until I delete"},{value:0,label:"Until space needed"}],keep_episode_mrdvr:[{value:1,label:"1 Day"},{value:2,label:"2 Days"},{value:7,label:"7 Days"},{value:14,label:"14 Days"},{value:99,label:"Until I delete"},{value:0,label:"Until space needed"}],keep_series_localdvr:[{value:0,label:"Until I delete"}],keep_episode_localdvr:[{value:1,label:"1 Day"},{value:2,label:"2 Days"},{value:7,label:"7 Days"},{value:14,label:"14 Days"},{value:0,label:"Until I delete"}],filter:[{value:4,label:"New Episodes Only"},{value:1,label:"All Episodes"}],quality:[{value:"hd",label:"HDTV rooms only"},{value:"hdsd",label:"All rooms (HD & SD)"},{value:"sd",label:"All rooms in SD"}]};g.recording={box:{},title:"",episode:"",scope:"series",end:0,keep:14,save:3,keep_series_mrdvr:0,filter:4,isSeries:function(){return"series"===this.scope},isEpisode:function(){return"episode"===this.scope},isMovie:function(){return"movie"===this.scope},isRSDVR:function(){return"RSDVR VIRTUAL STB"===this.box.devicetype},options:i},e.webdvr.areTermsRead=!1,a.recordingItem=g.recording,b.acceptWebdvrTerms=function(){e.webdvr.areTermsRead&&(g.wait(),c.signup(function(){g.moveTo("setup"),e.webdvr.areTermsAccepted=!0},function(a){g.alert(a)}))},b.submitAcceptWebdvrTerms=function(){b.acceptWebdvrTerms()},b.dvrUser=e,a.$on("dropdownDvr.change",function(a,c){g.recording.box=c.box,g.recording.isRSDVR()&&(g.recording.quality="hd");var d=c.box.devicetype;-1!==d.indexOf("8300")?(b.isdisable=!0,$("#end1").addClass("is-disabled")):(b.isdisable=!1,$("#end").removeClass("is-disabled"))
}),angular.isObject(a.dvrdrop)&&angular.isObject(a.dvrdrop.box)&&(g.recording.box=a.dvrdrop.box),a.$on("dvrRecord.click",function(a,b,c){if(g.recording.isRSDVR()&&(g.recording.quality="hd"),g.recording.keep=14,g.recording.keep_series_mrdvr=0,reporting.setAttrs({eVar10:"Record"}),reporting.sendAttrs(!0),_.extend(g.recording,{program:c},b),g.isOpen=!0,console.log("Program StartTime :"+c.startTime),console.log("Program start_time :"+c.start_time),console.log("Program has Series :"+c.hasSeries),c.hasSeries===!1?$("#series").css("display","none"):$("#series").css("display",""),!angular.isUndefined(c.startTime)||!angular.isUndefined(c.start_time)){var d=angular.isUndefined(c.startTime)?moment(c.start_time).format("ddd"):moment(c.startTime).format("ddd"),e=angular.isUndefined(c.startTime)?moment(c.start_time).format("h:mma"):moment(c.startTime).format("h:mma");i.filter=[{value:1,label:"All Episodes"},{value:4,label:"New Episodes Only"},{value:3,label:"All at "+e},{value:5,label:"All at "+e+" "+"on"+" "+d}]}}),a.$on("dvrRemove.click",function(a,b,c){console.log("in dvrRemove.click function"),_.extend(g.recording,{program:c},b),h.isOpen=!0,console.log("removeRecording.isOpen : "+h.isOpen)}),b.request=g,b.removeRecording=h}]),angular.module("dynamicGrid",[]).directive("dynamicGrid",[function(){return{restrict:"E",scope:{items:"="},transclude:!0,replace:!0,templateUrl:"/parts/dynamic-grid/dynamic-grid-template.html",link:function(a,b,c){function d(a,b,c){for(var d=a.slice(0),e=c/b,f=[];d.length;)f.push(d.splice(0,e));return f}a.items=a.items||function(){throw"bootsrap-grid needs a valid 'items' attribute! It should look something like this: <div bootstrap-grid items='myItemsArray'></div>"}(),a.spanWidth=c.spanWidth,a.parentSpanWidth=c.parentSpanWidth,a.spanWidth>=1&&a.spanWidth<=12||(a.spanWidth=3),a.parentSpanWidth>=1&&a.parentSpanWidth<=12||(a.parentSpanWidth=12),a.rows=d(a.items,a.spanWidth,a.parentSpanWidth)}}}]);var ellipsesTooltipModule=angular.module("ellipsesTooltipModule",["toolTip"]);ellipsesTooltipModule.directive("ellipsesTooltip",["$timeout",function(a){return{restrict:"AEC",scope:!0,link:function(b,c,d){function e(){t=n.wrapInner("<div/>").children(),t.contents().detach().end().append(q.clone(!0)).find("br").replaceWith("<br />").end().css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var b=!1,c=!1;s.afterElement&&(b=s.afterElement.clone(!0),b.show(),s.afterElement.detach()),j(t,r)&&(c="true"===d.istooltip?i(t,n,t,r,b):f(t,n,t,r,b)),t.replaceWith(t.contents()),t=null,s.isTruncated=c,a(function(){m.find("a.readmore").css("float","right")})}function f(a,b,c,d,e){var f=!1;return a.contents().detach().each(function(){var g=this,h=$(g);return f?!0:(a.append(h),e&&a.append(e),j(c,d)&&3===g.nodeType&&(f=i(h,b,c,d,e)),void 0)}),f}function g(a){for(var b=a.innerHeight(),c=["paddingTop","paddingBottom"],d=0,e=c.length;e>d;d++){var f=parseInt(a.css(c[d]),10);isNaN(f)&&(f=0),b-=f}return b}function h(a,b){return"string"==typeof a?(a=$(a,b),a.length?a:!1):a.jquery?a:!1}function i(a,c,e,f){for(var g=a[0],h=l(g),i=-1!==h.indexOf(" ")?" ":"　",m="letter"===f.wrap?"":i,n=h.split(m),o=-1,p=-1,q=0,r=n.length-1;r>=q&&(0!==q||0!==r);){var s=Math.floor((q+r)/2);if(s===p)break;p=s,"true"===d.istooltip?(k(g,n.slice(0,p+1).join(m)),a.append("<div class='tip'>"+f.ellipsis+"<span class='tooltipB'> <p>"+b.prevContent+"</p></span></div>")):k(g,n.slice(0,p+1).join(m)+f.ellipsis),j(e,f)?r=p:(o=p,q=p)}return!0}function j(a,b){return a.innerHeight()>b.maxHeight}function k(a,b){a.textContent=a.innerText=a.data=b}function l(a){var b=a.textContent||a.innerText||a.data;return b?b:""}var m=c,n=m,o={after:"a.readmore"},p={ellipsis:"...",wrap:"leters",lastCharacter:{},after:null},q=m.contents(),r=$.extend(!0,{},p,o),s={},t=null;s.afterElement=h(r.after,n),s.isTruncated=!1,a(function(){if(b.prevContent=m.contents().text(),m.outerHeight()>50){q=m.contents();var a="Read more";"true"!==d.istooltip&&m.append('<a class="more-link readmore">'+a+'<i class="icon-caret-down"></i></a>'),s.afterElement=h(r.after,n)}r.maxHeight=g(n),e()},100),m.on("click",".readmore",function(){-1!==m.find("a").text().indexOf("Read more")?(m[0].childNodes[0].textContent=b.prevContent,m.text(b.prevContent),m.css("height","auto"),m.removeClass("setHeight"),m.append('<a class="more-link readmore readless">  Read less<i class="icon-caret-down"></i></a>')):(m.css("height",r.maxHeight),m.addClass("setHeight"),m.append('<a class="more-link readmore readless">  Read more<i class="icon-caret-down"></i></a>'),e())})}}}]),angular.module("ellipsis",[]).directive("ellipsis",[function(){return function(a,b,c){function d(a){var c,d;"nowrap"===b.css("whiteSpace")?(b.css({overflow:"hidden",textOverflow:"ellipsis"}),b.text(a)):(c=!b.is(":visible"),c&&(d=b.closest(":visible").children().has(b).show()),b.trigger("destroy.dot"),b.text(a),b.dotdotdot(),c&&angular.isDefined(d)&&d.css("display",""))}c.$observe("ellipsis",d),a.$watch(function(){return b.width()},function(){d(c.ellipsis)})}}]),angular.module("pberrmsgs",[]).directive("errormsg",[function(){return{restrict:"E",templateUrl:"/parts/error-msg/error-msg-template.html",scope:{message:"@message",show:"@show",multiMsg:"=multiMsg",msgUpdate:"@msgUpdate"},link:function(a){a.init=function(b){angular.isArray(b)?(a.totalAlerts=b.length,a.multiple=!0,a.currentAlert=1,b.length>1?a.multiple=!0:b&&b[0]&&(a.message=b[0],a.multiple=!1)):b&&b[0]&&(a.message=b[0],a.multiple=!1)},a.init(a.multiMsg),a.$watch("msgUpdate",function(){a.init(a.multiMsg)},!0),a.getCurrentAlert=function(){return a.multiple?a.multiMsg[a.currentAlert-1]:void 0},a.currentTotalText=function(){return""+a.currentAlert+" of "+a.totalAlerts},a.nextAlert=function(){a.currentAlert++},a.prevAlert=function(){a.currentAlert--}}}}]),function(){function a(a){return a.replace(/\=""|\=''/g,"")}angular.module("escape",[]).directive("escape",[function(){return{priority:1e3,terminal:!0,compile:function(b,c){function d(a){return _.map(a.split("\n"),function(a){return"  "===a.substring(0,2)&&(a=a.substring(2)),a}).join("\n")}b.text(d(c.escape||a(b.html())))}}}]).directive("codeblock",[function(){return{restrict:"E",priority:1e3,terminal:!0,compile:function(b,c){var d,e;c["for"]?(d=$(c["for"]),e=d.length?d.outerHtml():b.html()):e=b.html(),b.replaceWith($("<pre/>").text(a(e)).outerHtml())}}}])}(),angular.module("filters",[]).filter("roundDown",function(){return function(a){return Math.floor(a)}}).filter("roundHalfUp",function(){return function(a){return Math.round(a)}}).filter("hoursAndMinutes",function(){return function(a){var b,c;return angular.isString(a)&&a.match(/^\d+$/)&&(a=parseInt(a,10)),angular.isNumber(a)?(b=Math.floor(a/60),c=a%60,(b>0?b+"h ":"")+(0===b||c>0?c+"m":"")):""}}).filter("chunk",function(){return function(a,b){function c(a){return a.$$hashKey||(a.$$hashKey=d()),a}function d(){for(var a,b=e.length;b;){if(b--,a=e[b].charCodeAt(0),57===a)return e[b]="A",e.join("");if(90!==a)return e[b]=String.fromCharCode(a+1),e.join("");e[b]="0"}return e.unshift("0"),e.join("")}if(!_.isUndefined(a)){if(_.isUndefined(b))return a;var e=["0","0","0"],f=_.map(_.chunk(a,b),c);return f}}}).filter("moment",function(){return _.memoize(function(a,b){var c,d,e;return moment.isMoment(a)?angular.isObject(b)&&b.hasOwnProperty("calendar")?(c=angular.toJson(b),angular.isUndefined(moment.langData(c))&&(e=moment.lang(),moment.lang(c,_.extend({},b)),moment.lang(e)),d=moment(a),d.lang(c),d.calendar()):a.format(b):a},function(a,b){return angular.toJson({input:a,format:b})})}).filter("slugify",function(){return function(a){return _.str.slugify(a)}}).filter("skipLimit",[function(){return function(a,b,c){return angular.isArray(a)&&c>=0?a.slice(b,b+c):a}}]),angular.module("floater",[]).directive("floater",["$window","$timeout",function(a,b){return{link:function(a,c){var d=$(window),e=$(c);b(function(){var a=e.offset().top;a-=80,d.on("scroll",function(){d.scrollTop()>=a?(e.parents("#sub-header").next(".floater-header").hasClass("floater-header")||e.parents("#sub-header").after("<div class='floater-header'></div>"),$(".floater-section").width()>768&&$(".floater-header").addClass("activebanner"),$(".drawer.is-open").length<=0?$("#sub-header").addClass("fixed"):$("#sub-header").removeClass("fixed"),$("#sub-header").addClass("fixed")):($(".floater-section").removeClass("activebanner"),$("#sub-header").removeClass("fixed"))})})}}}]),angular.module("formTools",["config"]).directive("optMaxlength",[function(){function a(a){return angular.isUndefined(a)||""===a||null===a||a!==a}return{require:"ngModel",link:function(b,c,d,e){if(d.optMaxlength){console.log("attrs.optMaxlength:"+d.optMaxlength);var f=parseInt(d.optMaxlength,10),g=function(b){return!a(b)&&b.length>f?(e.$setValidity("maxlength",!1),b):(e.$setValidity("maxlength",!0),b)};e.$parsers.push(g),e.$formatters.push(g)}}}}]).directive("optMinlength",[function(){function a(a){return angular.isUndefined(a)||""===a||null===a||a!==a}return{require:"ngModel",link:function(b,c,d,e){if(d.optMinlength){var f=parseInt(d.optMinlength,10),g=function(b){return!a(b)&&b.length<f?(e.$setValidity("minlength",!1),b):(e.$setValidity("minlength",!0),b)};e.$parsers.push(g),e.$formatters.push(g)}}}}]).directive("maxLengthMessage",[function(){function a(a){return angular.isUndefined(a)||""===a||null===a||a!==a}return{require:"ngModel",link:function(b,c,d,e){if(b.showMaxLengthMsg=!1,d.maxlength){var f=parseInt(d.maxlength,10),g=function(c){var d=/^[a-zA-Z0-9_]*$/;return!a(c)&&c.length+1>f&&$(this).keypress()&&c.match(d)?(b.showMaxLengthMsg=!0,setTimeout(function(){b.showMaxLengthMsg=!1},2e3),c):(b.showMaxLengthMsg=!1,c)};e.$parsers.push(g),e.$formatters.push(g)}}}}]).filter("passwordStrength",function(){return function(a){var b=function(a){var b=0;for(i=0;i<a.length-1;i++)a.charAt(i)===a.charAt(i+1)&&b++;return b},c=function(a){return 0===a?"TOO SHORT":38>a?"WEAK":a>=38&&63>a?"MEDIUM":a>=63&&88>a?"STRONG":a>=88?"VERY STRONG":void 0},d=function(a){return 0===a?"red":38>a?"orange":a>=38&&63>a?"gold":a>=63&&88>a?"#cae812":a>=88?"#87f529":void 0},e=function(a){var c=8,d=4,e=3,f=1,g=1,h=1,i=1,j=4,k=15;return score=0,"undefined"==typeof a||a.length<c?0:(score+=(a.length-b(a))*d,a.match("((.*[0-9]){"+e+"})")&&a.match("((.*[a-zA-Z]){"+j+"})")?score+=k:a.match("((.*[0-9]){2})")&&a.match("((.*[a-zA-Z]){"+j+"})")&&(score+=k-5),f&&a.match(/([a-z].*[A-Z])|([A-Z].*[a-z])/)&&(score+=10),g&&i&&a.match(/([a-zA-Z])/)&&a.match(/([0-9])/)&&(score+=15),a.match(/[a-zA-Z]+\d+[a-zA-Z]+/)&&(score+=15),a.match(/\d+[a-zA-Z]+\d+/)&&(score+=15),g&&i&&!h&&(a.match(/^\w+$/)||a.match(/^\d+$/))&&(score-=10),isRepetitionOrSequence(a)&&(score=37),score>100?100:score)},f=e(a),g=c(f),h=d(f);return{percent:f,text:g,color:h}}}).filter("phoneFilter",function(){return function(a){if(a){var b=/^[1-9]{1}[0-9]{9}$/;if(b.test(a))return a.substr(0,3)+" "+a.substr(3,3)+"-"+a.substr(6,4)}return a}}).directive("phoneNumber",function(){return{require:"ngModel",link:function(a,b,c,d){d.$parsers.unshift(function(a){if(!("undefined"!=typeof c.required&&c.required||"undefined"!=typeof a&&""!==a))return d.$setValidity("phoneNumber",!0),"";var b="undefined"==typeof a?"":a.replace(/\(|\)|-| /g,"");return!isNaN(b)&&b>=2e9&&9999999999>=b?(d.$setValidity("phoneNumber",!0),b):(d.$setValidity("phoneNumber",!1),void 0)})}}}).directive("inversePattern",function(){return{require:"ngModel",link:function(a,b,c,d){var e=c.inversePattern;e.match(/^\/(.*)\/$/)&&(e=new RegExp(e.substr(1,e.length-2))),d.$parsers.unshift(function(a){return a.match(e)?(d.$setValidity("inversePattern",!1),void 0):(d.$setValidity("inversePattern",!0),a)})}}}).filter("telephoneNumber",function(){return function(a){for(var b=["("],c=0;c<a.length;c++)3===c?b.push(") "):6===c?b.push(" - "):10===c&&b.push(" "),b.push(a.charAt(c));return b.join("")}}).directive("passwordValidation",[function(){return{require:"ngModel",link:function(a,b,c,d){a.safeApply=function(a){var b=this.$root.$$phase;"$apply"===b||"$digest"===b?this.$eval(a):this.$apply(a)};var e=null;b.bind("focus",function(){d.$focused=!0}),b.bind("blur",function(){d.$focused=!1}),b.bind("keyup",function(){clearTimeout(e),e=setTimeout(function(){var c=/^[a-zA-Z0-9_]*$/,e=$(b).val();try{if(e.length<6||e.length>32)return d.$setValidity("length",!1),d.$message="Your password must be between 6-32 characters. Please try again.",void 0;if(!e.match(c))return d.$setValidity("characters",!1),d.$message="Your password can contain only letters and numbers. No special characters are allowed.",void 0;d.$setValidity("length",!0),d.$setValidity("characters",!0),d.$message=$filter("passwordStrength")(e).text}finally{a.safeApply()}},500)})}}}]).directive("matches",function(){return{require:"ngModel",scope:{expectedValue:"&matches"},link:function(a,b,c,d){var e=a.expectedValue();if(!("$parsers"in e&&"$viewValue"in e&&"$dirty"in e))throw"matches has to referer to another form controller";e.$parsers.unshift(function(a){var b=d.$viewValue===a;return d.$setValidity("matches",b),e.$dirty&&"function"==typeof d.showValidationMsg&&d.showValidationMsg(!1,1),a}),d.$parsers.unshift(function(a){return d.$setValidity("matches",e.$viewValue===a),a})}}}).directive("notEqual",function(){return{require:"ngModel",link:function(a,b,c,d){var e;c.$observe("notEqual",function(a){e=a,d.$setValidity("notEqual",!angular.isString(e)||""===e||e!==d.$viewValue),b.trigger("keyup")}),d.$parsers.unshift(function(a){return d.$setValidity("notEqual",!angular.isString(e)||""===e||e!==a),a})}}}).directive("checkEmail",function(){return{require:"ngModel",link:function(a,b,c,d){var e,f;c.$observe("checkEmail",function(a){e=a+"@optimum.net",f=a+"@optonline.net",d.$setValidity("checkEmail",!angular.isString(e)||""===e||e!==d.$viewValue&&f!==d.$viewValue),b.trigger("keyup")});var g=function(a){return d.$setValidity("checkEmail",!angular.isString(e)||""===e||e!==a&&f!==a),a};d.$parsers.unshift(g),a.$watch(c.ngModel,g)}}}).directive("confirmPassword",[function(){return{require:"ngModel",link:function(a,b,c,d){b.bind("focus",function(){a.isConPassFocus=!0}),b.bind("blur",function(){a.isConPassFocus=!1}),a.safeApply=function(a){var b=this.$root.$$phase;"$apply"===b||"$digest"===b?this.$eval(a):this.$apply(a)};var e=null,f=function(a,b){a===b?(d.$setValidity("passwordMatch",!0),d.$message="Confirm password matches."):(d.$setValidity("passwordMatch",!1),d.$message="Your entries in the password fields do not match. Please try again.")};a.$watch(c.confirmPassword,function(a){e=a;var b=d.$viewValue;d.$dirty&&f(b,e)}),d.$parsers.unshift(function(b){return e=void 0===a.password?a.model.password:a.password.password,b===e?(d.$setValidity(c.name,!0),b):(d.$setValidity(c.name,!1),b)})}}}]).directive("optimumIdInput",["Config",function(a){return{require:"ngModel",link:function(b,c,d,e){var f=a.getValuesBySelector("*").formValidation.optimumIdInput,g=null,h=function(a){var b=/[^\w|\.|\-|_*]|^\.|^-|^_|\.$|-$|_$|(-|_|\.)\1+/;return a.length<4?(e.$message=f.errors.tooShort,e.$setValidity(d.name,!1),!1):a.length>14?(e.$message=f.errors.tooLong,e.$setValidity(d.name,!1),!1):a.match(b)?(e.$message=f.errors.beginChars,e.$setValidity(d.name,!1),!1):!0},i=function(){return!0},j=function(){var a=$(c).val();h(a)&&i(a,"")&&(e.$message=f.success,e.$setValidity(d.name,!0)),b.$apply()};c.bind("focus",function(){e.$focused=!0}),c.bind("blur",function(){e.$focused=!1}),c.bind("keyup",function(){null!==g&&clearTimeout(g),g=setTimeout(j,500)}),e.$message=f.hint,e.$focused=!1}}}]).directive("firstNameInput",["Config",function(a){return{require:"ngModel",link:function(b,c,d,e){var f=a.getValuesBySelector("*").formValidation.firstNameInput,g=null,h=function(){var a=$(c).val();-1!==a.indexOf(".")||-1!==a.indexOf("_")||-1!==a.indexOf("-")?(e.$message=f.errors.invalidChars,e.$setValidity(d.name,!1)):0===a.length?(e.$message=f.errors.tooShort,e.$setValidity(d.name,!1)):(e.$message=f.success,e.$setValidity(d.name,!0)),b.$apply()};c.bind("focus",function(){e.$focused=!0}),c.bind("blur",function(){e.$focused=!1}),c.bind("keyup",function(){null!==g&&clearTimeout(g),g=setTimeout(h,500)}),e.$message=f.hint,e.$focused=!1}}}]).directive("lastNameInput",["Config",function(a){return{require:"ngModel",link:function(b,c,d,e){var f=a.getValuesBySelector("*").formValidation.lastNameInput,g=null,h=function(){var a=$(c).val();-1!==a.indexOf(".")||-1!==a.indexOf("_")||-1!==a.indexOf("-")?(e.$message=f.errors.invalidChars,e.$setValidity(d.name,!1)):0===a.length?(e.$message=f.errors.tooShort,e.$setValidity(d.name,!1)):(e.$message=f.success,e.$setValidity(d.name,!0)),b.$apply()};c.bind("focus",function(){e.$focused=!0}),c.bind("blur",function(){e.$focused=!1}),c.bind("keyup",function(){null!==g&&clearTimeout(g),g=setTimeout(h,500)}),e.$message=f.hint,e.$focused=!1}}}]).directive("zipCodeInput",["Config",function(a){return{require:"ngModel",link:function(b,c,d,e){var f=a.getValuesBySelector("*").formValidation.zipCodeInput,g=null,h=function(){var a=$(c).val();isNaN(a)?(e.$message=f.errors.invalidChars,e.$setValidity(d.name,!1)):a.length>5?(e.$message=f.errors.tooLong,e.$setValidity(d.name,!1)):(e.$message=f.success,e.$setValidity(d.name,!0)),b.$apply()};c.bind("focus",function(){e.$focused=!0}),c.bind("blur",function(){e.$focused=!1}),c.bind("keyup",function(){null!==g&&clearTimeout(g),g=setTimeout(h,500)}),e.$message=f.hint,e.$focused=!1}}}]).directive("firstName",function(){return{require:"ngModel",link:function(a,b,c,d){var e=function(a){return a&&a.length>15?(d.$setValidity(c.name,!1),a):(d.$setValidity(c.name,!0),a)};a.$watch(c.ngModel,e),d.$parsers.unshift(e)}}}).directive("lastName",function(){return{require:"ngModel",link:function(a,b,c,d){var e=function(a){return a?0===a.length||a.length>25?(d.$setValidity(c.name,!1),a):(d.$setValidity(c.name,!0),a):(d.$setValidity(c.name,!1),a)};a.$watch(c.ngModel,e),d.$parsers.unshift(e)}}}).directive("zipCode",function(){return{require:"ngModel",link:function(a,b,c,d){var e=function(a){var b=/^[0-9]{5}$/;return a&&a.length>0&&!a.match(b)?(d.$setValidity(c.name,!1),a):(d.$setValidity(c.name,!0),a)};a.$watch(c.ngModel,e),d.$parsers.unshift(e)}}}).directive("optimumId",function(){return{require:"ngModel",link:function(a,b,c,d){d.$parsers.unshift(function(a){return a.length<4?(d.$setValidity(c.name,!1),void 0):a.length>14?(d.$setValidity(c.name,!1),void 0):"."===a[0]||"-"===a[0]||"_"===a[0]?(d.$setValidity(c.name,!1),void 0):"."===a[a.length-1]||"-"===a[a.length-1]||"_"===a[a.length-1]?(d.$setValidity(c.name,!1),void 0):(d.$setValidity(c.name,!0),a)})}}}).directive("password",function(){return{require:"ngModel",link:function(a,b,c,d){b.on("paste",function(a){var b;a.originalEvent.clipboardData?b=(a.originalEvent||a).clipboardData.getData("text/plain"):window.clipboardData&&(b=window.clipboardData.getData("text")),e("pasteEvent",a,b),d.$setValidity("repeatedSequential",!isRepetitionOrSequence(b))}),b.bind("keydown",function(b){var c=void 0===a.password?a.model.password:a.password.password;e("keyEvent",b,c)}),b.on("keyup",function(){var b=void 0===a.password?a.model.password:a.password.password;d.$setValidity("repeatedSequential",!isRepetitionOrSequence(b))});var e=function(b,c,e){var f=!1,g=/^[a-zA-Z0-9_]*$/;"number"==typeof this.selectionStart&&this.selectionEnd-this.selectionStart>0&&(f=!0);var h=e.length,i=c.keyCode?c.keyCode:c.which;if((h>=32&&"keyEvent"===b||h>32&&"pasteEvent"===b)&&!f){if(!(i>=35&&40>=i||46===i||8===i||9===i))return"keyEvent"===b&&c.preventDefault(),e.match(g)&&("keyEvent"===b?a.showMaxLengthMsg=!0:d.$setValidity("maxlength",!1)),setTimeout(function(){a.showMaxLengthMsg=!1},2e3),!1;8!==i&&46!==i||33!==h||"keyEvent"!==b||d.$setValidity("maxlength",!0)}else a.showMaxLengthMsg=!1,d.$setValidity("maxlength",!0)};d.$parsers.unshift(function(b){var e=/^[a-zA-Z0-9_]*$/;return void 0!==b&&b.match(e)?(targetInput=void 0===a.password?a.model.confirmPassword:a.password.passwordMatch,b===targetInput?(d.$setValidity(c.name,!0),a.resetPassword?a.resetPassword.confirmPassword.$setValidity("confirmPassword",!0):a.changePasswdForm?a.changePasswdForm.passwordMatch.$setValidity("passwordMatch",!0):a.secondaryIdForm?a.secondaryIdForm.confirmPassword.$setValidity("confirmPassword",!0):a.customerInfoForm?a.customerInfoForm.confirmPassword.$setValidity("confirmPassword",!0):a.resetPasswordForm&&a.resetPasswordForm.confirmPassword.$setValidity("confirmPassword",!0),b):(d.$setValidity(c.name,!0),b)):(d.$setValidity(c.name,!1),b)})}}}).directive("alphanumeric",function(){return{require:"ngModel",link:function(a,b,c,d){d.$parsers.unshift(function(a){var b=/[^a-zA-Z0-9$]/;return d.$setValidity("alphanumeric",!b.test(a)),a})}}}).directive("numericOnly",function(){return{require:"ngModel",link:function(a,b,c,d){b.on("keydown",function(a){46===a.keyCode||8===a.keyCode||9===a.keyCode||27===a.keyCode||13===a.keyCode||a.ctrlKey===!0||a.metaKey===!0||a.keyCode>=35&&a.keyCode<=39||(a.shiftKey||(a.keyCode<48||a.keyCode>57)&&(a.keyCode<96||a.keyCode>105))&&a.preventDefault()}).on("input",function(){var b=this;b.value.match(/\D/)&&a.$apply(function(){b.value=b.value.replace(/\D/g,"")})}),d.$parsers.unshift(function(a){return a?a.replace(/[^0-9]/g,""):a})}}}).directive("email",function(){return{require:"ngModel",link:function(a,b,c,d){var e=/^(([^<>()\[\]\\.,;:\s@\"]+(\.[^<>()\[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,f=function(a){return a?a.match(e)?(d.$setValidity(c.name,!0),a):(d.$setValidity(c.name,!1),a):(d.$setValidity(c.name,!0),a)};a.$watch(c.ngModel,f),d.$parsers.unshift(f)}}}).directive("altEmail",function(){return{require:"ngModel",link:function(a,b,c,d){var e=/^(([^<>()\[\]\\.,;:\s@\"]+(\.[^<>()\[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,f=function(b){if(b){if(b.length>0&&!b.match(e))return d.$setValidity(c.name,!1),b;if(b.toLowerCase()===a.optimumIdEmail.toLowerCase())return d.$setValidity(c.name,!1),b}return d.$setValidity(c.name,!0),b};a.$watch(c.ngModel,f),d.$parsers.unshift(f)}}}).directive("formatPhone",["$filter",function(a){return{require:"ngModel",link:function(b,c,d,e){c.on("input paste keyup",function(a){var b=a.keyCode?a.keyCode:a.which,c=this.value,d=null,f=!1,h=null,i=null;if("number"==typeof this.selectionStart&&this.selectionEnd-this.selectionStart>0&&(f=!0),h=4===this.selectionStart||8===this.selectionStart?this.selectionStart+1:this.selectionStart,i=4===this.selectionEnd||8===this.selectionEnd?this.selectionEnd+1:this.selectionEnd,!(b>=35&&40>=b||46===b||b>=8&&9>=b||f)){if(d=c.replace(/[^\d]/g,""),d.length>3&&d.length<6?c=d.substr(0,3)+" "+d.substring(3):d.length>6&&(c=d.substr(0,3)+" "+d.substr(3,3)+"-"+d.substr(6,4)),this.value=c,this.createTextRange){var j=this.createTextRange();j.moveEnd("character",i),j.moveStart("character",h)}else this.setSelectionRange&&this.setSelectionRange(h,i);g(this.value)}e.$setViewValue(this.value)});var f=function(b){return a("phoneFilter")(b)},g=function(b){if(b){var c=/\d{3}[ ]\d{3}[-]\d{4}/;return 10===b.length&&(b=a("phoneFilter")(b)),c.test(b)?(e.$setValidity(d.name,!0),b):(e.$setValidity(d.name,!1),b)}return e.$setValidity(d.name,!0),b};b.$watch(d.ngModel,g),e.$parsers.unshift(g),e.$formatters.push(f)}}}]).directive("phone",function(){return{require:"ngModel",link:function(a,b,c,d){var e=function(a){return a?isNaN(a)?(d.$setValidity(c.name,!1),a):a.length>0&&10!==a.length?(d.$setValidity(c.name,!1),a):(d.$setValidity(c.name,!0),a):void 0};a.$watch(c.ngModel,e),d.$parsers.unshift(e)}}}).directive("altPhone",function(){return{require:"ngModel",link:function(a,b,c,d){var e=function(a){if(a&&a.length>0){if(isNaN(a))return d.$setValidity(c.name,!1),a;if(10!==a.length)return d.$setValidity(c.name,!1),a}return d.$setValidity(c.name,!0),a};a.$watch(c.ngModel,e),d.$parsers.unshift(e)}}}).directive("accountIdFormat",function(){return{require:"ngModel",link:function(a,b,c,d){b.on("keydown propertychange",function(a){if(46===a.keyCode||8===a.keyCode||9===a.keyCode||27===a.keyCode||13===a.keyCode||(a.ctrlKey===!0||a.metaKey===!0||17===a.keyCode)&&86===a.keyCode||a.keyCode>=35&&a.keyCode<=40||a.keyCode>=48&&a.keyCode<=57&&a.shiftKey!==!0||a.keyCode>=96&&a.keyCode<=105&&a.shiftKey!==!0||109===a.keyCode||189===a.keyCode||173===a.keyCode){var b=this.value,c=b;(109===a.keyCode||189===a.keyCode||173===a.keyCode)&&("0"===c.substring(0,1)&&5!==c.length&&12!==c.length||"0"!==c.substring(0,1)&&4!==c.length&&11!==c.length)&&a.preventDefault()}else a.preventDefault()}).on("input paste keyup focusout",function(a){var b=a.keyCode?a.keyCode:a.which,c=this,d=c.value,e=null,f=!1;"number"==typeof this.selectionStart&&this.selectionEnd-this.selectionStart>0&&(f=!0),b>=35&&40>=b||46===b||8===b||f||(e=d.replace(/-/g,""),"0"===e.substring(0,1)&&e.length>5&&e.length<11?d=e.substring(0,5)+"-"+e.substring(5):"0"!==e.substring(0,1)&&e.length>4&&e.length<11?10===e.length&&"-"===d.substring(d.length-1,d.length)||(d=e.substring(0,4)+"-"+e.substring(4)):e.length>=10&&e.length<=12&&"0"!==e.substring(0,1)?(d=e.substring(0,4)+"-"+e.substring(4,10)+"-"+e.substring(10,12),this.maxLength=14):e.length>=12&&e.length<=13&&"0"===e.substring(0,1)?(d=e.substring(0,5)+"-"+e.substring(5,11)+"-"+e.substring(11,13),this.maxLength=15):(e.length>13&&"0"===e.substring(0,1)||e.length>=13&&"0"!==e.substring(0,1))&&(86===a.keyCode||17===a.keyCode?"0"===e.substring(0,1)?d=e.substring(0,5)+"-"+e.substring(5,11)+"-"+e.substring(11,e.length):"0"!==e.substring(0,1)&&(d=e.substring(0,4)+"-"+e.substring(4,10)+"-"+e.substring(10,e.length)):"0"===e.substring(0,1)?this.maxLength=15:"0"!==e.substring(0,1)&&(this.maxLength=14)),c.value=d)}),d.$parsers.unshift(function(a){var b=0;if(void 0===a)return d.$setValidity(c.name,!1),d.$setValidity("minlength",!0),a;if(a=a.replace(/-/g,""),a.length<12&&"0"!==a[0])return d.$setValidity("minlength",!1),d.$setValidity(c.name,!0),a;if(a.length<13&&"0"===a[0])return d.$setValidity("minlength",!1),d.$setValidity(c.name,!0),a;for(var e=a.split("-").join(""),f=0;f<e.length;f++)e[f]>=0&&e[f]<=9||(b=1);return 1===b?(d.$setValidity(c.name,!1),a):0===b?e.length>=13&&"0"!==e[0]||e.length>=14&&"0"===e[0]?(d.$setValidity("maxlength",!1),d.$setValidity(c.name,!1),a):12===e.length&&"0"!==e[0]||"0"===e[0]&&13===e.length?(d.$setValidity("maxlength",!0),d.$setValidity("minlength",!0),d.$setValidity(c.name,!0),a):(d.$setValidity("minlength",!0),d.$setValidity(c.name,!0),a):(d.$setValidity(c.name,!0),a)})}}}).directive("validationMsg",function(){return{template:["<div ng-transclude><div>"].join(""),restrict:"A",replace:!0,transclude:"element",scope:{messages:"=messages",inputElement:"@validationMsg",showHint:"@showHint",delay:"@delay"},link:function(a,b,c){if(!c.validationMsg)throw"[Form-tools: validationMessage] validationMsg has no form input defined";var d=c.validationMsg.split("."),e=d.shift(),f=b.closest("[name='"+e+"']").find("[name='"+d.pop()+"']"),g=a.$parent.$eval(c.validationMsg),h=a.$parent.$eval(e);if(!g)throw"[Form-tools: validationMessage] validationMsg specifies an invalid input element";if(!a.messages)throw"[Form-tools: validationMessage] 'messages' is not valid";var i=null,j=a.messages.errors?a.messages.errors:{},k=a.messages.hint,l=a.messages.defaultError,m=a.messages.success,n=c.delay?parseInt(c.delay,10):750;a.$$nextSibling.message={value:"",type:void 0},void 0!==c.showHint&&(i=setTimeout(function(){o(k,"hint")},50));var o=function(b,c){a.$$nextSibling.message&&(a.$$nextSibling.message.type=c,a.$$nextSibling.message.value=b,a.$$phase||a.$$nextSibling.$digest())},p=function(){a.showHint=!1;var b=g.$viewValue.split("-").join("");if(g.$invalid){var c=l;for(var d in j)g.$error[d]&&g.$dirty&&(c=j[d]);if(g.$dirty&&g.$error.maxlength&&g.$error.password&&j.maxlength?c=j.maxlength:g.$dirty&&(g.$error.maxlength||b.length>=13&&"0"!==b[0]||g.$error.maxlength||b.length>=14&&"0"===b[0])&&j.maxlength&&"accountNumber"===g.$name&&(c=j.maxlength),"accountNumber"===g.$name)for(var e=0;e<b.length;e++)if(!(b[e]>=0&&b[e]<=9||"-"===b[e])){c=j.alphanumeric;break}o(c,"error")}else if("accountNumber"===g.$name)for(var f=0,h=0;h<g.$viewValue.length;h++)if(f="0"!==b[0]&&12===b.length?0:"0"===b[0]&&13===b.length?0:1,1===f)for(var i in b)b[i]>=0&&b[i]<=9||"-"===b[i]?"0"!==b[0]&&b.length>=13||"0"===b[0]&&b.length>=14?o(a.messages.errors.maxlength,"error"):"0"===b[0]&&b.length<=12&&o(a.messages.errors.minlength,"error"):o(a.messages.errors.alphanumeric,"error");else o(m,"success");else o(m,"success")};f.bind("focus",function(){g.$wasFocused=!0,o(k,"hint")}),f.bind("input keyup paste",function(){null!==i&&clearTimeout(i),g.$wasFocused&&o(k,"hint"),i=setTimeout(p,n)}),f.bind("keydown",function(){null!==i&&clearTimeout(i),g.$wasFocused&&o(k,"hint"),i=setTimeout(p,n)}),g.showValidationMsg=function(a,b){null!==i&&clearTimeout(i);var c=function(){a?o(k,"hint"):p()};i=setTimeout(c,b?b:n)},h.showValidationMsgs||(h.showValidationMsgs=function(a){var b=function(c){c&&c.showValidationMsg&&c.showValidationMsg.call(c,a),_.each(_.filter(c,function(a){return"object"==typeof a}),b)};_.each(h,b)})}}}).directive("autoTabOn",function(){return{restrict:"A",name:"autoTabOn",replace:!1,transclude:!1,scope:{tabPredicate:"&autoTabOn"},link:function(a,b){if("input"!==b[0].localName.toLowerCase())throw"AutoTabOn can only be applied to an input element";if(!b.attr("tabIndex"))throw"AutoTabOn requires the tabIndex attribute to be set";a.elementFocused=!1,a.elementSelected=!1,b.focus(function(){a.elementFocused=!0}),b.blur(function(){a.elementFocused=!1}),b.select(function(){a.elementSelected=!0}),b.keyup(function(c){var d=48;if(c.which>=d&&a.elementFocused)if(!a.elementSelected&&a.tabPredicate()){var e=parseInt(b.attr("tabIndex"),10)+1,f=angular.element('[tabIndex*="'+e+'"]');0!==f.length&&(f.focus(),f.select())}else a.elementSelected=!1})}}});var isRepetitionOrSequence=function(a){var b=/(.)\1{3,}/;if(a.length>7){var c=a.toLowerCase().split("");if(a.toLowerCase().match(b))return!0;for(var d=3;d<a.length;d++){if(c[d].charCodeAt(0)===c[d-3].charCodeAt(0)+3&&c[d].charCodeAt(0)===c[d-2].charCodeAt(0)+2&&c[d].charCodeAt(0)===c[d-1].charCodeAt(0)+1)return!0;if(c[d].charCodeAt(0)===c[d-3].charCodeAt(0)-3&&c[d].charCodeAt(0)===c[d-2].charCodeAt(0)-2&&c[d].charCodeAt(0)===c[d-1].charCodeAt(0)-1)return!0}}return!1};angular.module("gadgetCarousels",["dots","if","dvrRecord","ellipsis","poster","imgAlt","hover","isViewportSize"]).directive("carouselGadget",["$timeout","limitToFilter","isViewportSize",function(a,b,c){return{restrict:"AE",scope:{showHide:"=show",localItems:"=items",showMock:"=mock",isLazy:"=lazy",positionWithPosition:"=positionWithPosition",isIndented:"=indent",extraIndent:"=extraIndent",maxSets:"=maxSets",scrollByPixels:"=scrollByPixels",type:"=type"},transclude:!0,replace:!1,templateUrl:"/parts/gadget-carousels/gadget-carousels-template.html",link:function(d,e){function f(){nb(),mb&&(P.items=P.generateMockElements(),ab=P.items.length),p(),d.$emit("carouselEvent",{eventName:"load",eventTarget:$(e)}),k()?(R.addClass("art"),R.removeClass("block"),P.isArtwork=!0):(R.addClass("block"),R.removeClass("art"),P.isArtwork=!1),N(),i()}function g(){console.log("mock: test callback action")}function h(){var a=!1;(d.localItems[0]!==d.items[0]||d.localItems.length<d.items.length)&&(a=!0),P.items=P.localItems,N(),i(),a&&M()}function i(){var a;try{delete P.maxItems}catch(b){}if(null!==(a=l())){var c=0,d=0,e=u();_.each(P.items,function(b,f){return c+=b.itemWidth||140,c>e&&(d++,c=c-(k()?28:0)<=e?0:b.itemWidth||140),d>=a?(P.maxItems=f,!1):void 0})}}function j(){a(function(){var a,b=R.width();k()?(P.isArtwork=!0,R.addClass("art"),R.removeClass("block"),angular.isNumber(b)&&b>100&&(a=P.getLimitedItems().length*R.find(".item").outerWidth(!0))>10?S.width(a+10+"px"):S.width(""),S.height()<R.find(".poster").height()&&(S.css("height",R.find(".poster").height()),U.css("top",0),V.css("top",0))):(P.isArtwork=!1,R.addClass("block"),R.removeClass("art"),S.width(""),S.css("max-height",ib)),p()
})}function k(){var a=!1;return"block"===P.type?!1:"art"===P.type?!0:($.each(P.items,function(b,c){return c.artwork?(a=!0,!1):void 0}),a)}function l(){var a=P.maxSets;return angular.isString(a)&&a.match(/^\d+$/)&&(a=parseInt(a,10)),angular.isNumber(a)&&a>0?a:null}function m(a){return parseInt(a.toString().match(/-(\d+)$/)[1],10)}function n(a,b){if(a.attr("id")){var c=P.getLimitedItems()[m(a.attr("id"))];return b===!0?c.secondItem.action:c.action}console.warn("warning, item.attr(id) is undefined")}function o(a){return P.getLimitedItems()[m(a.parents(".item").attr("id"))].buttons[a.attr("value")].action}function p(){jb=P.isIndented?0===P.getLimitedItems().length?[]:new Array(1+Math.ceil((S.width()-z(y()))/u())):0===P.getLimitedItems().length?[]:new Array(Math.ceil(S.width()/u())),d.dots=jb}function q(a,b){var c=!0;if(void 0===$(R.find(".item")[E()+1]).offset()&&"next"===a&&(c=!1,R.removeClass("show-next-ui")),kb===!0&&"previous"===a&&(R.removeClass("show-prev-ui"),c=!1),c===!0){var d="first"===a?0:"next"===a?F():H();K()&&P.isIndented?y():0,(lb===d||d>lb-200)&&0!==lb&&"next"===a&&0!==d&&(d=2*lb),S.animate({left:d},hb,"swing",function(){"function"==typeof b&&setTimeout(function(){b()},hb)}),lb=d,"next"===a&&(P.currentSet++,C(E()+1)),"previous"===a&&(P.currentSet--,P.currentSet<0&&(P.currentSet=1),C(E(!0)))}}function r(){isMobile()||(K()?(R.removeClass("show-prev-ui"),L()?R.removeClass("show-next-ui"):R.addClass("show-next-ui")):kb===!0?(R.removeClass("show-prev-ui"),R.addClass("show-next-ui")):L()?(R.addClass("show-prev-ui"),R.removeClass("show-next-ui")):void 0===$(R.find(".item")[E()+1]).offset()?(R.removeClass("show-next-ui"),R.addClass("show-prev-ui")):(R.addClass("show-prev-ui"),R.addClass("show-next-ui")),eb=!0),isMobile()&&(K()?(R.removeClass("show-prev-ui"),L()?R.removeClass("show-next-ui"):R.addClass("show-next-ui")):kb===!0?(R.removeClass("show-prev-ui"),R.addClass("show-next-ui")):L()?(R.addClass("show-prev-ui"),R.removeClass("show-next-ui")):void 0===$(R.find(".item")[E()+1]).offset()?(R.removeClass("show-next-ui"),R.addClass("show-prev-ui")):(R.addClass("show-prev-ui"),R.addClass("show-next-ui")),eb=!0)}function s(){eb&&r()}function t(){R.css("left",0),R.width(u()),R.removeClass("indented")}function u(){return P.isIndented?$(window).width()-$(e).position().left:$(e).offsetParent().width()-$(e).position().left}function v(){P.isIndented&&(R.css("left",y()),R.width(z(y())),R.addClass("indented"),S.css("left",0))}function w(){var a=u();R.width(!isNaN(a)&&a>1?a:"")}function x(){return R.hasClass("indented")}function y(){return T[P.positionWithPosition?"position":"offset"]().left+(angular.isNumber(P.extraIndent)?P.extraIndent:0)}function z(a){return u()-a}function A(){return x()?u()-y():angular.isNumber(d.scrollByPixels)?u()-$(R.find(".item")[Y]).offset().left:u()}function B(a){var b=0,c=-1,d=0,e=$(R.find(".item")),f=Y;if(e.size()*e.outerWidth(!0)>u())for(;Math.round(b)<A()&&c!==b&&-1!==f;)c=b,b+=$(e[f]).outerWidth(!0),d++,f=a?f-=1:f+=1;return d-1}function C(a){try{var b=d.localItems[a].maintitle+d.localItems[a].title;setTimeout(function(){angular.element('div[data-title="'+b+'"]').siblings().hide(),angular.element('div[data-title="'+b+'"]').show()},500),angular.element('li[data="'+b+'"]').siblings().removeClass("active"),angular.element('li[data="'+b+'"]').addClass("active")}catch(c){}Y=a}function D(){return Y}function E(a){var b,c=R.find(".item");b=a?$(c[D()-B(a)]).index():$(c[B()-1+D()]).index();try{d.localItems[b].maintitle+d.localItems[b].title,Z=b+1,0===bb&&(db=b+1,cb=Z)}catch(e){}return b}function F(){return K()&&P.isIndented?-1*(G()-y()):J()+-1*G()}function G(){var a=$(R.find(".item")[E()+1]).offset().left,b=$(e).position().left,c=a-b;return Z===cb?(a=c,bb=Z,cb=0):db===Z&&(a=c),P.isIndented||(a-=$(R).offset().left),angular.isNumber(d.scrollByPixels)&&(a=d.scrollByPixels*Math.floor(A()/d.scrollByPixels)),console.log("return part"+a),a}function H(){return J()+Math.abs(I())}function I(){var a=$(R.find(".item")[E(!0)]).offset().left;return P.isIndented||(a-=$(R).offset().left),angular.isNumber(d.scrollByPixels)&&(a=d.scrollByPixels*Math.floor(Math.max(0,A())/d.scrollByPixels)),a}function J(){return $(R).find(".slide")[P.isIndented?"offset":"position"]().left}function K(){return 1===P.currentSet}function L(){return P.currentSet===jb.length}function M(){q("first",function(){P.currentSet=1,C(0)})}function N(){K()&&P.isIndented?v():P.isIndented?t():w(),j(),a(s,hb)}var O=500,P=d,Q=$(e).attr("id"),R=$(e).find(".carousel"),S=$(e).find(".slide");$(e).find(".item");var T=$(e).find(".dots"),U=$(e).find(".carousel-next"),V=$(e).find(".carousel-prev"),W=0;P.currentSet=1;var X,Y=0,Z=0,ab=0,bb=0,cb=0,db=0,eb=!1,fb=!1,gb="",hb=200,ib=60,jb=[],kb=!1,lb=0,mb=P.showMock?parseInt(P.showMock,10):!1;P.items=[],P.load=function(){};var nb=function(){function a(a){l=a.touches[0].clientX,m=a.touches[0].clientY}function b(a){V.unbind("touchmove"),V.unbind("touchend"),Math.abs(l-j)>maxMove||Math.abs(m-k)>maxMove||d.$apply(function(){fn(d,{$event:a})})}var f=function(a){var b=$(a.target),d={targetElem:b,clickedItem:b.is("li")?b:b.parents(".item"),clickedBtn:b.is("button")?b:b.closest("button").length>0?b.closest("button"):!1,clickedDVRRecord:b.is("dvr-record, [dvr-record]")||b.closest("dvr-record, [dvr-record]").length>0?b:!1,clickedInfoBlock:b.is(".info-block")?b:b.closest(".info-block")};if(d.clickedSecondItem=d.clickedInfoBlock.prev().is(".info-block"),d.clickedItem){if(isMobile()&&!fb&&!c.phone&&gb!==d.clickedItem.attr("id"))return gb=d.clickedItem.attr("id"),void 0;isMobile()&&!fb?X=setTimeout(function(){g(a,d)},O):isMobile()||fb||g(a,d)}},g=function(a,b){b.clickedDVRRecord||(!b.clickedBtn&&n(b.clickedItem,b.clickedSecondItem)&&angular.isFunction(n)?n(b.clickedItem,b.clickedSecondItem)():b.clickedBtn&&o(b.clickedBtn)&&angular.isFunction(o)&&o(b.clickedBtn)()),d.$emit("carouselEvent",{eventName:"click",eventTarget:a.target})};e.bind("click",function(a){f(a)}),P.isPast=function(a){return angular.isDate(a)&&a.getTime()<(new Date).getTime()},$(window).resize(function(){P.$apply(function(){N()})}),$(e).mouseover(function(){r()}),r(),$(e).mouseout(function(){}),V.click(function(a){q("previous",function(){$(a.target).hasClass("icon-arrow-left")?parseInt($(a.target).parent().next("div").next("div").css("left"),10)>=-500&&(R.removeClass("show-prev-ui"),kb=!0):$(a.target).hasClass("half-circle--left")?parseInt($(a.target).next("div").next("div").css("left"),10)>=-500&&(R.removeClass("show-prev-ui"),kb=!0):kb=!1,R.addClass("show-next-ui")})}),U.click(function(){q("next",function(){kb=!1,R.addClass("show-prev-ui")})});var j,k,l,m;V.bind("touchstart",function(c){c.preventDefault(),q("previous",function(){$(c.target).hasClass("icon-arrow-left")?parseInt($(c.target).parent().next("div").next("div").css("left"),10)>=-500&&(R.removeClass("show-prev-ui"),kb=!0):$(c.target).hasClass("half-circle--left")?parseInt($(c.target).next("div").next("div").css("left"),10)>=-500&&(R.removeClass("show-prev-ui"),kb=!0):(kb=!1,R.addClass("show-prev-ui")),R.addClass("show-next-ui")}),j=l=c.touches[0].clientX,k=m=c.touches[0].clientY,V.bind("touchend",b),V.bind("touchmove",a)}),U.bind("touchstart",function(c){c.preventDefault(),q("next",function(){kb=!1}),j=l=c.touches[0].clientX,k=m=c.touches[0].clientY,V.bind("touchend",b),V.bind("touchmove",a)}),P.$watch("localItems",function(a){a&&(ab=d.localItems.length,setTimeout(function(){P.$apply(p)},100),h())}),P.$watch("localItems.length",function(a){a&&h()}),P.$watch("showHide",function(){d.showHide===!0?($(e).removeClass("hidden"),N()):$(e).addClass("hidden")}),P.$watch("isIndented",function(){N(),i()}),P.onScroll=function(a,b,c){d.$emit("carouselEvent",{carouselId:Q,eventName:"scroll",eventTarget:R.find(".item")[a],offset:b,offsetDelta:b-W-c}),W=b}};P.generateMockElements=function(){var a=[];switch(mb){case 1:for(var b=1;20>=b;b++)a.push({id:"item",action:g,artwork:"/parts/carousels/images/art"+b+".jpg",info:"Null am mollis elit eget eros feugiat commodo.",buttons:[{label:"Record",icon:"icon-stop",action:g},{label:"Add to Cart",icon:"icon-shopping-cart",action:""}]});break;case 2:for(;20>=b;b++)a.push({id:"item",action:g,itemWidth:getRandomInt(10,200),info:"Null am mollis elit eget eros feugiat commodo.",buttons:[{label:"Record",icon:"icon-stop",action:g},{label:"Add to Cart",icon:"icon-shopping-cart",action:""}]})}return a},P.getLimitedItems=function(){return angular.isNumber(P.maxItems)?b(P.items,P.maxItems):P.items},f()}}}]);var maxHistoryURLSize=5;angular.module("homeModules",["bestBets","wifiService","phoneService","miniGuideResource","onDemandResource","webdvrResource","spinner","checkbox","ellipsis","oolCookie","poster","ctaArrowLink","isViewportSize","config","dvrRecordingModel"]).directive("homeModule",["$rootScope","Config","BestBets","Wifi","Phone","MiniGuide","OnDemand","WebDVR","ooluser","$filter","$timeout","isViewportSize","recordingModel",function(a,b,c,d,e,f,g,h,i,j,k,l){return{restrict:"A",scope:{type:"=moduleType",active:"=",webmail:"="},replace:!0,templateUrl:"/parts/home-modules/home-modules-template.html",link:function(a,f){var j=a,m=$(f).find(".dropdown-module-prefs");$(f).find(".module-select");var n,o,p=500,q=5e3;a.showLink=!0;var r=[{selected:!1,id:"voiceMail",title:"Voicemail"},{selected:!1,id:"onDemand",title:"On Demand"},{selected:!1,id:"wifiUsage",title:"WiFi usage"},{selected:!1,id:"webMail",title:"Email"},{selected:!1,id:"cart",title:"Cart"},{selected:!1,id:"onTonight",title:"TV best bets"},{selected:!1,id:"dvr",title:"DVR"}],s={corpId:"",hasSession:!1,optimumId:"",inbox:[],hasService:{internet:!1,eMail:!1,phone:!1,tv:!1,dvr:!1}},t=["answered","flagged","draft","deleted","seen","forwarded","unseen"];j.module={},j.module.initialized=!1,j.module.noEntitlement=!1,j.module.loading=!1,j.module.error=!1,j.isViewportSize=l,j.$watch("active",function(){for(var a in j.active)j.active.hasOwnProperty(a)&&(a===j.type&&j.active[a]?($(f).addClass(j.active[a]),$(f).removeClass("hidden"),j.module.initialized?z():A()):a!==j.type||j.active[a]?j.active[a]&&(o=a):($(f).addClass("hidden"),$(f).removeClass("left right")));z()},!0),m.click(function(){$(this).find(".menu").show()}),m.mouseleave(function(){n=setTimeout(function(){m.find(".menu").hide()},p)}),m.find(".menu").mouseenter(function(){n&&clearTimeout(n)});var u=function(f){var i=j.module;i.id=f;var l=window.location.host,m="https://webmail.optimum.net/wm3-beta";switch(/stage/.test(l)&&(m="/Webmail/SSOBroker?target=https://b1sc-r0ks.webmail.optimum.net/"),f){case"wifiUsage":i.displayStyle="wifi",i.hasWifiUsage=!1,i.service="Optimum Wifi",i.title="WiFi usage",i.mobileTitle="WiFi",i.link={mobileTitle:"Learn more",title:"Learn more",href:"/internet"},s.hasService.internet?(i.loading=!0,d.getSessionUsage().then(function(a){if(a.data&&a.data.usage&&a.data.usage.total){var b=a.data.usage.total;i.hasWifiUsage=!0,i.hasWifiUsage&&(i.hasWifiUsage=!0,i.mb=b.bytesInMB,i.mobileCount=b.bytesInMB+" MB",i.totalDevices=b.devices,i.days=b.days),i.loading=!1}else i.error=!0},function(){i.error=!0})):i.noEntitlement=!0;break;case"onDemand":i.displayStyle="artwork",i.service="Optimum TV",i.title="On Demand",i.mobileTitle="On Demand",i.link={title:"All titles",mobileTitle:"All Titles",href:"/tv/on-demand"},i.loading=!0,i.items=[],g.getNewlyOnDemand(function(a){if(a.assets){for(var b=0,c=3;c>b;b++)a.assets[b]&&i.items.push({title:a.assets[b].title,artwork:a.assets[b].getArtwork(),href:"/tv/on-demand/detail/"+a.assets[b].id+".html"});i.loading=!1}else i.error=!0},function(){i.error=!0});break;case"voiceMail":i.displayStyle="list",i.title="Voicemail",i.service="Optimum Voice",i.linkMoreInfo="/support/phone",i.link={title:"All messages",mobileTitle:"Go to Voicemail",href:b.getValuesBySelector("*").link.basePhoneMenuUrl+"/Voicemail"},s.hasService.phone||(a.showLink=!1),i.loading=!0,i.items=[],e.getStatus().then(function(a){if(i.noEntitlement=!1,a.data){var b=a.data.count;i.mobileCount=b,i.mobileCountMessage=a.data.status,i.mobileIcon="icon-phone",i.loading=!1,i.items=0===b?null:[!0]}},function(a){console.error(a),i.error=!0,i.loading=!1});break;case"webMail":i.displayStyle="list",i.title="Email",i.mobileTitle="Email",i.service="Optimum Email",i.link={title:"Open email inbox",mobileTitle:"Open email inbox",href:m},s.hasService.eMail?(i.items=[],j.$watch("webmail",function(){if(i.loading=!0,k(function(){y()},q),!$.isEmptyObject(j.webmail)){var a=j.webmail;if(a.wasSuccessful&&a.webmail)for(var b=0,c=a.webmail.length;c>b;b++)i.items.push({leftColumn:a.webmail[b].subject,rightColumn:a.webmail[b].date,status:a.webmail[b].status&&_.contains(t,a.webmail[b].status)?a.webmail[b].status:""});i.mobileCount=a.messageCount,i.mobileIcon="icon-envelope-alt",i.webmailDateFormat=a.dateFormat,i.loading=!1}},!0)):(i.noEntitlement=!0,i.link={title:"Learn more",href:"https://webmail.optimum.net/wm3-beta"});break;case"cart":i.displayStyle="artwork",i.title="Cart",i.service="Optimum TV",i.link={title:"All titles",mobileTitle:"Go to Cart",href:"/tv/cart/"},s.hasService.tv?(i.loading=!0,i.items=[],g.MovieCart.getItems(function(a){if(a.assets){for(var c=0;3>c;c++)a.assets[c]&&i.items.push({artwork:b.getValuesBySelector("endpoint.api.vodimage")+a.assets[c].id+"?deviceName=iPad&artName=VOD%20-%20POSTERS",href:"/tv/cart"});i.mobileCount=a.ids.length}else i.mobileCount=0;i.mobileIcon="icon-shopping-cart",i.loading=!1},function(a){console.error(a),i.error=!0},!0,6)):i.noEntitlement=!0;break;case"onTonight":i.displayStyle="list",i.title="TV best bets",i.mobileTitle="TV best bets",i.service="Optimum TV",i.link={title:"All shows",mobileTitle:"Channel Guide",href:"/tv/guide"},i.loading=!0,i.items=[],c.getOnTonight().then(function(a){var b=a.data;_.each(b,function(a,b){if(4>b){var c=moment(a.time,"YYYY-MM-DD HH:mm:ss");i.items.push({leftColumn:a.title,rightColumn:c.format("h:mma")})}}),i.items.length?i.loading=!1:i.error=!0},function(a){i.error=!0,console.error(a)});break;case"dvr":i.displayStyle="list",i.title="DVR",i.service="Optimum TV",i.link={title:"All scheduled recordings",mobileTitle:"All Recordings",href:"/tv/dvr/#/scheduled"},s.hasService.dvr?(i.loading=!0,i.items=[],j.dvrLimit=4,h.queryMultipleDVRs(j.dvrLimit,function(a){a=_.sortBy(a,function(a){return a.Program.StartTime}).reverse(),_.each(a,function(a){i.items.push({leftColumn:a.Title,rightColumn:moment(a.Program.StartTime).format("MM[/]DD")})}),i.loading=!1},function(){i.error=!0,i.loading=!1})):i.noEntitlement=!0}},v=function(){return moment().format("h:mm a")},w=function(){$.each(r,function(a,b){b.id===j.type?b.selected=!0:b.id===o?b.opposite=!0:b.opposite&&delete b.opposite}),j.module.menuItems=r},x=function(){var a=s;i.hasOOLSession&&(a.isPrimary=i.primary,a.hasSession=!0,a.optimumId=i.optimumId,a.corpId=i.corpId||"",a.hasService={internet:i.ool,eMail:1===i.p.email?!0:!1,phone:i.ov,tv:i.io,dvr:i.p?i.p.dvr&&1===i.p.dvr?!0:!1:!1})},y=function(){j.module.loading=!1};j.module.select=function(a){j.$emit("moduleEvent",{eventName:"module-select",oldModule:j.module.id,newModule:a})};var z=function(){w()},A=function(){x(),console.log("setting up module: "+j.type),u(j.type),j.module.timestamp=v(),w(),j.module.initialized=!0}}}}]),function(){var a=[];angular.module("hover",["isViewportSize"]).directive("hoverOn",["$parse","isViewportSize",function(b,c){return function(d,e,f){var g=b(f.hoverOn),h=function(a){d.$apply(function(){g(d,{$event:a})})};e.on("mouseenter",h),c.tablet&&e.swipe({tap:function(){var b=_.find(a,{element:e[0]});angular.isObject(b)&&(b.hovered=!0),h.apply(this,Array.prototype.slice.apply(arguments))}})}}]).directive("hoverOff",["$parse","isViewportSize",function(b,c){return isMobile()&&!c.phone&&$(document.documentElement).swipe({tap:function(b){var c=this;_.each(_.filter(a,{hovered:!0}),function(a){var d=$(b.target),e=$(a.element);d.is(e)||$.contains(a.element,b.target)||(a.hovered=!1,a.callback.call(c,b))})}}),function(d,e,f){var g=b(f.hoverOff),h=function(a){d.$apply(function(){g(d,{$event:a})})};e.on("mouseleave",h),isMobile()&&!c.phone&&(a.push({element:e[0],callback:h,hovered:!1}),d.$on("$destroy",function(){a.splice(_.indexOf(a,_.find(a,{callback:h})),1)}))}}])}(),angular.module("if",[]).directive("if",[function(){return{transclude:"element",priority:1e3,terminal:!0,restrict:"A",compile:function(a,b,c){return function(a,b,d){var e,f;a.$watch(d["if"],function(d){e&&(e.remove(),e=void 0),f&&(f.$destroy(),f=void 0),d&&(f=a.$new(),c(f,function(a){e=a,b.after(a)}))})}}}}]),angular.module("imgAlt",["if","ngSanitize"]).factory("ImageValidator",["$log",function(a){return function(b){return function(c,d,e){d=d||angular.noop,e=e||angular.noop,$.fn.imagesLoaded?$("<img>").attr("src",c).imagesLoaded({done:function(a){b.$apply(function(){d(a)})},fail:function(){b.$apply(e)}}):a.warn("Error detected while trying to use the imagesLoaded plugin. Make sure the correct jQuery object was used")}}}]).directive("imgAlt",["ImageValidator",function(a){return{replace:!0,transclude:!0,template:'<div class="img-alt group">  <div class="img-alt__inner" ng-class="{\'img-alt--fallback\': isFallback}" ng-style="widthAndHeight">    <div if="url" class="img-alt__graphic" ng-style="ieCSSFilters"></div>    <div ng-show="isFallback">      <div ng-transclude></div>    </div>  </div></div>',scope:!0,link:function(b,c,d){function e(){return f&&!b.isFallback||!f}var f=!1,g=!1;b.isFallback=!0,"true"===d.isFallback&&(b.isFallback=!0,f=!0),b.$watch(d.isFallback,function(a){!g&&a&&(b.isFallback=a,f=!_.isUndefined(a))}),d.$observe("url",function(c){b.url=c,"false"!==c&&""!==c?(b.ieCSSFilters={"background-image":"url('"+c+"')"},b.widthAndHeight={},Modernizr.backgroundsize||(b.ieCSSFilters.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+c+"', sizingMethod='scale')",b.ieCSSFilters["-ms-filter"]="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+c+"', sizingMethod='scale')",b.ieCSSFilters["background-image"]="none"),e()&&a(b)(c,function(a){var c,e;if(g=!0,b.isFallback=!1,angular.isUndefined(d.noAutosize)&&angular.isObject(a)&&angular.isObject(a[0])){var f=function(){for(var a=arguments.length,b=0;a>b;b++){var c=arguments[b];if(angular.isNumber(c)&&c>0)return c}return 0};c=f(a[0].naturalWidth,a[0].width,a.width()),e=f(a[0].naturalHeight,a[0].height,a.height()),c&&e||(g=!0,b.isFallback=!0),b.widthAndHeight.width=c+"px",b.widthAndHeight.height=e+"px"}},function(){g=!0,b.isFallback=!0})):(b.ieCSSFilters={},g=!0,b.isFallback=!0)}),d.$observe("label",function(a){b.title=a})}}}]),angular.module("inputLocation",["googleMap"]).directive("inputLocation",["$parse","googleMap",function(a,b){return{scope:!0,link:function(c,d,e){d.on("click",function(){b.loadScript()});var f={};c.locationSearch=f,b.getPromise().then(function(b){var g,h={types:["(regions)"],componentRestrictions:{country:"us"}},i=a(e.locationChange);f.autocomplete=new b.maps.places.Autocomplete(d[0],h),f.refresh=function(){g.geocode({address:d.val()},function(a,c){c===b.maps.GeocoderStatus.OK&&f.doCallback({lat:a[0].geometry.location.lat(),lng:a[0].geometry.location.lng()})})},f.doCallback=function(a){c.$apply(function(){i(c,{$event:a})})},e.instance&&a(e.instance).assign(c.$parent,f),d.bind("focusin",function(){$(document).keypress(function(a){13===a.which&&f.refresh()})}),g=new b.maps.Geocoder,b.maps.event.addListener(f.autocomplete,"place_changed",function(){var a=f.autocomplete.getPlace();a.geometry&&f.doCallback({lat:a.geometry.location.lat(),lng:a.geometry.location.lng()})})})}}}]),angular.module("inputRadio",[]).directive("inputRadio",["inputBoolModelFactory",function(a){return{require:"ngModel",link:function(b,c,d,e){function f(){g(d.value===e.$modelValue)}function g(a){i.isTrue=Boolean(a),h(i.isTrue)}function h(a){c.toggleClass("is-true is-frozen",a).toggleClass("is-false",!a)}var i=a();c.addClass("input-radio"),e.$render=f,c.on("click",function(){i.isTrue===!1&&(g(!0),e.$setViewValue(d.value),b.$apply())})}}}]).factory("inputBoolModelFactory",[function(){return function(){return{isDisabled:!1,isTrue:!1}}}]),angular.module("installationcalendarslot",[]).directive("installationcalendarslot",["ServiceAppointment",function(a){var b=a,c=b.getAvailableTimeSlots();return{restrict:"E",templateUrl:"/parts/installation-calendar-slot/installation-calendar-slot-template.html",link:function(a){function b(){console.log("somya"+$(this).attr("timeSlot"))}function d(a,b){var c;return 4===a||6===a||9===a||11===a?c=30:(c=31,2===a&&(c=0!==b/4-parseInt(b/4,0)?28:0!==b/100-parseInt(b/100,0)?29:0!==b/400-parseInt(b/400,0)?28:29)),c}function e(a){var b="";if(6>a||a>0)switch(a){case 0:b="Sun";break;case 1:b="Mon";break;case 2:b="Tue";break;case 3:b="Wed";break;case 4:b="Thur";break;case 5:b="Fri";break;case 6:b="Sat"}return b}function f(a){var b="";if(a>0||13>a)switch(a){case 1:b="January";break;case 2:b="February";break;case 3:b="March";break;case 4:b="April";break;case 5:b="May";break;case 6:b="June";break;case 7:b="July";break;case 8:b="August";break;case 9:b="September";break;case 10:b="October";break;case 11:b="November";break;case 12:b="December"}return b}a.month="";var g=new Date,h=g.getDate(),i=g.getMonth()+1;a.month=f(i);for(var j=g.getFullYear(),k=g.getDay(),l=0,m=$(document.createElement("tr"));7>l;){var n=$(document.createElement("th"));$(n).text(e(k)),k++,l++,7===k&&(k=0),$(m).append($(n))}$("#calendarTable").append($(m));for(var o=d(i,j),p=1,q=$(document.createElement("tr")),r=1;42>p;){8===r&&($("#calendarTable").append($(q)),q=$(document.createElement("tr")),r=1),h-1===o&&(h=1,a.month+=12!==i?"/"+f(i+1):"/"+f(1));for(var s=$(document.createElement("td")),t="",u=0;u<c.length;u++){var v=c[u].TIMEDISPLAY.split(",")[0],w=new Date(v);i===w.getMonth()+1&&h===w.getDate()&&(t+=c[u].TIMEDISPLAY.split(",")[1]+" ")}""!==t?($(s).attr("timeSlot",t),$(s).addClass("slotAvaliable"),$(s).on("click",b())):$(s).addClass("slotNotAvaliable"),$(s).text(h),$(q).append($(s)),r++,h++,p++}}}}]),angular.module("isDeviceWidth",[]).run(["$rootScope","isDeviceWidth",function(a,b){a.isDeviceWidth=b,window.isDeviceWidth=b}]).service("isDeviceWidth",["$rootScope",function(a){function b(a){_.each(c,function(b,d){c[d]=d===a})}var c={phone:!1,tablet:!1,desktop:!1,largeDesktop:!1},d={phone:"(max-device-width: 767px)",tablet:"(min-device-width: 768px) and (max-device-width: 979px)",desktop:"(min-device-width: 980px) and (max-device-width: 1199px)",largeDesktop:"(min-device-width: 1200px)"};return _.each(d,function(c,d){enquire.register(c,function(){a.$apply(function(){b(d)})})}),enquire.listen(100),c}]),angular.module("isViewportSize",[]).run(["$rootScope","isViewportSize",function(a,b){a.isViewportSize=b,window.isViewportSize=b}]).service("isViewportSize",["$rootScope",function(a){function b(a){_.each(c,function(b,d){c[d]=d===a})}var c={phone:!1,tablet:!1,desktop:!1,largeDesktop:!1},d={phone:"(max-width: 767px)",tablet:"(min-width: 768px) and (max-width: 979px)",desktop:"(min-width: 980px) and (max-width: 1199px)",largeDesktop:"(min-width: 1200px)"};return _.each(d,function(c,d){enquire.register(c,function(){a.$apply(function(){b(d)})})}),enquire.listen(100),c}]);var options={showArrows:!1,maintainPosition:!0,stickToBottom:!1,stickToRight:!1,clickOnTrack:!0,autoReinitialise:!1,autoReinitialiseDelay:500,verticalDragMinHeight:0,verticalDragMaxHeight:99999,horizontalDragMinWidth:0,horizontalDragMaxWidth:99999,contentWidth:void 0,animateScroll:!1,animateDuration:300,animateEase:"linear",hijackInternalLinks:!1,verticalGutter:4,horizontalGutter:4,mouseWheelSpeed:3,arrowButtonSpeed:0,arrowRepeatFreq:50,arrowScrollOnHover:!1,trackClickSpeed:0,trackClickRepeatFreq:70,verticalArrowPositions:"split",horizontalArrowPositions:"split",enableKeyboardNavigation:!0,hideFocus:!1,keyboardSpeed:0,initialDelay:300,speed:30,scrollPagePercent:.8};angular.module("scrollPane",[]).directive("scrollPaneVertical",[function(){return{restrict:"A",link:function(a,b){var c=$(b);new JScrollPaneVertical(c,options)}}}]),angular.module("jssi",["if"]).directive("jssi",["$log",function(){return{replace:!0,template:'<div ng-include="jssi.url"></div>',scope:!0,link:function(a,b,c){a.jssi={},c.$observe("jssi",function(b){if(angular.isString(b)&&""!==b&&"false"!==b)a.jssi.url=CacheKeyURL(b);else try{delete a.jssi.url}catch(c){}})}}}]).factory("CacheKeyURL",[function(){function a(a){var c;return _.each(b,function(b){b=b.replace(/^\s+/,"").replace(/\s+$/,"");var d=b.indexOf("="),e=b.substr(0,d),f=b.substr(d+1,b.length);return a===e&&f.match(/\S/)?(c=f,!1):void 0}),c}var b=document.cookie.split(";"),c=a("cachekeys"),d="",e="",f="";return angular.isString(c)&&_.each(c.replace(/^"/,"").replace(/"$/,"").split("|"),function(a){var b=a.split("="),c=b.shift(),g=b.join("=");c=c.replace(/^\s+/,"").replace(/\s+$/,""),g=g.replace(/^\s+/,"").replace(/\s+$/,""),"ZIP"===c?d=g:"CORP"===c?e=g:"REGION"===c&&(f=g)}),function(a){return angular.isString(a)?a.replace(/@Zipcode@/g,d).replace(/@Corp@/g,e).replace(/@Region@/g,f):a}}]),angular.module("keyEvents",[]).directive("onKeyup",["$parse",function(a){return function(b,c,d){var e=a(d.onKeyup);c.bind("keyup",function(a){b.$apply(function(){e(b,{$event:a})})})}}]).directive("onKeydown",["$parse",function(a){return function(b,c,d){var e=a(d.onKeydown);c.bind("keydown",function(a){b.$apply(function(){e(b,{$event:a})})})}}]).directive("onKeypress",["$parse",function(a){return function(b,c,d){var e=a(d.onKeypress);c.bind("keypress",function(a){b.$apply(function(){e(b,{$event:a})})})}}]),angular.module("l",[]).run(["$rootScope","l",function(a,b){a.l=b}]).filter("s",function(){return function(){var a;try{a=_.vsprintf(_.first(arguments),_.rest(arguments))}finally{return a}}}).value("l",{map:{hotspots:{intro:"Get internet throughout your neighborhood at these hotspots."},stores:{intro:"Find an Optimum Store near you"}},dvr:{episodesTable:{duration:"Length",time:"Date & time",series:"Series",episode:"Episode"},empty:{scheduled:{title:"You don't have any scheduled recordings",body:""},recorded:{title:"Your DVR is empty",body:""}},remove:{modeButtonLabel:{recorded:"Delete Recordings",scheduled:"Cancel Recordings"},single:{scheduled:{single:{buttonLabel:"Cancel 1 recording",mobileButtonLabel:"Cancel 1 recording",confirm:{title:"Cancel <strong>%(recordingName)s</strong>?",continueButtonLabel:"Yes, Cancel 1 recording",endButtonLabel:"No Thanks"},pending:{title:"Canceling <strong>%(recordingName)s</strong>..."},success:{title:"<strong>%(recordingName)s</strong> has been Canceled",endButtonLabel:"Close"},failure:{title:"Sorry, <strong>there was an error.</strong>",message:"We are not able to cancel at this moment. Please try again later",endButtonLabel:"Close"}}},recorded:{single:{buttonLabel:"Delete 1 recording",mobileButtonLabel:"Delete 1 recording",confirm:{title:"Delete <strong>%(recordingName)s</strong>?",continueButtonLabel:"Yes, Delete 1 recording",endButtonLabel:"No Thanks"},pending:{title:"Deleting <strong>%(recordingName)s</strong>..."},success:{title:"<strong>%(recordingName)s</strong> has been deleted.",endButtonLabel:"Close"},failure:{title:"Sorry, <strong>there was an error.</strong>",message:"We are not able to delete at this moment. Please try again later",endButtonLabel:"Close"}}}},series:{recorded:{single:{buttonLabel:"Delete %(removeCount)s recording",mobileButtonLabel:"Delete %(removeCount)s recording",confirm:{title:"Delete <strong>%(removeCount)s recording</strong>?",continueButtonLabel:"Yes, Delete <strong>%(removeCount)s recording</strong>",endButtonLabel:"No Thanks"},pending:{title:"Deleting <strong>%(removeCount)s recording</strong>..."},success:{title:"<strong>%(removeCount)s episode of %(recordingName)s</strong> has been deleted.",endButtonLabel:"Close"},failure:{title:"Sorry, <strong>there was an error.</strong>",message:"We are not able to delete at this moment. Please try again later",endButtonLabel:"Close"}},plural:{buttonLabel:"Delete %(removeCount)s recordings",mobileButtonLabel:"Delete %(removeCount)s recordings",confirm:{title:"Delete <strong>%(removeCount)s recordings</strong>?",continueButtonLabel:"Yes, Delete <strong>%(removeCount)s recordings</strong>",endButtonLabel:"No Thanks"},pending:{title:"Deleting <strong>%(removeCount)s recordings</strong>..."},success:{title:"<strong>%(removeCount)s episodes of %(recordingName)s</strong> have been deleted.",endButtonLabel:"Close"},failure:{title:"Sorry, <strong>there was an error.</strong>",message:"We are not able to delete at this moment. Please try again later",endButtonLabel:"Close"}}},scheduled:{single:{buttonLabel:"Cancel %(seriesRemoveCount)s recording",mobileButtonLabel:"Cancel %(seriesRemoveCountSelected)s recording",confirm:{title:"Cancel all <strong>%(seriesRemoveCountSelected)s recording</strong> of %(recordingName)s?",continueButtonLabel:"Yes, Cancel <strong>%(seriesRemoveCountSelected)s recording</strong>",endButtonLabel:"No Thanks"},pending:{title:"Canceling <strong>%(seriesRemoveCountSelected)s recording</strong> of %(recordingName)s..."},success:{title:"<strong>%(recordingName)s</strong> has been canceled",endButtonLabel:"Close"},failure:{title:"Sorry, <strong>there was an error.</strong>.",message:"We are not able to cancel at this moment. Please try again later",endButtonLabel:"Close"}},plural:{buttonLabel:"Cancel %(seriesRemoveCount)s recordings",mobileButtonLabel:"Cancel %(seriesRemoveCountSelected)s recordings",confirm:{title:"Cancel <strong>%(seriesRemoveCountSelected)s recordings</strong>?",continueButtonLabel:"Yes, Cancel <strong>%(seriesRemoveCountSelected)s recordings</strong>",endButtonLabel:"No Thanks"},pending:{title:"Canceling <strong>%(seriesRemoveCountSelected)s recordings</strong>..."},success:{title:"<strong>%(recordingName)s</strong> has been canceled",endButtonLabel:"Close"},failure:{title:"Sorry, <strong>there was an error.</strong>",message:"We are not able to cancel at this moment. Please try again later",endButtonLabel:"Close"}}}},multiple:{scheduled:{plural:{buttonLabel:"Cancel %(seriesRemoveCount)s recordings",mobileButtonLabel:"Cancel %(seriesRemoveCountSelected)s recordings",confirm:{title:"Cancel <strong>%(seriesRemoveCountSelected)s recordings</strong>?",continueButtonLabel:"Yes, Cancel %(seriesRemoveCountSelected)s recording",endButtonLabel:"No Thanks"},pending:{title:"Canceling <strong>%(seriesRemoveCountSelected)s recordings</strong>..."},success:{title:"<strong>%(seriesRemoveCountSelected)s recordings</strong> have been Canceled",endButtonLabel:"Close"},failure:{title:"Sorry, <strong>there was an error.</strong>",message:"We are not able to cancel at this moment. Please try again later",endButtonLabel:"Close"}}},recorded:{plural:{buttonLabel:"Delete %(removeCount)s recording",mobileButtonLabel:"Delete %(removeCount)s recording",confirm:{title:"Delete <strong>%(removeCount)s recordings</strong>?",continueButtonLabel:"Yes, Delete <strong>%(removeCount)s recording</strong>",endButtonLabel:"No Thanks"},pending:{title:"Deleting <strong>%(removeCount)s recording</strong>..."},success:{title:"<strong>%(removeCount)s recordings</strong> have been deleted.",endButtonLabel:"Close"},failure:{title:"Sorry, <strong>there was an error.</strong>",message:"We are not able to delete at this moment. Please try again later",endButtonLabel:"Close"}}}}}},cableBoxes:{copy:{quickSettings:"Quick Settings",parentalControls:"Parental Controls",purchasePIN:"Purchase Pin",favorites:"Favorite Channels",guide:"Guide Preferences",otherSettings:"Other Settings"},language:{description:"When the channel offers alternative audio, such as as second audio language, with the TV picture. Where SAP is available, the “voice over” will be in English."},soundAndPicture:{validation:{aspectRatio:"To choose “4:3”, you must change Display resolution to “480p” or “480i”.",displayResolution:"To choose “%(displayResolution)s”, you must change Aspect ratio to “16:9”.",volumeControl:"You cannot choose “Fixed”, because Closed Captioning is set to “On with Mute”."}},timeBlock:{lead:"Time blocks allow you to block programs in a particular time range, for a single day, a range of days, or a day of the week such as every Saturday. You can set up time blocks up to 14 days in advance.",leadStrong:"You must enter a Parental Control PIN using your remote in order to watch blocked times.",heading:"Block TV viewing on this cable box"},timers:{invalid:"Turn on time must be before turn off time."},content:{D:{title:"Suggestive dialogue, drugs",description:"Suggestive dialogue usually sexual in nature, or drug use."},FV:{title:"Fantasy violence",description:"Includes more fantasy and violence than most TV-Y7 programs."},"L/SL":{title:"Strong, coarse language",description:"Strong, coarse, or graphic language"},N:{title:"Nudity",description:"Nudity implied or explicit sexual situations"},S:{title:"Sexual situations",description:"Implied or explicit sexual situations"},BN:{title:"Brief nudity",description:"Some exposure, generally not sexually oriented"},V:{title:"Violence",description:"Graphic or intense violence"},AT:{title:"Adult themes",description:"Portrays violence, sexual situations or drug use"}},verify:{purchase:{title:"Verify Purchase PIN",name:"Purchase PIN",lead:{copy:"To copy your purchase PIN, please verify your PIN for %(copyFrom)s.",edit:"To edit your purchase PIN, please verify your PIN for %(copyFrom)s."}},parentalControl:{title:"Verify Parental Control PIN",name:"Parental Control PIN",lead:{copy:"To copy parental controls, please verify your PIN for %(copyFrom)s.",edit:""}}}},cart:{errorLoadingItems:"Sorry, there was a problem loading your cart items.",errorRemovingItem:"Sorry, there was a problem removing your cart item.",errorInitiallyAddingItem:"Sorry, there was a problem adding the item to your cart.",errorRemovingItems:"Sorry, there was a problem removing items from your cart.",buttonTryAgainSimple:"Try again",buttonTryAgain:"Try again to remove remaining items",errorAddingItem:"Sorry, there was a problem adding an item back to your cart.",warningSelectedTooMany:"You have selected more than ten items to delete. You can only delete ten items at one time. Please change your selection."},internet:{security:{download:"Download Security Suite",remember:"Please rememeber next time you are on your desktop",responseMessages:{accountOne:{start:"Your Optimum Online account is currently not eligible for this promotion. Please contact us",end:"to update your account status."},accountTwo:"Your Optimum Online Account has exceeded the maximum number of licenses available",general:"An error occurred while processing your request. Please return to the Security Package page to resubmit your request",success:"Thank you for requesting your FREE Internet Security package. <br><br> As soon as your request has been processed, you will receive a Welcome e-mail from our partner CA. This e-mail will be sent to your Optimum Online & regular e-mail address and will include instructions for downloading and installing your security package."}}},session:{expired:"Your session has expired. Login required."},network:{noPrograms:"No programs found",unableToLoad:"Unable to load program data"},dates:{today:"Today",tomorrow:"Tomorrow"}}),angular.module("lightBox",["modal","panel"]).directive("lightBox",[function(){return{templateUrl:"/parts/light-box/light-box-template.html",restrict:"AE",scope:!0,link:function(a,b,c){var d="light-box-"+c.contentid;
$("#"+d).length?(a.title=$("#"+d).children(".title-"+c.contentid).html(),a.bodycontent=$("#"+d).children(".content-"+c.contentid).html(),a.linktitle=$("#"+d).children(".linktext-"+c.contentid).html(),a.type=angular.lowercase($("#"+d).children(".type-"+c.contentid).text())):(a.bodycontent="",a.linktitle="",a.type="",c.title=""),a.openLightbox=function(a){$(a.target).next().find(".disclaimer .disclaimer-window").show(),$(a.target).next().find(".disclaimer").addClass("show").delay(5).queue(function(){$("body").addClass("stop-scroll"),$(this).removeClass("invisible").addClass("visible"),$(this).dequeue()})},a.closeLightbox=function(a){$(a.target).parents(".disclaimer").removeClass("visible").addClass("invisible").delay(605).queue(function(){$(this).find(".disclaimer-window").attr("style",null),$("body").removeClass("stop-scroll"),$(this).removeClass("show"),$(this).dequeue()})},a.openmodel=function(){a.showModal=!0},a.closeModal=function(){a.showModal=!1}}}}]),angular.module("linksDvrCart",["movieCart","oolCookie","if","webdvrResource"]).controller("linksDvrCart",["$scope","movieCart","ooluser","WebDVR",function(a,b,c,d){function e(a){var b=!1;d.query(function(){b=!0}),a.hasDvr=function(){return b}}a.ooluser=c,b.getItems(function(b){a.movieCart=b.ids}),e(a.ooluser)}]),angular.module("macAddressInput",["keyEvents"]).directive("macAddressInput",["macAddressSeps",function(a){return{replace:!1,require:"ngModel",scope:!0,template:'<span ng-switch="isMobile">  <span ng-switch-when="true">    <input type="text"      ng-model="mobileDigits.value"      ng-change="mobileChange(mobileDigits.value)"      mac-address-seps      maxlength="17"    />  </span>  <span ng-switch-when="false">    <input type="text"      ng-model="digit.value"      ng-repeat="digit in digits"      class="small input pin-input"      on-keydown="keyDown($event, $index)"      ng-change="change($index, digit.value)"      placeholder="00"      maxlength="2"    />  </span></span>',link:function(b,c,d,e){function f(a){angular.isUndefined(h)&&(h=c.find("input")),$(h[a]).focus()}function g(a){return angular.isUndefined(a)||""===a||null===a||a!==a}var h;b.digits=[{},{},{},{},{},{}],b.mobileDigits={},b.isMobile=isMobile(),e.$render=function(){var c,d=e.$viewValue;angular.isString(d)?(d=d.replace(/[^\dA-Fa-f]/g,""),c=angular.extend(["","","","","",""],d.split("")),_.each(b.digits,function(a){a.value=c.shift()}),b.mobileDigits.value=a(d)):(_.each(b.digits,function(a){a.value=""}),b.mobileDigits.value="")},b.keyDown=function(a,c){8===a.keyCode&&c>0&&""===b.digits[c].value&&(b.digits[c-1].value=b.digits[c-1].value.replace(/[\dA-Fa-f]$/,""),f(c-1),a.preventDefault())},b.change=function(c,d){b.mobileDigits.value=_.reduce(b.digits,function(a,b){return b.value=b.value.replace(/[^\dA-Fa-f]/g,""),a+b.value},""),e.$setViewValue(b.mobileDigits.value),b.mobileDigits.value=a(b.mobileDigits.value),c<b.digits.length-1&&d.match(/[\dA-Fa-f]{2}/)&&f(c+1)},b.mobileChange=function(a){angular.isString(a)&&""!==a?(a=a.replace(/[^\dA-Fa-f]/g,""),digits=angular.extend(["","","","","",""],a.split("")),_.each(b.digits,function(a){a.value=digits.shift()})):_.each(b.digits,function(a){a.value=""}),e.$setViewValue(a)};var i,j=d.ngPattern,k=function(a,b){return g(b)||a.test(b)?(e.$setValidity("pattern",!0),b):(e.$setValidity("pattern",!1),void 0)};j&&(j.match(/^\/(.*)\/$/)?(j=new RegExp(j.substr(1,j.length-2)),i=function(a){return k(j,a)}):i=function(a){var c=b.$eval(j);if(!c||!c.test)throw new Error("Expected "+j+" to be a RegExp but was "+c);return k(c,a)},e.$formatters.push(i),e.$parsers.push(i))}}}]).factory("macAddressSeps",[function(){return function(a){return a.replace(/[^\dA-Fa-f]/g,"").replace(/([\dA-Fa-f]{2})/g,"$1:").replace(/^([\d:A-Fa-f]{17})[\d:A-Fa-f]+$/,"$1")}}]).directive("macAddressSeps",["macAddressSeps",function(a){return function(b,c){c.live("blur",function(){this.value=a(this.value)}).live("keydown",function(a){switch(a.keyCode){case 65:case 66:case 67:case 68:case 69:case 70:break;case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 37:case 39:case 46:case 13:case 10:a.shiftKey&&(a.preventDefault(),a.stopPropagation());break;case 8:c.val().match(/:$/)&&c.val(c.val().replace(/:$/,""));break;case 67:case 86:case 88:var b=a.ctrlKey||a.metaKey;return b?void 0:(a.preventDefault(),a.stopPropagation(),!1);default:return a.preventDefault(),a.stopPropagation(),!1}}).live("keyup",function(){var b,c,d;b=a($(this).val()),c=this.selectionStart,d=!0,c>=this.value.length&&(d=!1),this.value!==b&&(this.value=b,d&&(this.selectionStart=c,this.selectionEnd=c))})}}]),angular.module("googleMapsAsync",[]).factory("googleMapsAsync",["$rootScope","$q",function(a,b){function c(){if(!g){var a=document.createElement("script");a.type="text/javascript",a.src="https://maps.googleapis.com/maps/api/js?libraries=places&client="+e+"&sensor=true&callback=initializeGoogleMap",document.body.appendChild(a),g=!0}}function d(){return f.promise}var e="gme-cscholdingsllc",f=b.defer(),g=!1;return window.initializeGoogleMap=function(){a.$apply(function(){f.resolve()})},{load:c,getPromise:d}}]),angular.module("googleMapsInfoBox",["googleMapsAsync"]).factory("InfoBox",["googleMapsAsync",function(a){return a.getPromise().then(function(){function a(a){a=a||{},google.maps.OverlayView.apply(this,arguments),this.content_=a.content||"",this.disableAutoPan_=a.disableAutoPan||!1,this.maxWidth_=a.maxWidth||0,this.pixelOffset_=a.pixelOffset||new google.maps.Size(0,0),this.position_=a.position||new google.maps.LatLng(0,0),this.zIndex_=3,this.boxClass_=a.boxClass||"infoBox",this.boxStyle_=a.boxStyle||{},this.closeBoxMargin_=a.closeBoxMargin||"4px",this.closeBoxURL_=a.closeBoxURL,this.infoBoxClearance_=a.infoBoxClearance||new google.maps.Size(1,1),this.isHidden_=a.isHidden||!1,this.alignBottom_=a.alignBottom||!1,this.pane_=a.pane||"floatPane",this.enableEventPropagation_=a.enableEventPropagation||!1,this.div_=null,this.closeListener_=null,this.eventListener1_=null,this.eventListener2_=null,this.eventListener3_=null,this.moveListener_=null,this.contextListener_=null,this.fixedWidthSet_=null}return a.prototype=new google.maps.OverlayView,a.prototype.createInfoBoxDiv_=function(){var a,b=this,c=function(a){a.cancelBubble=!0,a.stopPropagation&&a.stopPropagation()},d=function(a){a.returnValue=!1,a.preventDefault&&a.preventDefault(),b.enableEventPropagation_||c(a)};this.div_||(this.div_=document.createElement("div"),this.setBoxStyle_(),"undefined"==typeof this.content_.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+this.content_:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(this.content_)),this.getPanes()[this.pane_].appendChild(this.div_),this.addClickHandler_(),this.div_.style.width?this.fixedWidthSet_=!0:0!==this.maxWidth_&&this.div_.offsetWidth>this.maxWidth_?(this.div_.style.width=this.maxWidth_,this.div_.style.overflow="auto",this.fixedWidthSet_=!0):(a=this.getBoxWidths_(),this.div_.style.width=this.div_.offsetWidth-a.left-a.right+"px",this.fixedWidthSet_=!1),this.panBox_(this.disableAutoPan_),this.enableEventPropagation_||(this.eventListener1_=google.maps.event.addDomListener(this.div_,"mousedown",c),this.eventListener2_=google.maps.event.addDomListener(this.div_,"click",c),this.eventListener3_=google.maps.event.addDomListener(this.div_,"dblclick",c),this.eventListener4_=google.maps.event.addDomListener(this.div_,"mouseover",function(){this.style.cursor="default"})),this.contextListener_=google.maps.event.addDomListener(this.div_,"contextmenu",d),google.maps.event.trigger(this,"domready"))},a.prototype.getCloseBoxImg_=function(){var a="";return""!==this.closeBoxURL_&&(a="<img",a+=" src='"+this.closeBoxURL_+"'",a+=" align=right",a+=" style='",a+=" position: relative;",a+=" cursor: pointer;",a+=" margin: "+this.closeBoxMargin_+";",a+="'>"),a},a.prototype.addClickHandler_=function(){var a;""!==this.closeBoxURL_?(a=this.div_.firstChild,this.closeListener_=google.maps.event.addDomListener(a,"click",this.getCloseClickHandler_())):this.closeListener_=null},a.prototype.getCloseClickHandler_=function(){var a=this;return function(b){b.cancelBubble=!0,b.stopPropagation&&b.stopPropagation(),a.close(),google.maps.event.trigger(a,"closeclick")}},a.prototype.panBox_=function(a){var b,c,d=0,e=0;if(!a&&(b=this.getMap(),b instanceof google.maps.Map)){b.getBounds().contains(this.position_)||b.setCenter(this.position_),c=b.getBounds();var f=b.getDiv(),g=f.offsetWidth,h=f.offsetHeight,i=this.pixelOffset_.width,j=this.pixelOffset_.height,k=this.div_.offsetWidth,l=this.div_.offsetHeight,m=this.infoBoxClearance_.width,n=this.infoBoxClearance_.height,o=this.getProjection().fromLatLngToContainerPixel(this.position_);o.x<-i+m?d=o.x+i-m:o.x+k+i+m>g&&(d=o.x+k+i+m-g),this.alignBottom_?o.y<-j+n+l?e=o.y+j-n-l:o.y+j+n>h&&(e=o.y+j+n-h):o.y<-j+n?e=o.y+j-n:o.y+l+j+n>h&&(e=o.y+l+j+n-h),(0!==d||0!==e)&&(b.getCenter(),b.panBy(d,e))}},a.prototype.setBoxStyle_=function(){var a,b;if(this.div_){this.div_.className=this.boxClass_,this.div_.style.cssText="",b=this.boxStyle_;for(a in b)b.hasOwnProperty(a)&&(this.div_.style[a]=b[a]);"undefined"!=typeof this.div_.style.opacity&&""!==this.div_.style.opacity&&(this.div_.style.filter="alpha(opacity="+100*this.div_.style.opacity+")"),this.div_.style.position="absolute",this.div_.style.visibility="hidden",null!==this.zIndex_&&(this.div_.style.zIndex=this.zIndex_)}},a.prototype.getBoxWidths_=function(){var a,b={top:0,bottom:0,left:0,right:0},c=this.div_;return document.defaultView&&document.defaultView.getComputedStyle?(a=c.ownerDocument.defaultView.getComputedStyle(c,""),a&&(b.top=parseInt(a.borderTopWidth,10)||0,b.bottom=parseInt(a.borderBottomWidth,10)||0,b.left=parseInt(a.borderLeftWidth,10)||0,b.right=parseInt(a.borderRightWidth,10)||0)):document.documentElement.currentStyle&&c.currentStyle&&(b.top=parseInt(c.currentStyle.borderTopWidth,10)||0,b.bottom=parseInt(c.currentStyle.borderBottomWidth,10)||0,b.left=parseInt(c.currentStyle.borderLeftWidth,10)||0,b.right=parseInt(c.currentStyle.borderRightWidth,10)||0),b},a.prototype.onRemove=function(){this.div_&&(this.div_.parentNode.removeChild(this.div_),this.div_=null)},a.prototype.draw=function(){this.createInfoBoxDiv_();var a=this.getProjection().fromLatLngToDivPixel(this.position_);this.div_.style.left=a.x+this.pixelOffset_.width+"px",this.alignBottom_?this.div_.style.bottom=-(a.y+this.pixelOffset_.height)+"px":this.div_.style.top=a.y+this.pixelOffset_.height+"px",this.div_.style.visibility=this.isHidden_?"hidden":"visible"},a.prototype.setOptions=function(a){"undefined"!=typeof a.boxClass&&(this.boxClass_=a.boxClass,this.setBoxStyle_()),"undefined"!=typeof a.boxStyle&&(this.boxStyle_=a.boxStyle,this.setBoxStyle_()),"undefined"!=typeof a.content&&this.setContent(a.content),"undefined"!=typeof a.disableAutoPan&&(this.disableAutoPan_=!0),"undefined"!=typeof a.maxWidth&&(this.maxWidth_=a.maxWidth),"undefined"!=typeof a.pixelOffset&&(this.pixelOffset_=a.pixelOffset),"undefined"!=typeof a.alignBottom&&(this.alignBottom_=a.alignBottom),"undefined"!=typeof a.position&&this.setPosition(a.position),"undefined"!=typeof a.zIndex&&this.setZIndex(a.zIndex),"undefined"!=typeof a.closeBoxMargin&&(this.closeBoxMargin_=a.closeBoxMargin),"undefined"!=typeof a.closeBoxURL&&(this.closeBoxURL_=a.closeBoxURL),"undefined"!=typeof a.infoBoxClearance&&(this.infoBoxClearance_=a.infoBoxClearance),"undefined"!=typeof a.isHidden&&(this.isHidden_=a.isHidden),"undefined"!=typeof a.enableEventPropagation&&(this.enableEventPropagation_=a.enableEventPropagation),this.div_&&this.draw()},a.prototype.setContent=function(a){this.content_=a,this.div_&&(this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.fixedWidthSet_||(this.div_.style.width=""),"undefined"==typeof a.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+a:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(a)),this.fixedWidthSet_||(this.div_.style.width=this.div_.offsetWidth+"px","undefined"==typeof a.nodeType?this.div_.innerHTML=this.getCloseBoxImg_()+a:(this.div_.innerHTML=this.getCloseBoxImg_(),this.div_.appendChild(a))),this.addClickHandler_()),google.maps.event.trigger(this,"content_changed")},a.prototype.setPosition=function(a){this.position_=a,this.div_&&this.draw(),google.maps.event.trigger(this,"position_changed")},a.prototype.setZIndex=function(a){this.zIndex_=a,this.div_&&(this.div_.style.zIndex=a),google.maps.event.trigger(this,"zindex_changed")},a.prototype.getContent=function(){return this.content_},a.prototype.getPosition=function(){return this.position_},a.prototype.getZIndex=function(){return this.zIndex_},a.prototype.show=function(){this.isHidden_=!1,this.div_&&(this.div_.style.visibility="visible")},a.prototype.hide=function(){this.isHidden_=!0,this.div_&&(this.div_.style.visibility="hidden")},a.prototype.open=function(a,b){var c=this;b&&(this.position_=b.getPosition(),this.moveListener_=google.maps.event.addListener(b,"position_changed",function(){c.setPosition(this.getPosition())})),this.setMap(a),this.div_&&this.panBox_()},a.prototype.close=function(){this.closeListener_&&(google.maps.event.removeListener(this.closeListener_),this.closeListener_=null),this.eventListener1_&&(google.maps.event.removeListener(this.eventListener1_),google.maps.event.removeListener(this.eventListener2_),google.maps.event.removeListener(this.eventListener3_),google.maps.event.removeListener(this.eventListener4_),this.eventListener1_=null,this.eventListener2_=null,this.eventListener3_=null,this.eventListener4_=null),this.moveListener_&&(google.maps.event.removeListener(this.moveListener_),this.moveListener_=null),this.contextListener_&&(google.maps.event.removeListener(this.contextListener_),this.contextListener_=null),this.setMap(null)},a})}]),angular.module("googleMapsRichMarker",["googleMapsAsync"]).factory("RichMarker",["googleMapsAsync",function(a){return a.getPromise().then(function(){function a(a){var c=a||{};this.ready_=!1,this.dragging_=!1,void 0===a.visible&&(a.visible=!0),void 0===a.shadow&&(a.shadow="7px -3px 5px rgba(88,88,88,0.7)"),void 0===a.anchor&&(a.anchor=b.BOTTOM),this.setValues(c)}a.prototype=new google.maps.OverlayView,window.RichMarker=a,a.prototype.getVisible=function(){return this.get("visible")},a.prototype.getVisible=a.prototype.getVisible,a.prototype.setVisible=function(a){this.set("visible",a)},a.prototype.setVisible=a.prototype.setVisible,a.prototype.visible_changed=function(){this.ready_&&(this.markerWrapper_.style.display=this.getVisible()?"":"none",this.draw())},a.prototype.visible_changed=a.prototype.visible_changed,a.prototype.setFlat=function(a){this.set("flat",!!a)},a.prototype.setFlat=a.prototype.setFlat,a.prototype.getFlat=function(){return this.get("flat")},a.prototype.getFlat=a.prototype.getFlat,a.prototype.getWidth=function(){return this.get("width")},a.prototype.getWidth=a.prototype.getWidth,a.prototype.getHeight=function(){return this.get("height")},a.prototype.getHeight=a.prototype.getHeight,a.prototype.setShadow=function(a){this.set("shadow",a),this.flat_changed()},a.prototype.setShadow=a.prototype.setShadow,a.prototype.getShadow=function(){return this.get("shadow")},a.prototype.getShadow=a.prototype.getShadow,a.prototype.flat_changed=function(){this.ready_&&(this.markerWrapper_.style.boxShadow=this.markerWrapper_.style.webkitBoxShadow=this.markerWrapper_.style.MozBoxShadow=this.getFlat()?"":this.getShadow())},a.prototype.flat_changed=a.prototype.flat_changed,a.prototype.setZIndex=function(a){this.set("zIndex",a)},a.prototype.setZIndex=a.prototype.setZIndex,a.prototype.getZIndex=function(){return this.get("zIndex")},a.prototype.getZIndex=a.prototype.getZIndex,a.prototype.zIndex_changed=function(){this.getZIndex()&&this.ready_&&(this.markerWrapper_.style.zIndex=this.getZIndex())},a.prototype.zIndex_changed=a.prototype.zIndex_changed,a.prototype.getDraggable=function(){return this.get("draggable")},a.prototype.getDraggable=a.prototype.getDraggable,a.prototype.setDraggable=function(a){this.set("draggable",!!a)},a.prototype.setDraggable=a.prototype.setDraggable,a.prototype.draggable_changed=function(){this.ready_&&(this.getDraggable()?this.addDragging_(this.markerWrapper_):this.removeDragListeners_())},a.prototype.draggable_changed=a.prototype.draggable_changed,a.prototype.getPosition=function(){return this.get("position")},a.prototype.getPosition=a.prototype.getPosition,a.prototype.setPosition=function(a){this.set("position",a)},a.prototype.setPosition=a.prototype.setPosition,a.prototype.position_changed=function(){this.draw()},a.prototype.position_changed=a.prototype.position_changed,a.prototype.getAnchor=function(){return this.get("anchor")},a.prototype.getAnchor=a.prototype.getAnchor,a.prototype.setAnchor=function(a){this.set("anchor",a)},a.prototype.setAnchor=a.prototype.setAnchor,a.prototype.anchor_changed=function(){this.draw()},a.prototype.anchor_changed=a.prototype.anchor_changed,a.prototype.htmlToDocumentFragment_=function(a){var b=document.createElement("DIV");if(b.innerHTML=a,1===b.childNodes.length)return b.removeChild(b.firstChild);for(var c=document.createDocumentFragment();b.firstChild;)c.appendChild(b.firstChild);return c},a.prototype.removeChildren_=function(a){if(a)for(var b;b=a.firstChild;)a.removeChild(b)},a.prototype.setContent=function(a){this.set("content",a)},a.prototype.setContent=a.prototype.setContent,a.prototype.getContent=function(){return this.get("content")},a.prototype.getContent=a.prototype.getContent,a.prototype.content_changed=function(){function a(a){e.getDraggable()&&(a.preventDefault&&a.preventDefault(),a.returnValue=!1)}function b(){e.draw()}if(this.markerContent_){this.removeChildren_(this.markerContent_);var c=this.getContent();if(c){"string"==typeof c&&(c=c.replace(/^\s*([\S\s]*)\b\s*$/,"$1"),c=this.htmlToDocumentFragment_(c)),this.markerContent_.appendChild(c);for(var d,e=this,f=this.markerContent_.getElementsByTagName("IMG"),g=0;d=f[g];g++)google.maps.event.addDomListener(d,"mousedown",a),google.maps.event.addDomListener(d,"load",b);google.maps.event.trigger(this,"domready")}this.ready_&&this.draw()}},a.prototype.content_changed=a.prototype.content_changed,a.prototype.setCursor_=function(a){if(this.ready_){var b="";-1!==navigator.userAgent.indexOf("Gecko/")?("dragging"===a&&(b="-moz-grabbing"),"dragready"===a&&(b="-moz-grab"),"draggable"===a&&(b="pointer")):(("dragging"===a||"dragready"===a)&&(b="move"),"draggable"===a&&(b="pointer")),this.markerWrapper_.style.cursor!==b&&(this.markerWrapper_.style.cursor=b)}},a.prototype.startDrag=function(a){if(this.getDraggable()&&!this.dragging_){this.dragging_=!0;var b=this.getMap();this.mapDraggable_=b.get("draggable"),b.set("draggable",!1),this.mouseX_=a.clientX,this.mouseY_=a.clientY,this.setCursor_("dragready"),this.markerWrapper_.style.MozUserSelect="none",this.markerWrapper_.style.KhtmlUserSelect="none",this.markerWrapper_.style.WebkitUserSelect="none",this.markerWrapper_.unselectable="on",this.markerWrapper_.onselectstart=function(){return!1},this.addDraggingListeners_(),google.maps.event.trigger(this,"dragstart")}},a.prototype.stopDrag=function(){this.getDraggable()&&this.dragging_&&(this.dragging_=!1,this.getMap().set("draggable",this.mapDraggable_),this.mouseX_=this.mouseY_=this.mapDraggable_=null,this.markerWrapper_.style.MozUserSelect="",this.markerWrapper_.style.KhtmlUserSelect="",this.markerWrapper_.style.WebkitUserSelect="",this.markerWrapper_.unselectable="off",this.markerWrapper_.onselectstart=function(){},this.removeDraggingListeners_(),this.setCursor_("draggable"),google.maps.event.trigger(this,"dragend"),this.draw())},a.prototype.drag=function(a){if(!this.getDraggable()||!this.dragging_)return this.stopDrag(),void 0;var b=this.mouseX_-a.clientX,c=this.mouseY_-a.clientY;this.mouseX_=a.clientX,this.mouseY_=a.clientY;var d=parseInt(this.markerWrapper_.style.left,10)-b,e=parseInt(this.markerWrapper_.style.top,10)-c;this.markerWrapper_.style.left=d+"px",this.markerWrapper_.style.top=e+"px";var f=this.getOffset_(),g=new google.maps.Point(d-f.width,e-f.height),h=this.getProjection();this.setPosition(h.fromDivPixelToLatLng(g)),this.setCursor_("dragging"),google.maps.event.trigger(this,"drag")},a.prototype.removeDragListeners_=function(){this.draggableListener_&&(google.maps.event.removeListener(this.draggableListener_),delete this.draggableListener_),this.setCursor_("")},a.prototype.addDragging_=function(a){if(a){var b=this;this.draggableListener_=google.maps.event.addDomListener(a,"mousedown",function(a){b.startDrag(a)}),this.setCursor_("draggable")}},a.prototype.addDraggingListeners_=function(){var a=this;this.markerWrapper_.setCapture?(this.markerWrapper_.setCapture(!0),this.draggingListeners_=[google.maps.event.addDomListener(this.markerWrapper_,"mousemove",function(b){a.drag(b)},!0),google.maps.event.addDomListener(this.markerWrapper_,"mouseup",function(){a.stopDrag(),a.markerWrapper_.releaseCapture()},!0)]):this.draggingListeners_=[google.maps.event.addDomListener(window,"mousemove",function(b){a.drag(b)},!0),google.maps.event.addDomListener(window,"mouseup",function(){a.stopDrag()},!0)]},a.prototype.removeDraggingListeners_=function(){if(this.draggingListeners_){for(var a,b=0;a=this.draggingListeners_[b];b++)google.maps.event.removeListener(a);this.draggingListeners_.length=0}},a.prototype.getOffset_=function(){var a=this.getAnchor();if("object"==typeof a)return a;var c=new google.maps.Size(0,0);if(!this.markerContent_)return c;var d=this.markerContent_.offsetWidth,e=this.markerContent_.offsetHeight;switch(a){case b.TOP_LEFT:break;case b.TOP:c.width=-d/2;break;case b.TOP_RIGHT:c.width=-d;break;case b.LEFT:c.height=-e/2;break;case b.MIDDLE:c.width=-d/2,c.height=-e/2;break;case b.RIGHT:c.width=-d,c.height=-e/2;break;case b.BOTTOM_LEFT:c.height=-e;break;case b.BOTTOM:c.width=-d/2,c.height=-e;break;case b.BOTTOM_RIGHT:c.width=-d,c.height=-e}return c},a.prototype.onAdd=function(){if(this.markerWrapper_||(this.markerWrapper_=document.createElement("DIV"),this.markerWrapper_.style.position="absolute"),this.getZIndex()&&(this.markerWrapper_.style.zIndex=this.getZIndex()),this.markerWrapper_.style.display=this.getVisible()?"":"none",!this.markerContent_){this.markerContent_=document.createElement("DIV"),this.markerWrapper_.appendChild(this.markerContent_);var a=this;google.maps.event.addDomListener(this.markerContent_,"click",function(){google.maps.event.trigger(a,"click")}),google.maps.event.addDomListener(this.markerContent_,"mouseover",function(){google.maps.event.trigger(a,"mouseover")}),google.maps.event.addDomListener(this.markerContent_,"mouseout",function(){google.maps.event.trigger(a,"mouseout")})}this.ready_=!0,this.content_changed(),this.flat_changed(),this.draggable_changed();var b=this.getPanes();b&&b.overlayMouseTarget.appendChild(this.markerWrapper_),google.maps.event.trigger(this,"ready")},a.prototype.onAdd=a.prototype.onAdd,a.prototype.draw=function(){if(this.ready_&&!this.dragging_){var a=this.getProjection();if(a){var b=this.get("position"),c=a.fromLatLngToDivPixel(b),d=this.getOffset_();this.markerWrapper_.style.top=c.y+d.height+"px",this.markerWrapper_.style.left=c.x+d.width+"px";var e=this.markerContent_.offsetHeight,f=this.markerContent_.offsetWidth;f!==this.get("width")&&this.set("width",f),e!==this.get("height")&&this.set("height",e)}}},a.prototype.draw=a.prototype.draw,a.prototype.onRemove=function(){this.markerWrapper_&&this.markerWrapper_.parentNode&&this.markerWrapper_.parentNode.removeChild(this.markerWrapper_),this.removeDragListeners_()},a.prototype.onRemove=a.prototype.onRemove;var b={TOP_LEFT:1,TOP:2,TOP_RIGHT:3,LEFT:4,MIDDLE:5,RIGHT:6,BOTTOM_LEFT:7,BOTTOM:8,BOTTOM_RIGHT:9};return window.RichMarkerPosition=b,a})}]),angular.module("mapMarkerNext",["googleMapsRichMarker","googleMapsInfoBox","pins"]).directive("mapMarker",["$q","RichMarker","InfoBox",function(a,b,c){return{restrict:"A",require:"^map",replace:!0,scope:!0,transclude:!0,templateUrl:"/parts/map/map-marker-template.html",link:function(d,e,f,g){function h(a){k=new a({content:m,map:g.googleMap,flat:!0}),k.setPosition(new google.maps.LatLng(o.lat,o.lon)),"outdoor"in o?o.outdoor===!1?(k.setZIndex(3),google.maps.event.addListener(k,"ready",function(){e.show()})):k.setZIndex(2):google.maps.event.addListener(k,"ready",function(){e.show()})}function i(a){var b="";return b="outdoor"in a?a.outdoor===!1?new google.maps.Size(-185,-15):new google.maps.Size(-185,-48):new google.maps.Size(-185,-22)}function j(a){l=new a({content:n,boxClass:"map-infobox-outer",pane:"overlayMouseTarget",alignBottom:!0,pixelOffset:i(d.item),closeBoxURL:""}),console.log("item "+o),console.log("item.outdoor "+o.outdoor),"outdoor"in o?o.outdoor===!1&&d.$watch("item.selected",function(a){a?(console.log("item.outdoor==false "+!0),k.setZIndex(4),l.open(g.googleMap,k)):(console.log("item.outdoor==false "+!1),l.close())}):(console.log("no outdoor item"),d.$watch("item.selected",function(a){a?(console.log("no outdoor item -selected"),k.setZIndex(4),l.open(g.googleMap,k)):(console.log("no outdoor item -not selected"),l.close())}))}var k,l,m=e.find(".marker")[0],n=e.find(".infobox")[0],o=d.$eval(f.item);d.item=o,e.hide(),a.all([b,c,g.promiseToReturnGoogleMap()]).then(function(a){h(a[0]),j(a[1])}),d.$on("DESELECT_MARKER",function(){o.selected=!1,currentSelectedMarker="","outdoor"in o?o.outdoor===!1&&k.setZIndex(3):k.setZIndex(2)}),d.$on("$destroy",function(){k&&k.setMap(null),l&&l.close()})}}}]),angular.module("map",["config","googleMapsAsync","mapMarkerNext","modal","spinner","alertModal","showBusy","downloadAssistant","isViewportSize","ngCookies"]).directive("errSrc",function(){return{link:function(a,b,c){b.bind("error",function(){b.attr("src",c.errSrc)})}}}).filter("startFrom",function(){return function(a,b){return b=+b,a.slice(b)}}).filter("capitalize",function(){return function(a){return a?a[0].toUpperCase()+a.slice(1):void 0}}).controller("MapCtrl",["$scope","$http","$q","Config","googleMapsAsync","alertModal","DownloadAssistant","isViewportSize","$cookies","$timeout",function(a,b,c,d,e,f,g,h,k){function l(a){for(Z.itemsInSameLatLon=[],i=0;i<Z.items.length;i++)Z.items[i].lat===a.lat&&Z.items[i].lon===a.lon&&"OUTDOOR"!==Z.items[i].type&&Z.itemsInSameLatLon.push(Z.items[i]);if(Z.itemsOnMoreHover="",Z.visibleMoreFlag=!1,Z.itemsInSameLatLon.length>5)for(Z.visibleMoreFlag=!0,j=5;j<Z.itemsInSameLatLon.length;j++)Z.itemsOnMoreHover+=Z.itemsInSameLatLon[j].name+"\n"}function m(){Z.currentPage=Z.currentPage-1,0===Z.currentPage&&(Z.visibleNearestStoreFlag=!0)}function n(){Z.currentPage=Z.currentPage+1,Z.visibleNearestStoreFlag=!1}function o(){return b({url:d.getValuesBySelector("endpoint.api.map_public")+"/map/hotspot/meta/categories",method:"GET"}).success(function(a){var b=[bb],c=[],d=[],e=[""],f=0;c[f]=bb,d[f]="";for(var g in a)"NONE"!==g&&"_links"!==g&&(f++,b.push(a[g]),0!==f&&(c[f]=a[g]),d[f]=g,e.push(g));Z.model.categories=b,Z.model.searchCategories=e,Z.model.categoriesLabel=c,Z.model.categoriesName=d}).error(function(){})}function p(){if(a.maploaded=!0,x(),navigator.geolocation&&(Z.geolocationEnabled=!0),!Z.initialized){Z.busyState="loading";var b=[{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]}];e.getPromise().then(function(){Z.geocoder=new google.maps.Geocoder,Z.googleMap=new google.maps.Map(Z.googleMapElement),Z.googleMap.setOptions({mapTypeId:google.maps.MapTypeId.ROADMAP,mapTypeControl:!1,scrollwheel:!1,zoom:16,styles:b}),Z.autocomplete=new google.maps.places.Autocomplete(Z.autocompleteInput),r(),Z.googleMapDeferred.resolve(Z.googleMap),Z.initialized=!0}),e.load()}}function q(){Z.visibleNearestStoreFlag=!0,Z.currentPage=0,Z.busyState="loading";var a=T(Z.mapCenter.lat,Z.mapCenter.lon),b=Z.googleMap.getBounds().getSouthWest(),d=Z.googleMap.getBounds().getNorthEast(),e=b.lat(),f=b.lng(),g=d.lat(),h=d.lng(),i={"area.minLat":e,"area.minLon":f+(Math.abs(a.lng())-Math.abs(Z.mapCenter.lon)),"area.maxLat":g,"area.maxLon":h,sortBy:"distance"},j={};switch(Z.mapType){case"hotspots":i.pageSize=100,i.distance=50,i.categoriesString=Z.model.categories[Z.model.currentCategory]===bb?"":Z.model.categoriesName[Z.model.currentCategory],c.all([M(i)]).then(function(a){F(a[0].data),Z.busyState="standby"},function(a){Z.busyState="standby",console.log("hotspots"),J(a)});break;case"stores":i.pageSize=8,i.byType="Optimum Store",j=angular.copy(i),j.pageSize=1,c.all([L(j),K(i)]).then(function(){E(Z.items,Z.nearestStore),Z.busyState="standby"},function(){Z.busyState="standby",console.log("stores"),J(error)});break;case"business":i.pageSize=100,i.distance=50,i.categoriesString=Z.model.categories[Z.model.currentCategory]===bb?"":Z.model.categoriesName[Z.model.currentCategory],c.all([M(i)]).then(function(a){F(a[0].data),setTimeout(function(){$("div .item-primary").length>0&&($("div .item-primary").css({"padding-top":"21px"}),$("div .item-primary").css({"padding-right":"21px"}),$("div .item-primary").css({"padding-bottom":"28px"}),$("div .item-primary").css({"padding-left":"21px"}),$("div .item-primary").css({"border-top-left-radius":"8px"}),$("div .item-primary").css({"border-top-right-radius":"8px"}),$("div .item-primary").css({"border-bottom-right-radius":"8px"}),$("div .item-primary").css({"border-bottom-left-radius":"8px"})),$("div .item-secondary").length>0&&($("div .item-secondary").css({"padding-top":"21px"}),$("div .item-secondary").css({"padding-right":"21px"}),$("div .item-secondary").css({"padding-bottom":"28px"}),$("div .item-secondary").css({"padding-left":"21px"}),$("div .item-primary").css({"border-top-left-radius":"8px"}),$("div .item-primary").css({"border-top-right-radius":"8px"}),$("div .item-primary").css({"border-bottom-right-radius":"8px"}),$("div .item-primary").css({"border-bottom-left-radius":"8px"}))}),Z.busyState="standby"},function(a){Z.busyState="standby",console.log("business again"),J(a)});break;case"storesAndPaymentCenters":i.pageSize=8,j=angular.copy(i),j.pageSize=1,j.byType="Optimum Store",c.all([L(j),K(i)]).then(function(){E(Z.items,Z.nearestStore),Z.busyState="standby"},function(){Z.busyState="standby",J(error)})}""!==ab&&R(ab)}function r(){google.maps.event.addListener(Z.googleMap,"dragend",function(){Z.initialized&&Z.googleMap.getBounds()&&(ab="",a.$apply(q()))}),google.maps.event.addListener(Z.googleMap,"projection_changed",function(){var a=d.getValuesBySelector("endpoint.api.map")+"map/geolocate";if(k.cachekeys){for(var c="",e=k.cachekeys.replace('"',"").split("|"),f=0;f<e.length;f++)e[f].indexOf("ZIP=")>-1&&(c=e[f].replace("ZIP=",""));a+="/zipcode/"+c}else a+="/zipcode/11801";b({url:a,method:"GET"}).success(function(a){a.location&&a.location.latLon&&a.location.latLon.lat&&a.location.latLon.lon?"business"===Z.mapType?N(s(Z.userAddressString.blat,Z.userAddressString.blon),!0):N(s(a.location.latLon.lat,a.location.latLon.lon),!0):w()||N(null,!0)}).error(function(){w()||N(null,!0)})}),google.maps.event.addListener(Z.googleMap,"zoom_changed",function(){Z.initialized&&Z.googleMap.getBounds()&&Z.zoomControls&&a.$apply(q()),Z.zoomControls=!0}),google.maps.event.addListener(Z.googleMap,"resize",function(){V()}),google.maps.event.addListener(Z.autocomplete,"place_changed",function(){Z.autocompleteDirty=!1,v()})}function s(a,b){return{"near.lat":a,"near.lon":b}}function t(){Z.initialized||p()}function u(){Z.model.currentCategoryName=Z.model.categoriesName[Z.model.currentCategory],ab="",""!==$("#map_autocomplete").val()?N(null,!1):O()}function v(){function b(){N(s(d.geometry.location.lat(),d.geometry.location.lng()),!0),"business"===Z.mapType&&R(Z.items[0])}function c(){f.create("Please enter a city, state or zip code.")}ab="",Z.visibleNearestStoreFlag=!0;var d=Z.autocomplete.getPlace();angular.isObject(d)&&angular.isObject(d.geometry)&&!Z.autocompleteDirty?b():Z.autocompleteInput.value.match(/\S/)?Y.getPlacePredictions({input:Z.autocompleteInput.value},function(e,f){a.$apply(function(){f===google.maps.places.PlacesServiceStatus.OK&&e.length>0?(Z.autocompleteInput.value=e[0].description,X.getDetails({reference:e[0].reference},function(e,f){a.$apply(function(){f===google.maps.places.PlacesServiceStatus.OK?(d=e,b()):c()
})})):c()})}):c()}function w(){return Z.geolocationEnabled&&navigator.geolocation?(navigator.geolocation.getCurrentPosition(function(a){N(s(a.coords.latitude,a.coords.longitude),!0)},function(){}),!0):!1}function x(){U(),"hotspots"===Z.mapType?Z.mapTypeString="hotspots":"stores"===Z.mapType?Z.mapTypeString="Optimum Stores":"storesAndPaymentCenters"===Z.mapType?Z.mapTypeString="Payment Centers":"business"===Z.mapType&&(Z.mapTypeString="Business")}function y(a){if(Z.lastSearchParams.pageSize="hotspots"===Z.mapType?null:8,!_.contains(Z.validTypes,a))throw"'"+a+"' is not a recognized map type. Currently only these are: "+Z.validTypes.join();a!==Z.mapType&&(Z.mapType=a,Z.nearestStore=null,Z.items=[],Z.initialized&&N(null,!0)),x()}function z(a){Z.lastSearchParams.pageSize=null,Z.userAddressString.blat!==a.lat&&Z.userAddressString.blon!==a.lon&&(Z.userAddressString.blat=a.lat,Z.userAddressString.blon=a.lon)}function A(a){a?(Z.zoomControls=!1,"hotspots"!==Z.mapType&&"business"!==Z.mapType||0!==Z.model.currentCategory?Z.googleMap.setZoom(Z.mapCenter.zoom):Z.googleMap.setZoom(15),Z.googleMap.getProjection()?Z.googleMap.panTo(T(Z.mapCenter.lat,Z.mapCenter.lon)):Z.googleMap.panTo(new google.maps.LatLng(Z.mapCenter.lat,Z.mapCenter.lon))):V()}function B(a){return Z.indoorCount=0,_.map(a,function(a){var b=a;if(b.lat=b.latLon.lat,b.lon=b.latLon.lon,b.street=b.street,b.city=b.city,b.state=b.state,b.providerName=b.provider.name,b.categoryAsInDBItems=[],-1!==b.categoryAsInDB.indexOf("/")){b.categoryAsInDB=b.categoryAsInDB.split("/");for(var c=0;c<b.categoryAsInDB.length;c++)b.categoryAsInDBItems.push({catIndex:c,category:b.categoryAsInDB[c]})}else b.categoryAsInDBItems.push({catIndex:0,category:b.categoryAsInDB});return b.category=b.category,"businesssr"===b.accountType.toLowerCase()?(b.type="INDOOR",Z.indoorCount=Z.indoorCount+1,b.name||(b.name="indoor hotspot")):"cablevision"===b.providerName.toLowerCase()&&b.outdoor===!0?(b.type="OUTDOOR",b.name||(b.name="outdoor hotspot")):"cablevision"===b.providerName.toLowerCase()&&b.outdoor===!1?(b.type="INDOOR",Z.indoorCount=Z.indoorCount+1,b.name||(b.name="indoor hotspot")):b.outdoor===!0?(b.type="PARTNER_OUTDOOR",b.name||(b.name="partner outdoor hotspot")):(b.type="PARTNER_INDOOR",Z.indoorCount=Z.indoorCount+1,b.name||(b.name="partner indoor hotspot")),b.selected=!1,b})}function C(a){return _.map(a,function(a){var b=a;b.lat=b.latLon.lat,b.lon=b.latLon.lon,b.category="NONE";var c="";return(null===b.hours||"null"===b.hours)&&(b.hours=""),c=b.hours,""!==c&&(-1!==c.indexOf("Sunday")&&(c=c.replace("Monday",Z.weekDays.Sunday),b.hours=c),-1!==c.indexOf("Monday")&&(c=c.replace("Monday",Z.weekDays.Monday),b.hours=c),-1!==c.indexOf("Tuesday")&&(c=c.replace("Tuesday",Z.weekDays.Tuesday),b.hours=c),-1!==c.indexOf("Wednesday")&&(c=c.replace("Wednesday",Z.weekDays.Wednesday),b.hours=c),-1!==c.indexOf("Thursday")&&(c=c.replace("Thursday",Z.weekDays.Thursday),b.hours=c),-1!==c.indexOf("Friday")&&(c=c.replace("Friday",Z.weekDays.Friday),b.hours=c),-1!==c.indexOf("Saturday")&&(c=c.replace("Saturday",Z.weekDays.Saturday),b.hours=c)),b.type="OPTIMUM_STORE"===b.type?"primary":"secondary","primary"===b.type?b.name="Optimum Store":"secondary"!==b.type||b.name||(b.name="Payment Center"),b.selected=!1,b})}function D(a){var b=a;b.lat=b.latLon.lat,b.lon=b.latLon.lon,b.category="NONE";var c="";return(null===b.hours||"null"===b.hours)&&(b.hours=""),c=b.hours,""!==c&&(-1!==c.indexOf("Sunday")&&(c=c.replace("Monday",Z.weekDays.Sunday),b.hours=c),-1!==c.indexOf("Monday")&&(c=c.replace("Monday",Z.weekDays.Monday),b.hours=c),-1!==c.indexOf("Tuesday")&&(c=c.replace("Tuesday",Z.weekDays.Tuesday),b.hours=c),-1!==c.indexOf("Wednesday")&&(c=c.replace("Wednesday",Z.weekDays.Wednesday),b.hours=c),-1!==c.indexOf("Thursday")&&(c=c.replace("Thursday",Z.weekDays.Thursday),b.hours=c),-1!==c.indexOf("Friday")&&(c=c.replace("Friday",Z.weekDays.Friday),b.hours=c),-1!==c.indexOf("Saturday")&&(c=c.replace("Saturday",Z.weekDays.Saturday),b.hours=c)),b.type="nearestStore",b.name="Optimum Store",b.selected=!1,b}function E(a,b){return _.filter(a,function(a){return a.street!==b.street})}function F(a){if(0===Z.model.categories.length&&a.categoriesFacet&&a.categoriesFacet.length>0){var b=[],c=[],d=[];d[0]=bb;for(var e=0,f=a.categoriesFacet.length;f>e;e++)"NONE"!==a.categoriesFacet[e].catName?(c[e]=a.categoriesFacet[e].label,b[e]=a.categoriesFacet[e].catName,d[e]=a.categoriesFacet[e].label):(b[e]=bb,c="",d[e]=bb);Z.model.categories=b,Z.model.categoriesLabel=d}if(""!==ab)R(ab);else if(a.mapCenter){if(Z.mapCenter=a.mapCenter,a._embedded&&a._embedded.results){if(a._embedded.results.length>1){var g=_.uniq(a._embedded.results,function(a){return JSON.stringify(a)});a._embedded.results=g}var h=_.arrayify(a._embedded.results);P(B(h))}}else Z.mapCenter=G(Z.lastSearchParams["near.lat"],Z.lastSearchParams["near.lon"],13),P([])}function G(a,b,c){return{all:!0,lat:a,lon:b,zoom:c}}function H(a){if(""!==ab)R(ab);else if(a.mapCenter){if(Z.mapCenter=a.mapCenter,a._embedded&&a._embedded.results){var b=_.arrayify(a._embedded.results);storeItems=C(b),P(storeItems)}}else Z.mapCenter=G(Z.lastSearchParams["near.lat"],Z.lastSearchParams["near.lon"],13),P([])}function I(a){a&&a._embedded&&a._embedded.results&&(Z.nearestStore=D(a._embedded.results,!0))}function J(a,b){f.create("Sorry, there was a problem loading the map data: Status "+b),A(!1)}function K(a){return console.log("getLoadAllStoresPromise"),b({url:d.getValuesBySelector("endpoint.api.map")+"/map/store/marker/search",method:"GET",params:a}).success(H).error(J)}function L(a){return b({url:d.getValuesBySelector("endpoint.api.map")+"/map/store/marker/search",method:"GET",params:a}).success(I).error(function(){})}function M(a){return b({url:d.getValuesBySelector("endpoint.api.map")+"map/hotspot/marker/search?"+(new Date).getTime(),method:"GET",params:a,cache:!1}).success(function(){}).error(J)}function N(a){Z.currentPage=0,Z.initialized||p(),Z.busyState="loading",a=a||{},a=_.defaults(a,Z.lastSearchParams),Z.lastSearchParams=a;var b={};switch(Z.mapType){case"hotspots":a.pageSize=100,a.distance=50,a.categoriesString=Z.model.categories[Z.model.currentCategory]===bb?"":Z.model.categoriesName[Z.model.currentCategory],c.all([M(a)]).then(function(a){F(a[0].data),A(!0),Z.busyState="standby"},function(a){Z.busyState="standby",console.log("hotspots again"),J(a)});break;case"business":a.pageSize=100,a.distance=50,a.categoriesString=Z.model.categories[Z.model.currentCategory]===bb?"":Z.model.categoriesName[Z.model.currentCategory],c.all([M(a)]).then(function(a){F(a[0].data),A(!0),R(Z.items[0]),setTimeout(function(){$("div .item-primary").length>0&&($("div .item-primary").css({"padding-top":"21px"}),$("div .item-primary").css({"padding-right":"21px"}),$("div .item-primary").css({"padding-bottom":"28px"}),$("div .item-primary").css({"padding-left":"21px"}),$("div .item-primary").css({"border-top-left-radius":"8px"}),$("div .item-primary").css({"border-top-right-radius":"8px"}),$("div .item-primary").css({"border-bottom-right-radius":"8px"}),$("div .item-primary").css({"border-bottom-left-radius":"8px"})),$("div .item-secondary").length>0&&($("div .item-secondary").css({"padding-top":"21px"}),$("div .item-secondary").css({"padding-right":"21px"}),$("div .item-secondary").css({"padding-bottom":"28px"}),$("div .item-secondary").css({"padding-left":"21px"}),$("div .item-primary").css({"border-top-left-radius":"8px"}),$("div .item-primary").css({"border-top-right-radius":"8px"}),$("div .item-primary").css({"border-bottom-right-radius":"8px"}),$("div .item-primary").css({"border-bottom-left-radius":"8px"}))}),Z.busyState="standby"},function(a){Z.busyState="standby",console.log("business again"),J(a)});break;case"stores":a.pageSize=8,a.distance=500,a.byType="Optimum Store",b=angular.copy(a),b.pageSize=1,c.all([L(b),K(a)]).then(function(){E(Z.items,Z.nearestStore),A(!0),Z.busyState="standby"},function(){Z.busyState="standby",A(!0)});break;case"storesAndPaymentCenters":a.pageSize=8,a.distance=500,b=angular.copy(a),b.pageSize=1,b.byType="Optimum Store",c.all([L(b),K(a)]).then(function(){E(Z.items,Z.nearestStore),Z.busyState="standby",A(!0)},function(){Z.busyState="standby",A(!0)})}""!==ab&&R(ab)}function O(){var a=Z.googleMap.getCenter();N({"near.lat":a.lat(),"near.lon":a.lng()})}function P(a){_.replaceArrayItems(Z.items,a)}function Q(a){var b="",c={street:a.street||"",city:a.city||"",state:a.state||"",zip:a.zip||""};for(var d in c)b+=c[d],""!==c[d]&&"zip"!==d&&(b+="+");return b=""!==b?encodeURIComponent(b):""}function R(a){if("hotspots"===Z.mapType&&"OUTDOOR"===a.type)return a.selected=!1,void 0;if(a.selected)a.selected=!1;else if(U(),h.phone){var b=g.getPlatformURL("mapsURL")||d.getValuesBySelector("link.mapDefault"),c=0===b.indexOf("geo:")?!0:!1,e=a.lat+","+a.lon,f=Q(a),i=(c?"?":"&")+"q=",j=b;j+=c?e:"?ll="+e,j+=i+f,window.location.href=j}else"hotspots"===Z.mapType&&Z.itemsOnMoreHoverFun(a),"business"===Z.mapType&&Z.itemsOnMoreHoverFun(a),a.selected=!0,ab=a,Z.googleMap.panTo(T(a.lat,a.lon))}function S(a){a.selected=!1,ab=""}function T(a,b){var c,d=$(Z.googleMap.getDiv()).width(),e=d/2;c="business"===Z.mapType?(d-20)/2:(d-400)/2;var f=e-c,g=Math.pow(2,Z.googleMap.getZoom()),h=new google.maps.LatLng(a,b),i=Z.googleMap.getProjection().fromLatLngToPoint(h),j=new google.maps.Point(f/g,0),k=new google.maps.Point(i.x-j.x,i.y+j.y);return Z.googleMap.getProjection().fromPointToLatLng(k)}function U(){a.$broadcast("DESELECT_MARKER","Calling all markers, please deselect yourselves!"),ab=""}function V(){Z.googleMap.panTo(new google.maps.LatLng(Z.lastSearchParams["near.lat"],Z.lastSearchParams["near.lon"]))}function W(){return Z.googleMapDeferred.promise}var X,Y,Z={model:{currentCategory:0,categories:[],categoriesLabel:[],categoriesName:[],searchCategories:[],currentCategoryName:""},zoomControls:!0,changeDropdown:u,clickDropdown:t,googleMapElement:void 0,googleMap:void 0,geocoder:void 0,autocomplete:void 0,googleMapDeferred:c.defer(),promiseToReturnGoogleMap:W,initialized:!1,geolocationEnabled:!1,mapType:"hotspots",validTypes:["hotspots","stores","storesAndPaymentCenters","business"],busyState:"standby",lastSearchParams:{pageSize:8,sortBy:"distance",distance:2,"near.lat":40.65,"near.lon":-73.94999999999999},userAddressString:{blat:"",blon:""},mapTypeString:"",mapCenter:void 0,items:[],legendSize:8,legendStoreSize:4,legendStoreStartFrom:"",legendStorePrevPage:m,legendStoreNextPage:n,weekDays:{Sunday:"Sun",Monday:"Mon",Tuesday:"Tue",Wednesday:"Wed",Thursday:"Thu",Friday:"Fri",Saturday:"Sat"},indoorCount:0,itemsOnMoreHoverFun:l,itemsInSameLatLon:[],visibleMoreFlag:!1,visibleNearestStoreFlag:!0,itemsOnMoreHover:"",nearestStore:void 0,markers:[],nextPage:"",prevPage:"",currentPage:0,init:p,setMapType:y,setAddress:z,searchWithAutocompleteValue:v,searchGeolocate:w,loadItems:N,selectItem:R,deselectItem:S,testingLocation:function(a){console.log("Testing location: ",a)}};e.getPromise().then(function(){X=new google.maps.places.PlacesService(Z.googleMapElement),Y=new google.maps.places.AutocompleteService});var ab="",bb="All hotspots";return o(),Z.handleKeyUp=function(a){return(10===a.which||13===a.which)&&v(),!0},a.MapCtrl=Z}]).directive("map",[function(){return{restrict:"A",replace:!0,scope:{type:"=type",address:"=address"},controller:"MapCtrl",templateUrl:"/parts/map/map-template.html",transclude:!0,link:function(a,b,c,d){d.googleMapElement=b.find("#map_canvas")[0],d.autocompleteInput=b.find("#map_autocomplete")[0],$(d.autocompleteInput).bind("focus",function(){d.initialized||d.init()}),$(d.autocompleteInput).bind("keypress input change",function(){d.autocompleteDirty=!0}),a.$watch(c.init,function(a){a&&d.init()}),a.$watch("type",function(){d.setMapType(a.type)}),a.$watch("address",function(){"business"===d.mapType&&void 0!==a.address.lat&&void 0!==a.address.lon&&d.setAddress(a.address)})}}}]),angular.module("messageModal",["modalDialog","messageModel","messagePanel"]).factory("messageModal",["modalDialog","messageModel",function(a,b){function c(a){return{templateUrl:"/parts/messages/message-modal/message-modal-template.html",controller:["$scope","model","dialog",function(a,b,c){a.dialog=c,a.model=b}],cssClassModal:d(a.cssClassModal),cssClass:a.cssClass||"theme-white",resolve:{model:function(){return b({sheetTitle:a.sheetTitle,title:a.title,message:a.message,theme:a.theme||a.cssClass,icon:a.icon,ctas:a.ctas})}}}}function d(a){return _.addCssClassStrict(a,"modal-message")}return function(b){return a(c(b))}}]),angular.module("messageModel",[]).factory("messageModel",[function(){function a(a){return _.isString(a)&&a&&"icon-"!==a.substr(0,5)&&(a="icon-"+a),a}function b(a){if(a=a||[],_.isEmpty(_.filter(a,{result:"cancel"}))){var b={label:_.isEmpty(a)?"Okay":"Cancel",result:"cancel",cssClass:a[0]&&a[0].cssClass?a[0].cssClass:""};a.push(b)}return _.each(a,function(a){a.cssClass=_.addCssClass(a.cssClass,"btn--dark-overlay")}),a}return function(c){return c=_.clone(c),c.icon=a(c.icon),c.ctas=b(c.ctas),c.theme=c.theme||"white",c.sheetTitle=c.sheetTitle||"Message",c}}]),angular.module("messagePanel",["if","messageModel","isViewportSize","panel"]).directive("messagePanel",["messageModel","isViewportSize","$parse",function(a,b,c){return{restrict:"EA",templateUrl:"/parts/messages/message-panel/message-panel-template.html",scope:!0,link:function(d,e,f){var g={},h=["header","title","message","icon","ctas","sheetTitle"];_.each(h,function(b){_.isDefined(f[b])&&d.$watch(f[b],function(c){g[b]=c,d.messagePanel=a(_.clone(g))})}),d.resolve=function(a){f.onResolve&&c(f.onResolve)(d,{$event:a})};var i="white";f.theme&&d.$watch(f.theme,function(a){a=a||f.theme;var b="theme-";i=_.str.startsWith(a,b)?_.str.splice(a,0,b.length):a}),d.contentClasses=function(){return o={},o["theme-"+i]=!b.phone,o["theme-content-"+i]=b.phone,o},d.sheetHeaderClasses=function(){return b.phone?"theme-"+i:""}}}}]),angular.module("messages",["messagePanel","messageModel","messageModal"]),angular.module("meter",[]).directive("meter",[function(){return{restrict:"E",replace:!0,template:'<div class="meter"><div class="meter__amount" ng-style="{width:percentage + \'%\'}"></div></div>',scope:{value:"@",max:"@"},controller:["$scope",function(a){function b(){return 100*(a.value/a.max)||0}a.$watch("value + max",function(){a.percentage=b()})}]}}]),angular.module("modalDialog",["modal","panel","ngSanitize","dots","if"]).provider("modalDialog",[function(){var a='<div modal class="modal-dialog modal--responsive" toggle="dialog.isOpen" ng-class="dialog.options.cssClassModal"></div>';this.$get=["$compile","$rootScope","$document","templateToPromise","$q","$controller","injectResolve",function(b,c,d,e,f,g,h){function i(b){var d=this;return d.options=b||{},d.template=$(a),d.isOpen=!1,d.willClose=f.defer(),d.willResolve=f.all([h(d.options.resolve||{}),e(d.options)]).then(function(a){var b=a[0],e=a[1];return d.template.html(e),b.dialog=d,b.$scope=_.firstDefined(b.$scope,c.$new()),b}),d}return i.prototype.open=function(){var a=this;return a.isOpen=!0,a.willResolve.then(function(b){a._appendDom(b)}),a.willClose.promise},i.prototype.close=function(a){this.isOpen&&(this.isOpen=!1,this.willClose.resolve(a),this._removeDom())},i.prototype._appendDom=function(a){var c=this;c.options.controller&&c.template.contents().data("ngControllerController",g(c.options.controller,a)),c._el=b(c.template.clone())(a.$scope),d.find("body").append(c._el)},i.prototype._removeDom=function(){this._el.remove(),delete this._el},function(a){return new i(a)}}]}]).factory("templateToPromise",["$http","$templateCache","$q",function(a,b,c){return function(d){return d.templateUrl?a.get(d.templateUrl,{cache:b}).then(function(a){return a.data}):d.template?c.when(d.template):void 0}}]).factory("injectResolve",["$injector","$q",function(a,b){return function(c){function d(b){return _.isString(b)?a.get(b):a.invoke(b)}return b.all(_.map(c,d)).then(function(a){return _.zipObject(_.keys(c),a)})}}]),angular.module("modal",[]).directive("modal",["$document","$window",function(a,b){var c=a.find("body"),d=a.find("html"),e=0;return{restrict:"EA",replace:!0,transclude:!0,scope:!0,templateUrl:"/parts/modal/modal-template.html",compile:function(a,f,g){return function(a,f,h){function i(b){27===b.which&&(a.$broadcast("modal.close"),b.preventDefault(),c.removeClass("is-modal-mode"),f.hide(),e--,0>e&&(e=0),a.$apply())}var j={},k={};a=a.$new(),g(a,function(a){f.find(".modal__inner").append(a)}),a.modal={isActive:!1},a.$watch(h.toggle,function(g){var h=!1;g&&!a.modal.isActive?(c.is(".is-modal-mode")||(j.top=c.scrollTop(),j.left=c.scrollLeft(),k.top=d.scrollTop(),k.left=d.scrollLeft(),c.addClass("is-modal-mode")),e++):!g&&a.modal.isActive&&(e--,0>e&&(e=0),0===e&&(h=!0,c.removeClass("is-modal-mode"))),h&&setTimeout(function(){b.scrollTo(j.left||k.left,j.top||k.top)},100),Boolean(g)?(f.show(),a.modal.isActive=!0,c.on("keydown",i)):(a.modal.isActive=!1,c.off("keydown",i))}),a.$on("$destroy",function(){a.modal.isActive&&(e--,0>e&&(e=0),0===e&&c.removeClass("is-modal-mode"))})}}}}]),angular.module("notice",[]).directive("notices",["$notice","$compile",function(a,b){return{restrict:"E",replace:!0,scope:!0,template:['<ul class="notices">','<li ng-repeat="notice in notices" class="added">','<div class="notice">','<p class="notice-message notice-{{notice.level}}" ng-bind="notice.message"></p>',"</div>","</li>","</ul>"].join(""),link:function(c,d,e){var f,g,h;f=a.all(),g=c.$eval(e.begin)||0,h=c.$eval(e.end),c.notices=f.slice(g,h),c.$on("notice.add",function(){c.notices=f.slice(g,h)}),c.$watch("notices",function(){}),b(d.contents())(c)}}}]).factory("$notice",["$rootScope",function(a){var b={notices:[],add:function(b,c){c=c||"info";var d={message:b,level:c};return this.notices.push(d),a.$broadcast("notice.add",d)},all:function(){var b=this.notices;return a.$broadcast("notices.all",!0),b},dismiss:function(b){return this.notices.splice(b,1),a.$broadcast("notices.remove",!0)},count:function(){return a.$broadcast("notices.count",!0),this.notices.length},clear:function(){return a.$broadcast("notices.clear",!0),this.notices=[]}};return b}]),angular.module("offsetTop",[]).directive("offsetTop",["$parse",function(a){return{link:function(b,c,d){function e(){f(b,c.offset().top)}var f=a(d.offsetTop).assign;e(),b.$on("offsetTop.recalculate",e)}}}]),angular.module("onceWithinViewport",[]).directive("onceWithinViewport",["$rootScope",function(a){function b(a){var b=a.getBoundingClientRect();return(0!==b.top||0!==b.bottom||0!==b.left||0!==b.right)&&b.top<=$(window).height()&&b.left<=$(window).width()}function c(){try{clearTimeout(d)}catch(c){}$("html").is(".is-sheet-mode")||(console.log("onceWithinViewport triggered"),d=setTimeout(function(){var c,d;0!==e.length&&a.$apply(function(){for(c=e.length-1;c>=0;c--)d=e[c],angular.isObject(d)?(d.scope.inViewport=b(d.el))&&e.splice(c,1):console.error("scopeAndElement is undefined")})},100))}var d,e=[];return $(window).on("DOMContentLoaded load scroll resize",c),{transclude:!0,scope:!0,template:'<div>  <div ng-hide="inViewport || forceInViewport" ng-style="inlineStyles" class="once-within-viewport--placeholder"></div>  <div ng-transclude if="inViewport || forceInViewport"></div></div>',link:function(a,b,d){function f(c){g=setInterval(function(){var c=a.inViewport&&b.height();c!==!1&&0!==c&&(a.height=c,a.inlineStyles.height=c+"px",clearInterval(g))},c)}var g,h={el:b[0],scope:a};a.height=0,a.inlineStyles={},a.inViewport=!1,d.$observe("onceWithinViewport",function(b){a.forceInViewport=!!b&&"false"!==b}),f(2e3),e.push(h),b.on("$destroy",function(){var a=_.indexOf(e,h);a>-1&&e.splice(a,1)}),c()}}}]),angular.module("pagination",["summarize","dropdowns"]).directive("pagination",["$parse","summarize",function(a,b){return{restrict:"E",templateUrl:"/parts/pagination/pagination-template.html",scope:{current:"=",itemsTotal:"=",itemsPerPage:"=",onChange:"&"},link:function(a,c,d){function e(){if(a.current>a.count)for(var b=a.current-1;b;){if(b<a.count){a.current=b;break}b--}}function f(c){a.pageNums=a.count?_.range(0,a.count):[],a.pageNumsOptions=_.map(a.pageNums,function(a){return{label:a+1,value:a}});var d={focus:c,displayCount:a.countDisplay};a.pages=_.map(b(a.pageNums,d),g)}function g(a){var b={};return b.isSeparator=!_.isNumber(a),b.index=b.isSeparator?null:a,b.display=b.isSeparator?a:a+1,b}function h(b,c,e){_.isDefined(d[b])?a[b]=_.isFunction(e)?e(d[b]):d[b]:_.isDefined(c)&&(a[b]=c)}h("countDisplay",7,a.$eval),f(a.current),a.m={current:a.current},a.$watch("current + itemsTotal + itemsPerPage",function(){a.count=Math.ceil(a.itemsTotal/a.itemsPerPage),e(),f(a.current),a.m.current=a.current}),a.$watch("m.current",function(){a.current=a.m.current}),a.selectPage=function(b){_.isNumber(b)&&(a.current=b,a.onChange({$event:{pageNum:b}}))}}}}]).filter("page",function(){return function(a,b,c){if(c=parseInt(c,0),!_.isUndefined(a)){if(a.length<c)return a;var d=c*b,e=d+c;return a.slice(d,e)}}}),angular.module("summarize",[]).factory("summarize",function(){return function(a,b){b=_.firstDefined(b,{}),a=_.clone(a);var c=_.firstDefined(b.divideText,"..."),d=_.firstDefined(b.focus,0),e=_.firstDefined(b.displayCount,10),f=a.length;a.length-1;var g=0;if(e>f)return a;maxHalf=Math.floor(e/2),minHalf=Math.round(e/2);var h=Math.max(d-maxHalf,0),i=Math.min(d+minHalf,f);return h-=Math.max(minHalf-i+d,0),i+=Math.max(maxHalf-h-d,0),_array=a.slice(h,i),h>g&&_array.splice(0,2,_.first(a),c),f>i&&_array.splice(-2,2,c,_.last(a)),_array}}),angular.module("panel",["toggle"]).directive("panel",["$parse",function(a){return{templateUrl:"/parts/panel/panel-template.html",restrict:"EA",transclude:!0,require:"?toggle",replace:!0,scope:!0,link:function(b,c,d,e){if(b.close=void 0,d.hasOwnProperty("closeAction"))if(_.isEmpty(d.closeAction))b.close=e?function(){e.toggle(!1)}:function(){c.addClass("hidden")};else{var f=a(d.closeAction);b.close=function(){f(b)}}b.$on("modal.close",function(){b.close&&b.close()})}}}]),angular.module("payBillCsr",["config"]).directive("payBillCsr",["Config",function(){return{templateUrl:"/parts/pay-bill-csr/pay-bill-csr-template.html",link:function(){}}}]),angular.module("paybillsheader",["modal","panel","payBillResource","pbsucmsgs","pberrmsgs","payBillUtils","spinner","transferModal","moveTransferService"]).directive("paybillheader",["PayBillService","PayBillUtils","ooluser","$rootScope","MoveTransferService",function(a,b,c,d,e){return{restrict:"E",templateUrl:"/parts/pay-bill-header/pay-bill-header-template.html",link:function(c){function f(){a.getPaymentMethods({},j,q)}function g(){if(d.acctDetail){c.toAcctType=null;var b=utils.getObjInArrayByValue(d.acctDetail,"active",!0),e=b.accountType;"2"===e&&(c.toAcctType="0"),"3"===e&&(c.toAcctType="1");var f={};f.accountType=c.toAcctType,f.system="Portal",f.accountType&&a.getBPGlobal(f,h,i)}}function h(a){utils.handleSuccessfullResponse(a,c,{mandatory:!0})&&(c.toGlobalBP=a,d.dueAmount=a.amountDue,d.dueDate=a.dueDate,d.systemDate=a.systemDate,d.lastAmount=a.statementBalance,d.lastAmount&&(d.statements=!0))}function i(a){utils.handleSuccessfullResponse(a,c,{mandatory:!0})&&(console.log("in to acct global error"),utils.handleErrorResponse(model))}function j(a){var b=90;if(c.showSpinner=!1,d.isPaperBill=!1,null!==a.discoDate){if(c.disconnectDate=utils.parseDate(a.discoDate),c.pastAcctAvlDateFull=utils.addDays(c.disconnectDate,b),c.pastAcctAvlDateFull=utils.dateToString(c.pastAcctAvlDateFull),c.pastAcctAvlDateFull&&null!==c.pastAcctAvlDateFull){var e=c.pastAcctAvlDateFull.split("/").join(""),f=e.substring(0,2),g=e.substring(2,4),h=e.substring(6,8);c.showDate=f+"/"+g+"/"+h}c.tempDate=c.pastAcctAvlDateFull.split("/"),c.pastAcctAvlDate=c.tempDate[0]+"/"+c.tempDate[1]}c.pbDataLoaded=!0,c.ebillInfo=a,c.toAcctEbillInfo=utils.computeToAcctEbillInfo(c.ebillInfo),c.ebillInfo.ebillInformationOutputs.length>1?(c.isMoved=!0,c.movedAcctNumber=utils.formatAccountNumber(c.toAcctEbillInfo.accountNum),c.acctMovedText="Available until "+c.pastAcctAvlDate):c.acctMovedText="",c.toggleAccountHead()}function k(b){if(a.checkSuccess(b)){if(c.toggleAcctResponse=b,c.showAcctText=b.accounts.length?!0:!1,1===b.accounts.length)for(var e=0;e<b.accounts.length;e++)c.showAcctDropdown=!1,c.pageHasLoaded=!0,c.displayAccountNumber=utils.formatAccountNumber(b.accounts[e].accountNumber).toString();else if(Number(utils.getURLParameter("ppi")>0)){c.showAcctDropdown=!1,c.pageHasLoaded=!0;for(var f=0;f<b.accounts.length;f++)"0"===b.accounts[f].accountType&&(c.displayAccountNumber=utils.formatAccountNumber(b.accounts[f].accountNumber).toString())}else c.showAcctDropdown=!0,c.pageHasLoaded=!0;var h=-1;if(b.accounts.length&&!Number(utils.getURLParameter("ppi")>0))for(var i=0;i<b.accounts.length;i++)c.accounts=2===b.accounts.length?[b.accounts[0],b.accounts[1]]:[b.accounts[0],b.accounts[2],b.accounts[1],b.accounts[3]],b.accounts[i].active?(h=i,"0"===c.accounts[i].accountType||"1"===c.accounts[i].accountType?c.accounts.length>2?c.model.accountOptions[i]={label:{tv:c.hasTv?"onet-icons-tv-single tvIcon":"",phone:c.hasPhone?"onet-icons-phonet-single":"",internet:c.hasInternet?"onet-icons-internet-single":"",text:utils.formatAccountNumber(c.accounts[i].accountNumber),NewadditionalText:"Current",background:"false"},value:utils.formatAccountNumber(c.accounts[i].accountNumber)}:2===c.accounts.length&&(c.model.accountOptions[i]={label:{text:utils.formatAccountNumber(c.accounts[i].accountNumber),NewadditionalText:"Current",background:"false"},value:utils.formatAccountNumber(c.accounts[i].accountNumber)}):("0"!==c.accounts[i].accountType||"1"!==c.accounts[i].accountType)&&c.fromflag&&(c.accounts.length>2?c.model.accountOptions[i]={label:{tv:c.hasTv?"onet-icons-tv-single tvIcon":"",phone:c.hasPhone?"onet-icons-phone-single":"",internet:c.hasInternet?"onet-icons-internet-single":"",text:utils.formatAccountNumber(c.accounts[i].accountNumber),OldText:"Previous",FromadditionalText:c.acctMovedText,background:"true"},value:utils.formatAccountNumber(c.accounts[i].accountNumber)}:2===c.accounts.length&&(c.model.accountOptions[i]={label:{text:utils.formatAccountNumber(c.accounts[i].accountNumber),OldText:"Previous",FromadditionalText:c.acctMovedText,background:"true"},value:utils.formatAccountNumber(c.accounts[i].accountNumber)}))):"0"===c.accounts[i].accountType||"1"===c.accounts[i].accountType?c.accounts.length>2?c.model.accountOptions[i]={label:{tv:c.hasTv?"onet-icons-tv-single tvIcon":"",phone:c.hasPhone?"onet-icons-phone-single":"",internet:c.hasInternet?"onet-icons-internet-single":"",text:utils.formatAccountNumber(c.accounts[i].accountNumber),NewadditionalText:"Current",background:"false"},value:utils.formatAccountNumber(c.accounts[i].accountNumber)}:2===c.accounts.length&&(c.model.accountOptions[i]={label:{text:utils.formatAccountNumber(c.accounts[i].accountNumber),NewadditionalText:"Current",background:"false"},value:utils.formatAccountNumber(c.accounts[i].accountNumber)}):("0"!==c.accounts[i].accountType||"1"!==c.accounts[i].accountType)&&c.fromflag&&(c.accounts.length>2?c.model.accountOptions[i]={label:{tv:c.hasTv?"onet-icons-tv-single tvIcon":"",phone:c.hasPhone?"onet-icons-phone-single":"",internet:c.hasInternet?"onet-icons-internet-single":"",text:utils.formatAccountNumber(c.accounts[i].accountNumber),OldText:"Previous",FromadditionalText:c.acctMovedText,background:"true"},value:utils.formatAccountNumber(c.accounts[i].accountNumber)}:2===c.accounts.length&&(c.model.accountOptions[i]={label:{text:utils.formatAccountNumber(c.accounts[i].accountNumber),OldText:"Previous",FromadditionalText:c.acctMovedText,background:"true"},value:utils.formatAccountNumber(c.accounts[i].accountNumber)}));d.acctDetail=b.accounts;var j=utils.getObjInArrayByValue(d.acctDetail,"active",!0);c.activeAcctNum=j.accountNumber,model.account=utils.formatAccountNumber(c.activeAcctNum),c.activeAcctEbillInfo=utils.computeActiveAcctEbillInfo(j.accountNumber,c.ebillInfo),c.acctType=j.accountType,("2"===c.acctType||"3"===c.acctType)&&g(),d.isPaperBill=c.activeAcctEbillInfo&&c.activeAcctEbillInfo.isPaperBill?!0:!1,c.activeAcctEbillInfo&&c.activeAcctEbillInfo.email&&$("#emailInputPBill").val(c.activeAcctEbillInfo.email),c.activeAcctEbillInfo.isFrom&&(d.showMakeSection=!1),l()}}function l(){a.getPaymentMethods({},m,n)}function m(a){c.ebillInfo=a,o()}function n(){c.showSpinner=!1}function o(){y.init(),console.log("Inside transfer modal handler"),c.moveTransferService.setEBillResponse(c.ebillInfo),c.isServiceAvailable=y.isServiceAvailable(),c.isModalNeeded=y.isModalNeeded(),d.isGetStartedClicked&&(c.isModalNeeded=!0),c.isModalNeeded&&(console.log("If is modal needed then inside transfer modal transfer"),y.updateTransferData())}function p(){c.showSpinner=!1}function q(){c.showSpinner=!1}function r(b){b.mailNotifyInd=!0,b.paperBillInd=!0,utils.clearAllMessages(model),a.updateCommunication(b,s,t)}function s(a){c.showSpinner=!1,utils.handleSuccessfullResponse(a,c,{scroll:"header"})&&(c.emailupdate?(c.emailupdate=!1,c.activeAcctEbillInfo.isPaperBill!==model.allowEmail?(data={},data.email=$("#emailInputPBill").val(),r(data)):(model.popupSuccessMsg="Details updated successfully",d.isPaperBill=!1)):(model.successMsg="Congrats!  You have successfully enrolled in paperless billing.<br>Notifications about your account and new statements will be sent to&nbsp"+data.email+".",utils.addSuccessToAlerts(c,"Congrats!  You have successfully enrolled in paperless billing.<br>Notifications about your account and new statements will be sent to&nbsp"+data.email+"."),c.paperlessBilling(!1),d.isPaperBill=!1)),c.showAlert=!0}function t(){c.showSpinner=!1}function u(b){if(utils.handleSuccessfullResponse(b,c,{noClear:!0})){c.globalBP=b,c.toAcctType="0";var e={};e.accountType=c.toAcctType,e.system="Portal",e.accountType&&a.getBPGlobal(e,w,x),d.systemDate=b.systemDate,d.dueAmount=b.amountDue,d.dueDate=b.dueDate,d.lastAmount=b.statementBalance,d.lastAmount&&(d.statements=!0),f(),b.csrId&&(c.csrId=!0)}}function v(){utils.handleErrorResponse(model)}function w(){}function x(){utils.handleErrorResponse(model)}c.model.paperless=!1,c.model.showCancel=!1,c.enrollClicked=!1,c.currentAccountNumber="",c.displayAccountNumber="",c.csrId=!1,c.model.changed=!1,c.showSpinner=!1,utils=b,c.showAcctDropdown=!1,c.model.accountOptions=[],c.disconnectDate="",c.isMoved=!1,c.acctMovedText="",c.fromflag=!0,c.accountNumber=[],d.showMakeSection=!0,d.showOptOut=!0,c.acctType=null,c.$watch("model.account",function(a){0===a||1===a||2===a||3===a?(model.account=c.model.accountOptions[a].label.text,d.accountNoSelected=model.account):d.accountNoSelected=model.account}),d.$watch("isGetStartedClicked",function(a,b){console.log("isGetStartedClicked newval: "+a+"oldVal: "+b),a&&(d.isGetStartedClicked=!0,l())}),c.enrollCheck=function(){return c.model?!c.model.allowEnroll:!0},c.paperlessOption=function(){$("#emailInputPBill").val()===c.activeAcctEbillInfo.email?c.model.paperless=!1:c.model.paperLessCancel=!0},c.togglePaperCancel=function(a){c.model.paperLessCancel=a?!1:!0},c.checkForCancelPopup=function(){c.isIntlPostPaid?history.go(-1):utils.isPrevDomainSame()?history.go(-1):window.location.href="/pay-bill"},c.checkCancel=function(){c.model.changed?c.model.showCancel=!0:utils.isPrevDomainSame()?history.go(-1):window.location.href="/pay-bill"},c.toggleCancel=function(a){c.model.showCancel=a?!0:!1},c.paperlessBilling=function(a){$("#emailInputPBill").val(c.activeAcctEbillInfo.email),$("#emailInputPBill").removeClass("error-input"),$("#headerEmailError").addClass("hidden"),a?c.model.paperless=!0:(c.model.paperless=!1,c.model.paperLessCancel=!1)},d.isPaperBill=!1,c.pbDataLoaded=!1,d.$watch("acctDetail",function(){g()}),c.toggleAccountHead=function(){c.acctType?a.toggleAccount(k,p,c.acctType):a.toggleAccount(k,p)},c.emailupdate=!1,c.enrollPaperBill=function(){c.showSpinner=!0,c.enrollClicked=!0,data={},data.email=$("#emailInputPBill").val(),data.origMailNotifyInd=c.activeAcctEbillInfo.mailNotifyInd,data.origPaperBillInd=c.activeAcctEbillInfo.isPaperBill,data.origEmail=c.activeAcctEbillInfo.email,data.mailNotifyInd=!0,data.paperBillInd=!1,a.updateCommunicationNew(data,s,t)
},c.getGlobalPB=function(){a.getBPGlobal({},u,v)},$("#emailInputPBill").live("focusout",function(){utils.isEmail(this.value)?$("#headerEmailError").addClass("hidden"):$("#headerEmailError").removeClass("hidden")}),$("#emailInputPBill").live("keyup",function(){utils.isEmail(this.value)?(c.$apply(function(){c.enrollClicked=!1}),$("#emailInputPBill").removeClass("error-input"),$("#headerEmailError").addClass("hidden")):(c.$apply(function(){c.enrollClicked=!0}),$("#emailInputPBill").addClass("error-input"),$("#headerEmailError").removeClass("hidden"))});var y=function(){function a(){c.modalNeeded=!1,c.moveTransferService=e,c.moveTransferService.displayModal=!1}function b(){if(c.ebillInfo&&c.ebillInfo.ebillInformationOutputs){for(var a,b=!1,d=!1,e=!1,f=!1,g=0;g<c.ebillInfo.ebillInformationOutputs.length;g++)a=c.ebillInfo.ebillInformationOutputs[g],a.isFrom?(b=a.paymentMethods.length>0,f=a.manualBlockInd||a.classCodeInd):(d=a.paymentMethods.length>0,e=a.manualBlockInd||a.classCodeInd);if(b&&!d&&!e&&!f&&1!==c.ebillInfo.mtAknowInd)return!0}return!1}function f(){var a=!0;if(!c.isServiceAvailable)return!1;if(d.acctDetail)for(var b=0;b<d.acctDetail.length;b++)if("1"===d.acctDetail[b].accountType||"3"===d.acctDetail[b].accountType)return d.showOptOut=!1,!1;if(!c.getStartedFlag&&(c.ebillInfo&&0===c.ebillInfo.apOptOut||0===c.ebillInfo.pmOptOut))return!1;var e=utils.get_cookie("remind_later");return e?(console.log("Remind eme later value is set"),!1):a}function g(){c.responseModal=c.moveTransferService.getEbillResponse(),utils.computeDaysRemaining(h,c.disconnectDate,c.systemDate),c.showTransferModal=!0}var h=90;return{init:a,isServiceAvailable:b,isModalNeeded:f,updateTransferData:g}}();c.getGlobalPB()}}}]),angular.module("pinInput",["keyEvents"]).directive("pinInput",[function(){return{replace:!1,require:"ngModel",scope:!0,template:'<span ng-switch="isMobile">  <span ng-switch-when="true">    <input type="password"      ng-model="mobileDigits.value"      ng-change="mobileChange(mobileDigits.value)"      maxlength="4"    />  </span>  <span ng-switch-when="false">    <input type="password"      ng-model="digit.value"      ng-repeat="digit in digits"      class="short input pin-input"      on-keydown="keyDown($event, $index)"      ng-change="change($index, digit.value)"      maxlength="1"    />  </span></span>',link:function(a,b,c,d){function e(a){angular.isUndefined(g)&&(g=b.find("input")),$(g[a]).focus()}function f(a){return angular.isUndefined(a)||""===a||null===a||a!==a}var g;a.digits=[{},{},{},{}],a.mobileDigits={},a.isMobile=isMobile(),d.$render=function(){var b;angular.isString(d.$viewValue)?(b=angular.extend(["","","",""],d.$viewValue.split("")),_.each(a.digits,function(a){a.value=b.shift()}),a.mobileDigits.value=d.$viewValue):(_.each(a.digits,function(a){a.value=""}),a.mobileDigits.value="")},a.keyDown=function(b,c){8===b.keyCode&&c>0&&""===a.digits[c].value&&(a.digits[c-1].value="",e(c-1))},a.change=function(b,c){a.mobileDigits.value=_.reduce(a.digits,function(a,b){return b.value=b.value.replace(/\D/g,""),a+b.value},""),d.$setViewValue(a.mobileDigits.value),b<a.digits.length-1&&c.match(/\d/)&&e(b+1)},a.mobileChange=function(b){angular.isString(b)&&""!==b?(digits=angular.extend(["","","",""],b.split("")),_.each(a.digits,function(a){a.value=digits.shift()})):_.each(a.digits,function(a){a.value=""}),d.$setViewValue(b)};var h,i=c.ngPattern,j=function(a,b){return f(b)||a.test(b)?(d.$setValidity("pattern",!0),b):(d.$setValidity("pattern",!1),void 0)};i&&(i.match(/^\/(.*)\/$/)?(i=new RegExp(i.substr(1,i.length-2)),h=function(a){return j(i,a)}):h=function(b){var c=a.$eval(i);if(!c||!c.test)throw new Error("Expected "+i+" to be a RegExp but was "+c);return j(c,b)},d.$formatters.push(h),d.$parsers.push(h))}}}]),angular.module("pins",[]).directive("pin",["$interpolate",function(a){return{restrict:"C",scope:!0,templateUrl:"/parts/pins/pin-template.html",link:function(b,c,d){b.content=null,d.$observe("content",function(c){c&&(b.content=a(c)(b))})}}}]).directive("pinHalo",["$interpolate",function(a){return{restrict:"C",scope:!0,templateUrl:"/parts/pins/pin-halo-template.html",link:function(b,c,d){b.content=null,d.$observe("content",function(c){c&&(b.content=a(c)(b))})}}}]).directive("pinImage",["$interpolate",function(a){return{restrict:"C",scope:!0,transclude:!0,templateUrl:"/parts/pins/pin-image-template.html",link:function(b,c,d){b.content=null,d.$observe("content",function(c){c&&(b.content=a(c)(b))})}}}]),angular.module("platformPlayerTutorial",[]).directive("platformPlayerTutorial",function(){return{restrict:"EA",scope:!0,transclude:!0,replace:!1,templateUrl:"/parts/platform-player-tutorial/platform-player-tutorial-template.html",link:function(a,b){var c=a;c.guid||"";var d=function(a){var b=_.uniqueId(a);return b},e=c.playerId||d("p"),f=c.releaseListId||d("rl"),g=c.releaseModelId||d("rm");d("s"),c.playerId=e,c.releaseListId=f,c.releaseModelId=g,c.isActive=function(){return c.tutorialViewCtrl.isCurrentRow(c.drawerRowID)&&c.drawerRowModel.currentItemSelected},c.$watch("tutorialViewCtrl.isCurrentRow(drawerRowID)",function(){var a=c.tutorialViewCtrl.isCurrentRow(c.drawerRowID);a?$("#singularPlatformPlayer").appendTo(b):c.drawerRowModel.currentItemSelected=null}),c.$watch("drawerRowModel.currentItemSelected",function(){return c.isActive()?(c.guid=c.drawerRowModel.currentItemSelected.guid,$("#singularPlatformPlayer").scope().autoplay=!0,$("#singularPlatformPlayer").scope().guid=c.guid,void 0):(c.guid=null,!c.drawerRowModel.currentItemSelected&&c.tutorialViewCtrl.isCurrentRow(c.drawerRowID)&&($("#singularPlatformPlayer").scope().guid=c.guid),void 0)})}}}),angular.module("platformPlayer",[]).directive("platformPlayer",function(){return{restrict:"E",scope:{guid:"=",autoplay:"=",playerId:"=",releaseListId:"=",releaseModelId:"="},transclude:!0,replace:!1,templateUrl:"/parts/platform-player/platform-player-template.html",link:function(a){a.hashstring=function(){return(a.autoplay?"autoplay|":"")+a.guid},a.$watch("guid",function(){a.iframeURL=a.guid?"/parts/platform-player/platform-player-iframe.html#"+a.hashstring():"about:blank"})}}}),angular.module("poster",["if","ngSanitize","imgAlt"]).directive("poster",[function(){return{restrict:"EA",replace:!0,template:'<div class="poster">  <div img-alt no-autosize url="{{posterModel.url}}" is-fallback="true">    <div class="poster__fallback-text" ng-bind-html="posterModel.title"></div>  </div></div>',scope:!0,link:function(a,b,c){a.posterModel={},a.posterModel.noImage="No Image Found";var d,e,f;c.$observe("type",function(a){d=a}),c.$observe("types",function(a){f=a}),c.$observe("label",function(b){e=b,"Genre"===d||"Phrase"===d||"Personality"===d||"Concept"===d||"Music Artist"===d||"Artist"===d||"Channel Collection"===d||"Player"===d||"Team"===d||"Language"===d||"Collection"===d||"Channel"===d?(console.log("in title",d+": "+e),a.posterModel.title=d+": "+e):a.posterModel.title="Genre"===f||"Phrase"===f||"Personality"===f||"Concept"===f||"Music Artist"===f||"Artist"===f||"Channel Collection"===f||"Player"===f||"Team"===f||"Language"===f||"Collection"===f||"Channel"===f?f+": "+e:e+"<br>"+"(No Image Found)"}),c.$observe("url",function(b){"Genre"===d||"Phrase"===d||"Personality"===d||"Concept"===d||"Music Artist"===d||"Artist"===d||"Channel Collection"===d||"Player"===d||"Team"===d||"Language"===d||"Collection"===d||"Channel"===d?(a.posterModel.url=null,a.posterModel.title=d+": "+e):"Genre"===f||"Phrase"===f||"Personality"===f||"Concept"===f||"Music Artist"===f||"Artist"===f||"Channel Collection"===f||"Player"===f||"Team"===f||"Language"===f||"Collection"===f||"Channel"===f?(a.posterModel.url=null,a.posterModel.title=f+": "+e):a.posterModel.url=b})}}}]),function(){function a(a){return new b(a)}function b(a){return this.options=_.defaults(a,{mayLoop:!0}),this.options.lowerLimit=0,this.currentIndex=0,this}function c(a,b,c){return a>c?a:c>b?b:c}angular.module("queue",[]).factory("queue",function(){return a}),b.prototype.next=function(){return this.move(1),this},b.prototype.previous=function(){return this.move(-1),this},b.prototype.goto=function(a){return this.currentIndex=c(this.options.lowerLimit,this.options.upperLimit,a),this},b.prototype.length=function(){return this.options.upperLimit+1},b.prototype.remove=function(a){function b(a){return a>c.options.upperLimit||a<c.options.lowerLimit}var c=this;return b(a)?!1:1===this.length()?(this.currentIndex=null,this.options.upperLimit=null,this):((a===this.options.upperLimit&&this.currentIndex===this.options.upperLimit||a<this.currentIndex)&&(this.currentIndex-=1),this.options.upperLimit-=1,this)},b.prototype.move=function(a){function b(a){return a>f.options.upperLimit?a-f.options.upperLimit:a<f.options.lowerLimit?Math.abs(a):0}function d(a){switch(a){case"-":return f.options.upperLimit;case"+":return f.options.lowerLimit;default:throw a+" is not a valid direction! Should be - for backward or + for forward"}}function e(a,b,c){switch(a){case"+":return b+c;case"-":return b-c}}var f=this;if(0===a)return this;if(!this.options.mayLoop)return this.currentIndex=c(this.options.lowerLimit,this.options.upperLimit,this.currentIndex+a),this;var g=Math.abs(a),h=a>0?"+":"-",i=Math.floor(g/(this.options.upperLimit+1)),j=(this.options.upperLimit+1)*i,k=g-j,l=e(h,this.currentIndex,k),m=b(l);return m&&(l=e(h,d(h),m-1)),this.currentIndex=l,this}}(),angular.module("radio",[]).directive("radio",["$parse",function(){return{restrict:"C",replace:!0,transclude:!0,scope:!0,template:["<div",' ng-class="{'," 'is-checked': radioButton.checked,"," 'not-checked': !radioButton.checked",' }"',">",'<div class="radio-inner" ng-transclude></div>',"</div>"].join(""),link:function(a,b){var c=angular.element(b).find(":input")[0];angular.element(c).hide(),angular.element(b).on("click",function(){c.click()}),a.radioButton=c}}}]),angular.module("recordingExpandable",[]).directive("recordingExpandable",["$parse",function(a){return{restrict:"E",scope:!0,templateUrl:"/parts/recording-expandable/recording-expandable-template.html",controller:["$scope","$attrs",function(b,c){var d={isOpen:!1,isDisabled:!1};b.toggleExpandable=function(){d.isDisabled||(d.isOpen=!d.isOpen)},b.$watch(a(c.disabled),function(a){d.isDisabled=Boolean(a)}),b.expandable=d}]}}]),angular.module("reportingTools",[]).factory("ReportingEvents",[function(){return{ResetPassword:{Load:{events:"event5"},SendMethod:{events:"event6"},SecurityQuestions:{events:"event7"},EnterNewPassword:{events:"event8"},End:{events:"event9"}},call:function(a){reporting.mixin(a),reporting.call()}}}]).directive("reportingClick",[function(){return{restrict:"A",scope:!0,link:function(a,b,c){$(b).click(function(){var b=a.$eval(c.reportingClick);"object"==typeof b&&(reporting.mixin(b),reporting.click())})}}}]),angular.module("scrollPagination",[]).directive("scrollPagination",[function(){return{transclude:!0,template:"<div ng-transclude></div>",scope:{list:"=list",scrollPagination:"=scrollPagination"},link:function(a,b){function c(){if(e.pageSize<0)e.head=0,e.foot=0;else{var c=b.scrollTop();e.head=Math.max(Math.floor(c/e.height)-(e.extraHead||0),0),e.foot=Math.max((angular.isArray(a.list)?a.list.length:0)-e.head-e.pageSize,0)}}var d,e=a.scrollPagination;a.$watch("list.length",function(){b.scrollTop(0),c()}),a.$watch("scrollPagination.pageSize",c),b.on("scroll",function(){try{clearTimeout(d)}catch(b){}d=setTimeout(function(){a.$apply(c)},40)}),c()}}}]),angular.module("scrollbarWidth",[]).factory("scrollbarWidth",[function(){var a,b,c=$(document.createElement("div")).css({overflowY:"scroll",width:"100px",position:"absolute",top:"-1000px",left:"-1000px"}).append(b=$(document.createElement("div")));return $("body").append(c),a=100-b.width(),c.remove(),a}]),angular.module("sheetdate",["toggle","isViewportSize"]).directive("sheetdate",["$window","$parse","isViewportSize",function(a,b,c){return{restrict:"EA",require:"?toggle",transclude:!0,replace:!0,templateUrl:"/parts/sheet-date/sheet-date-template.html",link:function(d,e,f,g){var h=function(a){if(a&&3===a.split("/").length){year=a.split("/")[2],2===a.split("/")[2].length&&(year=parseInt(String((new Date).getFullYear()).substring(0,2)+year,10));var b=new Date(year,parseInt(a.split("/")[0],10)-1,parseInt(a.split("/")[1],10));return b.setHours(0,0,0,0),b}return null},i=null,j=null,k=null;if(c.phone){d.$watch("startDate",function(a){var b=h(a);b&&(i=b),k&&k.datepicker("setStartDate",i)}),d.$watch("endDate",function(a){var b=h(a);b&&(j=b),k&&k.datepicker("setEndDate",j)}),d.$watch(f.toggle,function(b){if(Boolean(b)&&3===d.dropdown.currentOption.split("/").length){var c=d.dropdown.currentOption.replace("///g","-"),e=c;k.data({date:e}).datepicker("update").children("input").val(e)}$(a.document.body).toggleClass("is-sheet-mode",Boolean(b))});var l=".ddPickerMobi";k||(k=e.find(l).datepicker(),i&&k.datepicker("setStartDate",i),j&&k.datepicker("setEndDate",j),k.show(),k.on("changeDate",function(a){d.dropdown.updateDate(a.format)}))}var m={title:"",closeLabel:""};f.$observe("sheetTitleText",function(a){m.title=a}),f.$observe("sheetCloseText",function(a){m.closeLabel=a||"Back"}),d.sheet=m,d.sheetCloseAction=b(f.sheetCloseAction)(d)||g.toggle}}}]),angular.module("sheet",["toggle"]).directive("sheet",["$window","$parse",function(a,b){return{restrict:"A",require:"?toggle",transclude:!0,scope:!0,replace:!0,template:'<div class="sheet">  <div class="sheet__inner">    <header class="sheet__head theme--primary" ng-show="sheet.title">      <div class="container">        <div class="hbeam full-width text-unspace vpadding-s">          <div class="align-middle">            <h1 ng-bind="sheet.title"></h1>          </div>          <div class="align-right align-middle">            <button class="btn btn--heading" ng-bind="sheet.closeLabel" ng-click="sheetCloseAction()"></button>          </div>        </div>      </div>    </header>    <div class="sheet__body container vpadding-m" ng-transclude>    </div>  </div></div>',link:function(c,d,e,f){function g(b){var c,d=$(a.document.documentElement),e=$(a.document.body),f=!1,g=!1;b!==!0||d.is(".is-sheet-mode")?b===!1&&d.is(".is-sheet-mode")&&k&&(f=!0,e.css("height",""),d.toggleClass("is-sheet-mode",b)):(j.top=e.scrollTop(),j.left=e.scrollLeft(),g=!0,k=!0,d.toggleClass("is-sheet-mode",b)),f?a.scrollTo(j.left,j.top):g&&(c=e.height())<a.outerHeight&&e.height(c+50)}function h(a){_.contains(l,a)&&(i.animateToward=a,d.removeClass(m).addClass("sheet--anim-"+a))}var i={title:e.sheetTitleText||"",closeLabel:e.sheetCloseText||"",animateToward:""},j={},k=!1;e.$observe("sheetTitleText",function(a){i.title=a}),e.$observe("sheetCloseText",function(a){i.closeLabel=a||"Back"}),c.sheetCloseAction=b(e.sheetCloseAction)(c)||f.toggle,c.$watch(e.toggle,function(a){g(Boolean(a))}),c.$on("$destroy",function(){g(!1)});var l=["top","right","bottom","left"],m="sheet--anim-top sheet--anim-right sheet--anim-bottom sheet--anim-left";h(e.animateToward||"right"),e.animateToward&&c.$watch(i.animateToward,h),c.sheet=i,window.sheet=i}}}]),angular.module("showBusy",["spinner"]).directive("showBusy",[function(){return{transclude:!0,templateUrl:"/parts/show-busy/show-busy-template.html",scope:{showBusy:"="}}}]).directive("hideBusy",[function(){return{transclude:!0,templateUrl:"/parts/show-busy/hide-busy-template.html",scope:{hideBusy:"="}}}]),angular.module("showOnSuccess",[]).directive("showOnSuccess",["$http","$q",function(a,b){function c(a){return a.status>=200&&a.status<300}return function(d,e,f){f.$observe("showOnSuccess",function(d){angular.isString(d)&&""!==d?(e.hide(),a.get(d,{cache:!0}).then(function(a){return c(a)?a:b.reject(a)}).then(function(){e.show()},function(){e.hide()})):e.hide()})}}]),angular.module("slideToggle",[]).directive("slideToggle",[function(){return{restrict:"A",replace:!0,scope:{setState:"=",setLabel:"=",onEvent:"&"},templateUrl:"/parts/slide-toggle/slide-toggle-template.html",link:function(a,b,c){if(c.id,a.setLabel)var d=a.setLabel[0],e=a.setLabel[1];var f=function(){void 0===d&&(d="On"),void 0===e&&(e="Off");var a="";a=e.length>d.length?e.length:d.length,a>3?b.addClass("lrgtoggle"):b.addClass("smltoggle")};f()}}}]),angular.module("spinner",[]).directive("spinner",[function(){var a={lines:17,lineLength:13,width:2,radius:22,corners:0,rotate:24,color:"#000",speed:1.6,trail:10,shadow:!1,hwaccel:!1,zIndex:999};return{restrict:"EA",replace:!0,template:'<div class="spinner-container" style="box-sizing:content-box;position:relative;"></div>',link:function(b,c,d){var e={};_.each(a,function(a,c){c="lineLength"===c?"length":c,e[c]=_.firstDefined(b.$eval(d[c]),a)}),new Spinner(e).spin(c[0]);var f=2*e.length+2*e.radius+2*e.width;c.width(f).height(f).children().css({top:0,left:0,marginTop:"50%",marginLeft:"50%"})}}}]),angular.module("stickyStack",[]).directive("stickyStack",["$window",function(a){function b(a,b){c[b].push(a),c[b].sort(function(a,c){var d="top"===b?a:c,e="top"===b?c:a;return d.parent().offset().top-e.parent().offset().top})}var c={top:[],bottom:[]},d={direction:"down",viewport:"top",stickyClassNames:"is-sticky",stopAt:!1};return{scope:!0,link:function(e,f,g){function h(){if(o.stopAt){var a=$(o.stopAt).offset().top,b=m();if("top"===o.viewport&&(a-=f.outerHeight(),a-=n()),b>=a){var c=b-a;"top"===o.viewport&&(c*=-1),f.css(o.cssSide,n()+c)}else j(k())}else j(k())}function i(){var a=f.is(":visible")?f.outerHeight():0;f.parent().height(a)}function j(a){cssRules={},cssRules[o.cssSide]=a?n():"",cssRules.position=a?"fixed":"",f.css(cssRules),f.toggleClass(o.stickyClassNames,a)}function k(){return l()<=m()}function l(){var a=f.parent().offset().top;return"bottom"===o.viewport&&(a+=f.outerHeight()),a-=n()}function m(){var b=$(a).scrollTop();return"bottom"===o.viewport&&(b+=$(a).height()),b}function n(){var a=_(_.initialUntilItem(c[o.viewport],f));return a.filter(function(a){return a.hasClass("is-sticky")}).reduce(function(a,b){return a+b.outerHeight()},0)}var o=_.defaults({},e.$eval(g.stickyStack),d);o.cssSide={top:"top",bottom:"bottom"}[o.viewport],f.wrap('<div class="sticky-wrapper"/>'),b(f,o.viewport),i(),f.on("resize",i),$(a).on("scroll",function(){h()}),$(a).on("resize",function(){h()}),$(a).on("touchmove",function(){h()})}}}]),angular.module("sticky",[]).directive("sticky",["$window",function(){return{scope:!0,link:function(a,b,c){function d(){var a=b.is(":visible")?b.outerHeight():0;b.parent().height(a)}function e(){function d(a){switch(a){case"0%":case 0:return"sticky--top";case"bottom-in-view":return"sticky--bottom";default:return""}}var e={direction:"down",offset:0,handler:function(a){b.toggleClass(g,a===f.direction)}},f=_.defaults({},a.$eval(c.sticky),e),g="is-sticky "+d(f.offset);return f}b.waypoint("sticky",e()),d(),b.on("resize",d)}}}]),angular.module("pbsucmsgs",[]).directive("successmsg",[function(){return{restrict:"E",templateUrl:"/parts/success-msg/success-msg-template.html",scope:{message:"@message",show:"@show"},link:function(){}}}]),angular.module("textCurrency",[]).directive("textCurrency",[function(){return{restrict:"C",link:function(a,b){$(b).live("keydown",function(a){var b=a.ctrlKey||a.metaKey;switch(a.keyCode){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 8:case 37:case 39:case 46:case 32:case 9:case 190:case 110:if(a.shiftKey)return 52===a.keyCode?void 0:(a.preventDefault(),a.stopPropagation(),!1);break;case 67:case 86:case 88:if(b)return;return a.preventDefault(),a.stopPropagation(),!1;default:if(a.shiftKey&&52===a.keyCode)return;return a.preventDefault(),a.stopPropagation(),!1}})}}}]).directive("currencyValidate",[function(){return{restrict:"C",require:"?ngModel",link:function(a,b,c,d){function e(a){if(a){var b=0;if(a=String(a),a=a.replace(/\s/g,""),a.split("$").length>0&&(a=a.split("$").join("")),-1===a.indexOf(".")){if(!isNaN(a)&&(b=parseInt(a,10),b>=1&&1e4>b))return!0}else if(a.split(".")&&2===a.split(".").length&&!isNaN(a.split(".")[0])&&!isNaN(a.split(".")[1])&&a.split(".")[1].length<3&&(b=parseFloat(a,2),b>=1&&1e4>b))return!0}return!1}function f(a){return a&&(a=String(a),a=a.replace(/^\s+|\s+$/g,""),a=a.replace("$",""),a=a.replace(/^[0]+/g,""),""!==a&&("."===a&&(a="0"),a="0"===a||isNaN(Math.abs(parseFloat(a)))?0:Math.abs(parseFloat(a)).toFixed(2)),"0.00"===a&&(a=0),a&&a.length>0&&"$"!==a[0])?"$"+a:""}function g(a){$(a).removeClass("error-input"),e(a.value)||$(a).addClass("error-input")}$(b).on("blur",function(){this.value=f(this.value),g(this)}).on("keyup",function(){g(this)}),d.$formatters.push(f)}}}]),angular.module("textNumber",[]).directive("textNumber",[function(){return{restrict:"C",link:function(a,b,c){$(b).live("keydown",function(a){var b=a.ctrlKey||a.metaKey,d=a.which||a.keyCode||a.charCode;switch(console.log(d),d){case 32:if(console.log("space pressed;;;"+c.noSpace),c.noSpace)return!1;return;case 8:case 37:case 39:case 46:case 9:return;case 67:case 86:case 88:if(b)return;break;default:if(d>=48&&57>=d&&!a.shiftKey||d>=96&&105>=d||a.shiftKey&&52===d)return}return!1})}}}]),angular.module("toggle",[]).directive("toggle",["$parse",function(a){return{scope:!0,controller:["$scope","$attrs","$element",function(b,c,d){function e(a){a=Boolean(a),g.render(a),f(a)}function f(a){d.toggleClass(h.TRUE,a).toggleClass(h.FALSE,!a)}var g=this,h={TRUE:"is-toggle",FALSE:"not-toggle"};g.render=_.noop,g.isToggle=function(){return Boolean(a(c.toggle)(b))},g.toggle=function(d){var f=a(c.toggle);d=_.toggle(f(b),d),f.assign?(f.assign(b,d),e(d)):(c.$set("toggle",d),e(d))},b.$watch(c.toggle,e)}]}}]),angular.module("toolTip",[]).directive("toolTip",[function(){return{templateUrl:"/parts/tool-tip/tool-tip-template.html",link:function(){}}}]),$(document).ready(function(){var a=$("#site-wrapper"),b=300;$("#menubutton").toggle(function(){-1!==window.location.href.indexOf("service-appointments")?a.css("position","relative"):a.css({position:"absolute"}),a.animate({right:"83%"},b)},function(){a.css({position:"none"}),a.animate({right:"0%"},b)})}),angular.module("bottomDefault",["payBillUtils","config","oolCookie"]).controller("BottomDefaultCtrl",["$rootScope","$scope","PayBillService","PayBillUtils","Config","ooluser",function(a,b,c,d,e,f){var g=this,h="",i={LOGIN:"/login/"};g.hasSession=!1,g.showingMobileMenu=!1,g.primary=!1,g.optimumId="",g.helloMessage={text:"",link:""},g.hasService={tv:!1,internet:!1,phone:!1,dvr:!1},g.badge={tv:!1,internet:!1,phone:!1},g.toggleshowSignOut=function(){g.showSignOut=!g.showSignOut},g.webmailLink="#",g.phoneLink="#",g.currentAlertIndex=0;var j=function(){return-1===window.location.pathname.indexOf("login")?"?referer="+escape(window.location.href):""},k=function(a){var b=g.hasService;for(var c in a)b[c]=a[c]},l=function(a){g.showingMobileMenu=a},m=function(a){var b=g.helloMessage;b.text=a.text,b.link=a.link,b.link=g.hasSession?"#":"/login/"},n=function(a){var b=g.badge;for(var c in a)b[c]=a[c]},o=function(a){g.webmailLink=a.webmail,g.phoneLink=a.phone,g.outageLink=a.outage,h=a.signout};g.toggleshowSignOut=function(){g.showSignOut=!g.showSignOut},g.handleUserSignout=function(){var a=h+j();window.location=a};var p={MILLI_TO_SECONDS:1e3,SECONDS_IN_HOUR:3600},q=function(a){var b=!1,c=e.getValuesBySelector("cookie.expirationTimeToCheck"),d=(new Date).getTime(),f=d/p.MILLI_TO_SECONDS,g=f-a,h=Math.round(g/p.SECONDS_IN_HOUR);return h>=c&&(b=!0),b};g.forward=function(){var a=q(f.t);if(!g.hasSession||a){var b=i.LOGIN+"?referer="+escape("/pay-bill");console.log("redirecting"+b),window.location=b}else r()};var r=function(){if(b.toAcctType=null,a.acctDetail){var e=d.getObjInArrayByValue(a.acctDetail,"active",!0),f=e.accountType;"2"===f&&(b.toAcctType="0"),"3"===f&&(b.toAcctType="1")}c.toggleAccount(s,u,b.toAcctType)},s=function(a){c.checkSuccess(a)?window.location="/pay-bill/":r()},t=function(a){var b=document.createElement("script");b.type="text/javascript",window.google_conversion_id=a,window.google_custom_params=window.google_tag_params,window.google_remarketing_only=!0,b.src="//www.googleadservices.com/pagead/conversion.js",document.body.appendChild(b),window.google_trackConversion({google_conversion_id:a,google_custom_params:{parameter1:window.google_tag_params},google_remarketing_only:!0}),$("body").append("<noscript><div style='display:inline;'><img height='1' width='1' style='border-style:none;' alt='' src='//googleads.g.doubleclick.net/pagead/viewthroughconversion/"+a+"/?value=0&amp;guid=ON&amp;script=0'/></div></noscript>")};f.hasOOLSession&&(t(970019091),t(1025550508),t(1023380598),t(979385981),t(984947360),t(1040188944),t(1012423419));var u=function(a,b){if(console.log("in error"),a&&401===b){var c="";c=g.hasSession?"/pay-bill":i.LOGIN+"?referer="+escape("/pay-bill"),window.location=c}};return a.$on("mobileMenuDisplayToggle",function(a,b){g.hasSession=b.hasSession,g.optimumId=b.optimumId,g.mobileOutageStatus=b.mobileOutageStatus,g.mobileOutageclassName=b.mobileOutageclassName,g.mobileOutageIcon=b.mobileOutageIcon,g.mobileOutageMessage=b.mobileOutageMessage,k(b.hasService),g.primary=f.primary,l(b.showingMobileMenu),m(b.helloMessage),n(b.badge),o(b.link)}),b.seleniumMarker="BottomDefaultCtrl in bottom-default.js loaded!",b.BottomDefaultCtrl=g}]),angular.module("transcludeTemplates",[]).factory("transcludeTemplates",[function(){function a(a,c){return c.hasContent()?(a.find("[template-select]").each(function(a,d){b($(d),c)}),void 0):!1}function b(a,b){var d=b.selectFirstFound(c(a));return d?(a.html(d.clone().attr("template-for",null).outerHtml()).attr("ng-bind-html",null).attr("ng-bind",null).attr("template-select",null),void 0):!1}function c(a){return _.map(a.attr("template-select").split("||"),d)}function d(a){return'[template-for="'+$.trim(a)+'"]'}return a}]),angular.module("transferModal",["modal","panel","alertMulti","moveTransferService","textCurrency","radio","dropdowns","isViewportSize"]).directive("transfermodal",["$http","$compile","MoveTransferService","PayBillUtils","PayBillService","$rootScope","isViewportSize",function(a,b,c,d,e,f,g){return{restrict:"E",transclude:!0,scope:{display:"="},link:function(h,i){function j(){t?y():a.get(u).then(function(a){t=b(a.data)(h),i.append(t),y()})}function k(){var a=v.computeDaysRemaining(w,h.disconnectDate,h.systemDate),b=a;a>1?a+=" days":(1===a||0===a)&&(a+=" day"),h.daysLeft=a,h.daysLeftForTransfer=b}function l(){for(var a="",b=0;b<h.noOfPaymentMethods;b++)if(h.transferModel.paymentMethods[b].isAutoPayment){a=h.transferModel.paymentMethods[b].payMethodName;break}return a}function m(a){console.log(a+"In movetransfer success handler");var b,c=a.currMonAutoPayDate,d=a.responseInfo.statusCode;b=v.identifyResponseType(d),h.transferMessage=p(b,c,a),x.updateState(x.states.RESULT),console.log("result called")}function n(a){console.log(a+"In Opt out success handler"),console.log("remind me later success called")}function o(a){console.log(a+"In Opt out fail handler"),console.log("remind me later  error called")}function p(a,b,c){var d=" is ",e="";h.autoPayMethod=h.pmNickNames[0],h.updatedMethod=h.pmNickNames[0],console.log("response"),h.selectedItemsCount>1&&(d=" and "+(h.selectedItemsCount-1)+" other payment method are "),h.selectedItemsCount>2&&(d=" and "+(h.selectedItemsCount-1)+" other payment methods are "),c&&(e=c.responseInfo.ancillaryStatusCode);var f={};return console.log("in response"),"success"===a?(opts={},opts.type="success",opts.title="Your payment info and settings have been transferred to your new account ("+h.transferredAccNO+").",opts.priority=1,h.pageAlerts=[],v.alertObject(opts,h),h.success=!0,"MTSAPSRCSPCS"===e&&(f=h.updatePayMethodFlag?{content_tab1:c.responseInfo.message.additionalInfo,content_tab2:c.responseInfo.ancillaryMessage.payMethod,content_tab3:"Your new account has been set up for paperless billing, just like your last one. "}:{content_tab1:c.responseInfo.message.additionalInfo,content_tab2:c.responseInfo.ancillaryMessage.payMethod,content_tab3:"Your new account has been set up for paperless billing, just like your last one. "}),"MTSAPSRCS"===e&&(f=h.updatePayMethodFlag?{content_tab1:c.responseInfo.message.additionalInfo,content_tab2:c.responseInfo.ancillaryMessage.payMethod,content_tab3:"Your new account has been set up for paperless billing, just like your last one. "}:{content_tab1:c.responseInfo.message.additionalInfo,content_tab2:c.responseInfo.ancillaryMessage.payMethod,content_tab3:"Your new account has been set up for paperless billing, just like your last one. "}),"MTS"===e&&(f={content_tab2:c.responseInfo.ancillaryMessage.payMethod,content_tab3:"Your new account has been set up for paperless billing, just like your last one. "})):"failure"===a?h.showTransferFailure=!0:("MTSAPF"===e&&(h.transferFailed=!0,f=h.updatePayMethodFlag?{content_tab1:"Sorry, we weren't able to transfer your automatic payment settings, but you can enroll anytime you like at optimum.net/pay-bill.Enroll in automatic payments",content_tab2:c.responseInfo.ancillaryMessage.payMethod,content_tab3:"Your new account has been set up for paperless billing, just like your last one. "}:{content_tab1:"Sorry, we weren't able to transfer your automatic payment settings, but you can enroll anytime you like at optimum.net/pay-bill.Enroll in automatic payments",content_tab2:c.responseInfo.ancillaryMessage.payMethod,content_tab3:"Your new account has been set up for paperless billing, just like your last one. "},opts={},opts.type="major",opts.title="",opts.message="Sorry, your automatic payment settings could not be transferred, but we were able to successfully transfer your saved payment methods.",opts.priority=2,v.alertObject(opts,h)),"MTSAPSRCF"===e&&(h.success=!0,f=h.updatePayMethodFlag?{content_tab1:"Your automatic payment settings have been enabled. Due to some technical difficulties payment for the current month couldn't be scheduled, please make a onetime payment for current month's bill.",content_tab2:c.responseInfo.ancillaryMessage.payMethod,content_tab3:"Your new account has been set up for paperless billing, just like your last one. "}:{content_tab1:"Your automatic payment settings have been enabled. Due to some technical difficulties payment for the current month couldn't be scheduled, please make a onetime payment for current month's bill.",content_tab2:c.responseInfo.ancillaryMessage.payMethod,content_tab3:"Your new account has been set up for paperless billing, just like your last one. "},opts={},opts.type="success",opts.title="Your payment info and settings have been transferred to your new account ("+h.transferredAccNO+").",opts.priority=1,h.pageAlerts=[],v.alertObject(opts,h)),"MTSAPSRCSPCF"===e&&(h.success=!0,h.prefCommFailed=!0,c.responseInfo.message.mainmsg&&(h.prefCommContent=c.responseInfo.message.mainmsg),f=h.updatePayMethodFlag?{content_tab1:c.responseInfo.message.additionalInfo,content_tab2:c.responseInfo.ancillaryMessage.payMethod,content_tab3:"Your new account has been set up for paperless billing, just like your last one. "}:{content_tab1:c.responseInfo.message.additionalInfo,content_tab2:c.responseInfo.ancillaryMessage.payMethod,content_tab3:"Your new account has been set up for paperless billing, just like your last one. "},opts={},opts.type="success",opts.title="Your payment info and settings have been transferred to your new account ("+h.transferredAccNO+").",opts.priority=1,h.pageAlerts=[],v.alertObject(opts,h))),f}function q(){h.transferMessage=p("failure",null,null),x.updateState(x.states.RESULT)}function r(a){e.checkSuccess(a)&&(url="/pay-bill/dissuasion/?p=true",window.location=url)}function s(){}var t,u="/parts/transfer-modal/transfer-modal-template.html";h.$watch("display",function(a,b){console.log("newval: "+a+"oldVal: "+b),a&&j()}),h.isViewportSize=g;var v=d;isMobile()&&(v.changeInputType("max-amount-container"),v.changeInputType("other-amount-container"));var w=90;h.moveTransferService=c;var x=function(){function a(a){return f===a}function b(){f=e.INITIAL,console.log("states"+f)}function c(a){f=a}function d(){h.showTransferWizard=!1,h.display=!1}var e={INITIAL:"Initial",EDIT_AUTO_PAY:"EditAutoPay",OPTOUT:"OptOut",RESULT:"Result",ERROR_ALL:"Error",MAYBE_LATER:"MayBeLater",SPINNER:"Spinner",CANCEL:"Cancel"},f={};
return{states:e,isCurrent:a,init:b,updateState:c,close:d}}();h.wizardState=x;var y=function(){h.ebillInfo=h.moveTransferService.getEbillResponse();var a=v.getObjInArrayByValue(f.acctDetail,"active",!0);h.activeAcctEbillInfo=v.computeActiveAcctEbillInfo(a.accountNumber,h.ebillInfo),h.fromAcctEbillInfo=v.computeFromAcctEbillInfo(h.ebillInfo),h.toAcctEbillInfo=v.computeToAcctEbillInfo(h.ebillInfo),console.log(h.activeAcctEbillInfo),h.transferModel={},h.transferModel.apOptOut=h.ebillInfo.apOptOut,h.transferModel.pmOptOut=h.ebillInfo.pmOptOut,h.showOptOutLink=0===h.transferModel.apOptOut&&0===h.transferModel.pmOptOut||!f.showOptOut?!1:!0,h.showTransferFailure=!1,h.autoPayPresent=h.fromAcctEbillInfo.hasAutoPay,h.payduedate=h.fromAcctEbillInfo.isDuedate,h.autopaydate=h.fromAcctEbillInfo.scheduledAutoDate,h.paydaysInAdvance=h.fromAcctEbillInfo.payDaysInAdvance,h.paydayofMonth=h.fromAcctEbillInfo.payDayOfMonth,h.topaydayofMonth=h.toAcctEbillInfo.payDayOfMonth,h.topaydaysInAdvance=h.toAcctEbillInfo.payDaysInAdvance,h.systemDate=v.parseDate(f.systemDate),h.sysDate=f.systemDate,h.dueDate=f.dueDate,h.parsedDueDate=v.parseDate(f.dueDate),h.autopaydate&&(h.autopaydate=h.autopaydate.substr(0,6)+h.autopaydate.substr(-2)),h.dayofMonth=h.fromAcctEbillInfo.payDayOfMonth,h.noOfPaymentMethods=h.fromAcctEbillInfo.paymentMethods.length,h.editCloseClicked=!1;for(var b=!1,c=[],d=0;d<h.noOfPaymentMethods;d++)if(h.fromAcctEbillInfo.paymentMethods[d].isAutoPayment===!0){c[0]=h.fromAcctEbillInfo.paymentMethods[d],b=!0;break}for(var e=0,g=0;g<h.noOfPaymentMethods;g++)d>g?c[g+1]=h.fromAcctEbillInfo.paymentMethods[g]:d===g&&0===e?e=1:c[g]=h.fromAcctEbillInfo.paymentMethods[g];if(h.transferModel.paymentMethods=b?c:h.fromAcctEbillInfo.paymentMethods,h.transferModel.maxAmountValue=h.fromAcctEbillInfo.capAmount,h.lastBill=!1,h.lastAmount=f.lastAmount,(""===h.lastAmount||null===h.lastAmount)&&(h.lastBill=!0),h.accountNoShow=v.formatAccountNumber(h.fromAcctEbillInfo.accountNum),h.transferredAccNO=v.formatAccountNumber(h.toAcctEbillInfo.accountNum),h.transferModel.otherAmount=h.fromAcctEbillInfo.fixAmount,h.transferModel.alreadyPaid=!1,h.autoPayNickName=null,h.listActions=!0,h.updatePayMethodFlag=!1,h.pmNickNames=[],h.pageAlerts=[],h.payMethodsStr=null,h.chkPayMethods="",h.initialMethod="",h.updatedMethod="",h.selectedPaymentMethods=[],h.transferModel.autoPayTransferCheck=h.fromAcctEbillInfo.hasAutoPay,h.disconnectDate=v.parseDate(h.ebillInfo.discoDate),h.toAcctEbillInfo.isPaperBill||h.fromAcctEbillInfo.isPaperBill||(h.enrolledInPaperLess=!0),h.parsedSystemDate=v.parseDate(f.systemDate),k(),null!==h.disconnectDate){h.pastAcctAvlDate=v.addDays(h.disconnectDate,w),h.pastAcctAvlDate=v.dateToString(h.pastAcctAvlDate);var i=h.pastAcctAvlDate.split("/").join(""),j=i.substring(0,2),m=i.substring(2,4),n=i.substring(6,8);h.optOutShowDate=j+"/"+m+"/"+n,h.pastAcctAvlDate=h.pastAcctAvlDate.substr(0,6)+h.pastAcctAvlDate.substr(-2)}for(h.transferModel.paymentMethodOptions=[],h.transferModel.dueDateOptions={},h.transferModel.dateOnMonthOptions={},h.transferModel.datePM="advance",h.transferModel.amountPM="due",h.firstLoad=!0,h.doneClicked=!1,h.autoPayTransfer=!1,h.transferModel.amountValid=!0,h.transferModel.emailValid=!0,h.fromAcctEbillInfo.payDayOfMonth&&(h.transferModel.datePM="dom",h.dayOnMonth=h.fromAcctEbillInfo.payDayOfMonth,h.paydayofMonth=h.fromAcctEbillInfo.payDayOfMonth),h.fromAcctEbillInfo.payDaysInAdvance&&(h.transferModel.datePM="advance",h.daysInAdvance=h.fromAcctEbillInfo.payDaysInAdvance,h.paydaysInAdvance=h.fromAcctEbillInfo.payDaysInAdvance),h.fromAcctEbillInfo.capAmount&&(h.transferModel.amountPM="due",h.maxAmt=h.fromAcctEbillInfo.capAmount),h.fromAcctEbillInfo.fixAmount&&(h.transferModel.amountPM="other",h.otherAmount=v.currency(h.fromAcctEbillInfo.fixAmount),h.fixAmt=h.otherAmount),h.transferModel.emailAddress=h.fromAcctEbillInfo.email,f.dueAmount&&(h.initalDueAmount=f.dueAmount),h.wizardState.init(),h.showTransferWizard=!0,h.transferModel.showMaxStatement=!1,h.ackTransferFlag=0,h.transferModel.selectedPayMethods=[],null!==h.fromAcctEbillInfo.capAmount&&h.fromAcctEbillInfo.capAmount>0&&(h.transferModel.showMaxStatement=!0),h.autoPayMethod=l(),h.selectedItemsCount=h.noOfPaymentMethods,angular.forEach(h.transferModel.paymentMethods,function(a){angular.isDefined(a.selected=!0),h.defaultMethods=a.payMethodName}),d=0;d<h.fromAcctEbillInfo.paymentMethods.length;d++)paymentMethod=h.fromAcctEbillInfo.paymentMethods[d],paymentMethod.isAutoPayment&&(h.transferModel.paymentMethod=d,h.cardName=paymentMethod.payMethodName),h.transferModel.paymentMethodOptions[String(d)]=paymentMethod.payMethodName;for(d=1;6>d;d++)h.transferModel.dueDateOptions[String(d)]=1===d?String(d)+" day before":String(d)+" days before";for(function(a){Number.getOrdinalFor=function(b,c){return(c?b:"")+(a[((b=Math.abs(b%100))-20)%10]||a[b]||"th")}}(["","st","nd","rd"]),num1=1;32>num1;num1++)str=Number.getOrdinalFor(num1,!0),h.transferModel.dateOnMonthOptions[String(num1)]=str;null!==h.dayofMonth&&(day=Number.getOrdinalFor(h.dayofMonth,!0),h.paydayofMonth=day),f.$watch("statements",function(){f.$watch("dueAmount",function(){f.dueAmount&&h.autoPayPresent&&f.statements&&(h.showAutoText=!0,h.dueDate&&(h.firstAutoPaydate=v.createAutoPayDate(h)))})})};h.paymentMethodCountHandler=function(a){var b=[];h.chkPayMethods=!0,angular.forEach(a,function(a){angular.isDefined(a.selected)&&a.selected===!0&&b.push(a.payMethodName)}),h.selectedItemsCount=b.length,h.listActions=h.selectedItemsCount>0?!0:!1,h.selectedPaymentMethods=b,h.transferModel.autoPayTransferCheck||h.listActions||!h.autoPayPresent?h.autoPayPresent||h.listActions||(opts={},opts.type="major",opts.title="",opts.message="At least one payment method must be selected.",opts.priority=2,h.pageAlerts=[],v.alertObject(opts,h)):(opts={},opts.type="major",opts.title="",opts.message="At least one payment method or Automatic payments must be selected.",opts.priority=2,h.pageAlerts=[],v.alertObject(opts,h))},h.showMayBeLater=function(){var a=30;h.daysLeftForTransfer>a?(h.mayBeLater(),h.wizardState.init()):h.wizardState.updateState(x.states.MAYBE_LATER)},h.payMethodType=function(a,b){return v.payMethodType(a,b)},h.truncatePaymentName=function(a){return v.truncateName(a)},h.enableRefresh=function(){h.showTransferWizard=!1,h.display=!1,f.refresh=!0},h.enableTransfer=function(){return h.transferModel.authorizeTransfer&&(h.transferModel.autoPayTransferCheck||h.listActions)?(h.ackTransferFlag=1,!1):!0},h.submitAutoPay=function(){h.doneClicked=!0;var a=[];if(h.emailFromServer=h.transferModel.emailAddress,h.cardName=h.transferModel.paymentMethodOptions[h.transferModel.paymentMethod],h.autoAmount=h.transferModel.amountPM,h.autoDatePM=h.transferModel.datePM,h.updatePayMethodFlag=!0,h.updatePayMethodFlag){if("advance"===h.transferModel.datePM&&(h.flag=0,h.paydaysInAdvance=h.transferModel.dueDateSelected,h.firstAutoPaydate=v.createAutoPayDate(h)),"dom"===h.transferModel.datePM){if(h.flag=1,h.paydayofMonth){h.paydayofMonth=h.paydayofMonth.substring(0,1);var b=parseInt(h.transferModel.dateOnMonthSelected,10);b=b,b=b.toString(),h.domonth=h.transferModel.dateOnMonthSelected,h.paydayofMonth!==b&&(h.paydayofMonth=h.transferModel.dateOnMonthSelected),h.paydayofMonth=Number.getOrdinalFor(h.paydayofMonth,!0)}else h.paydayofMonth=h.transferModel.dateOnMonthSelected,h.domonth=h.transferModel.dateOnMonthSelected,h.paydayofMonth=Number.getOrdinalFor(h.paydayofMonth,!0);h.firstAutoPaydate=v.createAutoPayDate(h)}"due"===h.transferModel.amountPM&&(h.maxAmount=h.transferModel.maxAmountValue,h.setMaxAmount=v.currency(h.maxAmount),h.setMaxCheck=h.transferModel.maxAmount,h.otherAmount=null),"other"===h.transferModel.amountPM&&(h.otherAmount=v.currency(h.transferModel.otherAmount),h.setMaxCheck=!1);for(var c=0;c<h.noOfPaymentMethods;c++)h.transferModel.paymentMethods[c].isAutoPayment&&(h.initialMethod=h.transferModel.paymentMethods[c].payMethodName,h.initialMethod&&(h.transferModel.paymentMethods[c].isAutoPayment=!1)),h.updatedMethod=h.transferModel.paymentMethodOptions[h.transferModel.paymentMethod],h.updatedMethod===h.transferModel.paymentMethods[c].payMethodName&&(h.transferModel.paymentMethods[c].isAutoPayment=!0);for(h.autoPayMethodCheck(),c=0;c<h.noOfPaymentMethods;c++)if(h.transferModel.paymentMethods[c].isAutoPayment===!0){a[0]=h.transferModel.paymentMethods[c];break}for(var d=0,e=0;e<h.noOfPaymentMethods;e++)c>e?a[e+1]=h.transferModel.paymentMethods[e]:c===e&&0===d?d=1:a[e]=h.transferModel.paymentMethods[e];h.transferModel.paymentMethods=a}else l();h.transferModel.showMaxStatement=!1,h.wizardState.init()},h.closeEditModal=function(){h.doneClicked||(h.firstLoad=!0),h.editCloseClicked=!0,h.checkCancel()},h.submitDataTransfer=function(){if(h.transferModel.autoPayTransferCheck?(h.autoPayTransfer=!0,h.autoPayNickName=h.transferModel.paymentMethodOptions[h.transferModel.paymentMethod]):h.autoPayNickName=null,h.updatePayMethodFlag||("advance"===h.transferModel.datePM&&(h.autoPayDaysInAdvance=h.daysInAdvance),"dom"===h.transferModel.datePM&&(h.autoPayDayOfMonth=h.dayOnMonth),"due"===h.transferModel.amountPM&&(h.autoPayCapAmount=h.maxAmt),"other"===h.transferModel.amountPM&&(h.autoPayFixAmount=h.fixAmt)),h.chkPayMethods)h.pmNickNames=h.selectedPaymentMethods,h.payMethodsStr=h.pmNickNames.toString();else{for(var a=0;a<h.noOfPaymentMethods;a++)h.pmNickNames[a]=h.transferModel.paymentMethods[a].payMethodName;h.payMethodsStr=h.pmNickNames.toString()}x.updateState(x.states.SPINNER),e.submitMoveTransfer(m,q,h)},h.autoPayMethodCheck=function(){h.$watch("transferModel.autoPayTransferCheck",function(){h.transferModel.autoPayTransferCheck&&angular.forEach(h.transferModel.paymentMethods,function(a){angular.isDefined(a.selected)&&a.selected===!1&&a.isAutoPayment&&(a.selected=!0,h.paymentMethodCountHandler(h.transferModel.paymentMethods))})})},h.editAutoPay=function(){function a(a){var b=/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;return b.test(a)}function b(a){$("#"+a).removeClass("error-input"),c($("#"+a).val())?"other"===h.transferModel.amountPM?(h.amountSelected=$("#"+a).val(),h.transferModel.amountValid=!0):h.transferModel.maxAmount&&h.transferModel.maxAmountValue&&(h.transferModel.amountValid=!0):($("#"+a).addClass("error-input"),h.transferModel.amountValid=!1)}function c(a){if(a)if(a=String(a),a=a.replace(/\s/g,""),a.split("$").length>0&&(a=a.split("$").join("")),-1===a.indexOf(".")){if(!isNaN(a)&&(value=parseInt(a,10),value>=1&&1e4>value))return!0}else if(a.split(".")&&2===a.split(".").length&&!isNaN(a.split(".")[0])&&!isNaN(a.split(".")[1])&&a.split(".")[1].length<3&&(value=parseFloat(a,2),value>=1&&1e4>value))return!0;return!1}h.editCloseClicked=!1,h.pageAlerts=[],x.updateState(x.states.EDIT_AUTO_PAY),response=h.fromAcctEbillInfo,h.firstLoad?(response.hasAutoPay&&(h.hasAutoPay=!0,null!==response.payDayOfMonth&&(h.transferModel.datePM="dom",h.transferModel.dateOnMonthSelected=String(response.payDayOfMonth)),response.payDaysInAdvance&&(h.transferModel.datePM="advance",h.transferModel.dueDateSelected=String(response.payDaysInAdvance),h.paydaysInAdvance=String(response.payDaysInAdvance)),null!==response.fixAmount?($("#otherAmountInput").val(v.currency(response.fixAmount)),h.fixAmt=v.currency(response.fixAmount),h.otherAmount=v.currency(response.fixAmount),h.transferModel.amountPM="other"):($("#otherAmountInput").val="",h.fixAmt="",h.otherAmount=null),null!==response.capAmount?(h.calculatedMaxAmount=v.currency(response.capAmount),$("#maxAmountInput").val(v.currency(response.capAmount)),h.transferModel.amountPM="due",b("maxAmountInput"),h.setMaxCheck=h.transferModel.maxAmount,opts={},opts.type="minor",opts.title="",opts.message="You had a max payment amount set on your previous account. <br>Please review your new estimated monthly charges and make any necessary changes.",opts.priority=2,h.pageAlerts=[],v.alertObject(opts,h)):($("#maxAmountInput").val="",h.transferModel.maxAmountValue="",h.transferModel.maxAmount=!1,h.setMaxCheck=!1)),h.transferModel.emailAddress=null!==response.email?response.email:"",h.domonth=h.transferModel.dateOnMonthSelected,h.autoDueDate=h.transferModel.dueDateSelected,h.autoDatePM=h.transferModel.datePM,h.autoAmount=h.transferModel.amountPM,h.emailFromServer=h.transferModel.emailAddress,h.setMaxCheck=h.transferModel.maxAmount,h.maxAmount=h.transferModel.maxAmountValue):(h.transferModel.maxAmountValue=h.maxAmount,h.otherAmount&&(h.fixAmt=h.otherAmount.substring(1,4)),h.transferModel.otherAmount=h.otherAmount,h.transferModel.emailAddress=h.email,h.transferModel.dueDateSelected=h.paydaysInAdvance,h.transferModel.dateOnMonthSelected=h.domonth,h.autoDueDate=h.transferModel.dueDateSelected,h.transferModel.emailAddress=h.emailFromServer,h.transferModel.paymentMethodOptions[h.transferModel.paymentMethod]=h.cardName,h.transferModel.datePM=h.autoDatePM,h.transferModel.amountPM=h.autoAmount,h.transferModel.maxAmount=h.setMaxCheck,null!==h.paydayofMonth&&void 0!==h.paydayofMonth&&(h.transferModel.dateOnMonthSelected=3===h.paydayofMonth.length?h.paydayofMonth.substring(0,1):h.paydayofMonth.substring(0,2)),null!==h.maxAmount?($("#maxAmountInput").val(v.currency(h.maxAmount)),h.transferModel.maxAmount=h.setMaxCheck,b("maxAmountInput")):($("#maxAmountInput").val="",h.transferModel.maxAmountValue="")),h.$watch("transferModel.emailAddress",function(b){$("#emailInput").removeClass("error-input"),$("#emailError").addClass("hidden"),a(b)?h.transferModel.emailValid=!0:($("#emailInput").addClass("error-input"),$("#emailError").removeClass("hidden"),h.transferModel.emailValid=!1),h.hasAutoPay&&(h.transferModel.emailChanged=h.emailAddress!==b?!0:!1)}),h.$watch("transferModel.maxAmount",function(){h.transferModel.maxAmount?(h.transferModel.amountPM="due",b("maxAmountInput")):h.transferModel.amountValid=!0}),h.checkPaymentValid=function(){return h.transferModel.amountValid&&h.transferModel.emailValid?!1:!0},$("#otherAmountInput").live("blur",function(){this.value=this.value.split("$").join(""),this.value=this.value.replace(/\s/g,""),this.value=this.value.replace(/^[0]+/g,""),""!==this.value&&("."===this.value&&(this.value="0"),this.value="0"===this.value||isNaN(Math.abs(parseFloat(this.value)))?0:Math.abs(parseFloat(this.value)).toFixed(2)),"0.00"===this.value&&(this.value=0),this.value&&this.value.length>0&&"$"!==this.value[0]&&(this.value="$"+this.value)}),$("#maxAmountInput").live("blur",function(){this.value=this.value.replace(/^\s+|\s+$/g,""),this.value=this.value.replace("$",""),this.value=this.value.replace(/^[0]+/g,""),""!==this.value&&("."===this.value&&(this.value="0"),this.value="0"===this.value||isNaN(Math.abs(parseFloat(this.value)))?0:Math.abs(parseFloat(this.value)).toFixed(2)),"0.00"===this.value&&(this.value=0),this.value&&this.value.length>0&&"$"!==this.value[0]&&(this.value="$"+this.value)}),h.$watch("transferModel.otherAmount",function(){"other"===h.transferModel.amountPM&&b("otherAmountInput")}),h.$watch("transferModel.maxAmountValue",function(){"due"===h.transferModel.amountPM&&b("maxAmountInput")}),h.$watch("transferModel.amountPM",function(){$("#otherAmountInput").removeClass("error-input"),$("#maxAmountInput").removeClass("error-input"),h.transferModel.amountValid=!1,"other"===h.transferModel.amountPM?(b("otherAmountInput"),h.otherAmountClicked()):(b("maxAmountInput"),h.transferModel.maxAmount||(h.transferModel.amountValid=!0))}),h.otherAmountClicked=function(){h.transferModel.maxAmount=!1,h.transferModel.amountPM="other"},h.firstLoad=!1},h.checkCancel=function(){h.transferModel.paymentMethodOptions[h.transferModel.paymentMethod]!==h.cardName||h.transferModel.dateOnMonthSelected!==h.domonth?x.updateState(x.states.CANCEL):h.transferModel.dueDateSelected!==h.autoDueDate||h.transferModel.datePM!==h.autoDatePM?x.updateState(x.states.CANCEL):$("#otherAmountInput").val()!==h.fixAmt||h.transferModel.amountPM!==h.autoAmount?x.updateState(x.states.CANCEL):h.transferModel.emailAddress!==h.emailFromServer||h.transferModel.maxAmount!==h.setMaxCheck||h.transferModel.maxAmountValue!==h.maxAmount?x.updateState(x.states.CANCEL):x.init()},h.yesCancel=function(){h.editCloseClicked?h.mayBeLater():h.wizardState.init()},h.noThanks=function(){h.editCloseClicked=!1,h.wizardState.updateState(x.states.EDIT_AUTO_PAY)},h.dontRemind=function(){h.transferModel.apOptOut=0,h.transferModel.pmOptOut=0,e.submitOptOut(n,o,h),f.refresh=!0,h.wizardState.close()},h.mayBeLater=function(){document.cookie="remind_later=true;path=/",h.wizardState.close(),f.isGetStartedClicked=!1},h.checkManagePaperLess=function(){if(f.acctDetail){var a=v.getObjInArrayByValue(f.acctDetail,"active",!0),b=a.accountType;h.toAcctType=b,"2"===b&&(h.toAcctType="0"),"3"===b&&(h.toAcctType="1"),e.toggleAccount(r,s,h.toAcctType)}}}}}]),function(a){jQuery.fn.outerHtml=function(b){return b?this.before(b).remove():a("<div>").append(this.eq(0).clone()).html()},jQuery.fn.hasContent=function(){return""!==a.trim(this.html())},jQuery.fn.fixChromeRedrawBug=function(){this[0].style.display="none",this[0].offsetHeight,this[0].style.display="block"},jQuery.fn.selectFirstFound=function(a){for(var b=0;b<a.length;b+=1){var c=this.find(a[b]);if(c.length)return c}return null},jQuery.fn.relativeAnchorPositions=function(){return{top:0,left:0,right:this.outerWidth(),bottom:this.outerHeight()}},jQuery.fn.absoluteAnchorPositions=function(){var a=this.offset();return a.right=a.left+this.outerWidth(),a.bottom=a.top+this.outerHeight(),a},jQuery.fn.scrollPositions=function(){var a={top:this.scrollTop(),left:this.scrollLeft()};return a.bottom=a.top+this.outerHeight(),a.right=a.left+this.outerWidth(),a},jQuery.fn.scrollRight=function(){return this.scrollLeft()+this.outerWidth()},jQuery.fn.scrollBottom=function(){return this.scrollTop()+this.outerHeight()}}(jQuery),angular.module("vodtoppicks",["vod","movieCart","oolCookie","poster"]).directive("vodTopPicks",function(){return{restrict:"EA",templateUrl:"/parts/vod-top-picks/vod-top-picks.html",controller:["$scope","Vod","$http","movieCart","$notice","OnDemand","ooluser","$timeout","Config",function(a,b,c,d,e,f,g,h,i){function j(){a.showCarousel=!1,a.topPicks="",$(".ondemand-toppicks").hide("fast")}var k=$(window).width();a.windowHref=window.location.href,a.ooluser=g;var l=1e4,m=i.getValuesBySelector("vodTopPicks");b.getTopPicks().success(function(b){$(".ondemand-toppicks").show("fast"),a.showCarousel=b.showCarouselFlag===!0?!0:!1,a.topPicks=b.assets,l=b.carouselAutoCycle?b.carouselAutoCycle:m.autoCycleTime,a.getTapDetail=function(a){window.location.href="/tv/on-demand/detail/"+a+".html"};var c=0;if(angular.forEach(a.topPicks,function(b){d.getItems(function(){a.noCart=!1,b.noCart=a.noCart,angular.isObject(b)&&(b.onDemandAsset=f.addAssetMethodsToAsset(b),a.topPicks[c]=b,c+=1)},function(){b.noCart=a.noCart,a.topPicks[c]=b,c+=1})}),isViewportSize.phone&&isDeviceWidth.phone){if(767>k&&$(".carousel").carousel({interval:1e8}),769>k){var e=$(".description-text").height();setTimeout(function(){var a=$(".carousel-indicators li.active").first().attr("data-slide-to");"0"===a&&(100>e?($(".description-text").css({height:"100px"}),$(".description-text").dotdotdot({ellipsis:"..."})):$(".description-text").dotdotdot({ellipsis:"..."}))},250),$(".carousel-inner").swipe({swipeLeft:function(){$(this).parent().carousel("next"),100>e?($(".description-text").css({height:"100px"}),$(".description-text").dotdotdot({ellipsis:"..."})):$(".description-text").dotdotdot({ellipsis:"..."})},swipeRight:function(){$(this).parent().carousel("prev"),100>e?($(".description-text").css({height:"100px"}),$(".description-text").dotdotdot({ellipsis:"..."})):$(".description-text").dotdotdot({ellipsis:"..."})},tap:function(b){($(b.target).hasClass("img-alt")===!0||$(b.target).hasClass("carouselImg")===!0||$(b.target).hasClass("img-alt__graphic")===!0)&&h(function(){var b=$(".carousel-indicators li.active").first().attr("data-slide-to"),c=a.topPicks[b].id;window.location.href="/tv/on-demand/detail/"+c+".html"},5)},threshold:50})}}else $(".carousel").carousel({interval:l,pause:"none"}),setTimeout(function(){var a=$(".description-text").height();100>a?($(".description-text").css({height:"100px"}),$(".description-text").dotdotdot({ellipsis:"..."})):$(".description-text").dotdotdot({ellipsis:"..."})},250),$(document).on("mouseenter","[id=carouselItemId]",function(){$(".carousel").carousel("pause")}),$(document).on("mouseleave","[id=carouselItemId]",function(){$(".carousel").carousel({interval:1e3,pause:"none"})}),$(document).on("click","[data-slide=next]",function(){$(".carousel").carousel({interval:1e3,pause:"none"})}),$(document).on("click","[data-slide=prev]",function(){$(".carousel").carousel({interval:1e3,pause:"none"})}),a.getDetail=function(a){window.location.href="/tv/on-demand/detail/"+a+".html"},$(".carousel").on("slid.bs.carousel",function(){setTimeout(function(){$(".carousel-indicators li").size();var a=$(".carousel-indicators li.active").first().attr("data-slide-to"),b=$(".description-text").height();"0"===a?100>b?($(".description-text").css({height:"100px"}),$(".description-text").dotdotdot({ellipsis:"..."})):$(".description-text").dotdotdot({ellipsis:"..."}):100>b?($(".description-text").css({height:"100px"}),$(".description-text").dotdotdot({ellipsis:"..."})):$(".description-text").dotdotdot({ellipsis:"..."})},80)})}).error(j),a.notifyNoCart=function(){e.add("Sorry, we could not access your cart. Please try again later.","error")},a.removeFromCart=function(b){void 0!==b.onDemandAsset&&b.onDemandAsset.removeFromCart(angular.noop,a.notifyNoCart)},a.addToCart=function(b){void 0!==b.onDemandAsset&&b.onDemandAsset.addToCart(angular.noop,a.notifyNoCart)}}]}}).filter("dateformat",function(){return function(a){return a.split(" ")[0]}}).filter("getRatingClass",function(){return function(a){return null!==a?a.replace(".","-"):"0-0"}}),angular.module("alertsService",["config","oolCookie","outageService"]).factory("Alerts",["$http","Config","ooluser","Outage","$q","$rootScope","$window","$location",function(a,b,c,d,e,f,g,h){var i=b.getValuesBySelector("endpoint.api.alert"),j=angular.fromJson,k={GET_ALERT:"alert",GET_PREVIEW_ALERT:"alert?cms_mode=preview"},l={SIMPLE:"simpleResponse"},m=c.eoid?c.eoid:"",n=!1,o=h.host(),p="preview";n=o.indexOf(p)>-1?!0:!1;var q=!1;o.indexOf("espanol.optimum")>-1&&(q=!0);var r=function(){function b(a,b,c){a.push({extLink:c,link:b.id,corpIds:b.corpIds,id:b.id,primaryMessage:b.title,type:alertType,regions:b.regions,secondaryMessage:b.summary,description:b.description,date:b.date})}var c=function(a,b){var c={isValid:!1,parsedResponse:null};try{var d=j(a);c.isValid=!0,c.parsedResponse=d}catch(e){console.error("ERROR parsing => "+b),console.error(e)}return c},g=function(a){var d=c(a,l.SIMPLE),e=null;if(d.isValid){var f=d.parsedResponse._embedded,g=f&&f.alerts?f.alerts:[];g=angular.isArray(g)?g:[g];for(var h=[],i=0,j=g.length;j>i;i++){var k=g[i];k.label&&!k.title&&(k.title=k.label);var m=k.id&&k.title&&k.summary;alertType="Service Outage"===k.title?"major":"minor";var o="";o=""!==k.extLink&&"null"!==k.extLink&&void 0!==k.extLink&&null!==k.extLink?k.extLink:"";var p=0,r=0,s=!1,t=!0,u=!0;void 0!==k.expiryDate&&null!==k.expiryDate&&""!==k.expiryDate&&"null"!==k.expiryDate&&0!==k.expiryDate&&"0"!==k.expiryDate&&(p=k.expiryDate,(new Date).getTime()>p&&(s=!0)),void 0!==k.publishDate&&null!==k.publishDate&&""!==k.publishDate&&"null"!==k.publishDate&&0!==k.publishDate&&"0"!==k.publishDate&&(r=k.publishDate,(new Date).getTime()<r&&(t=!1)),("es"===k.language&&q===!1||"en"===k.language&&q===!0)&&(u=!1),n&&(t=!0,s=!1,u=!0),t===!0&&s===!1&&u===!0&&(p="",r="",m&&b(h,k,o))}e={alerts:_.cloneDeep(h)}}return e},o=function(b,c,d,e,f){var g={method:c||"GET",url:b,data:d||null,headers:f||null,transformResponse:e||null};return a(g).success(function(a){return a}).error(function(){return console.error("ERROR, unexpected response status"),null})};return this.getAlert=function(a){var b=i+k.GET_ALERT+"?eoid="+m;return n&&(b=i+k.GET_PREVIEW_ALERT+"&eoid="+m),a&&a.page&&(b=b+"&displayPage="+a.page),o(b,null,null,g,null)},this.getCombinedAlerts=function(a){var b=function(a){return function(){return a}},c=this.getAlert(a).then(_.identity,b({data:{alerts:[]}})),g=d.getProcessedOutagePromise(),i=e.all([c,g]).then(function(a){var b=a[0],c=b.data.alerts.slice(0),d=a[1];_.each(c,function(a){a.source="cms-detailed",a.link=""!==a.extLink?a.extLink:"/support/notification/#?type=cms-detailed&id="+a.id});var e="/support/outage/#/",g="Service alert",i="Your account is past due",j="minor";"User not logged in"!==d.outageStatus&&null!=d.accountSummary?d.accountSummary.nodeInDistress||d.accountSummary.devicesOffline||!d.accountSummary.plannedMaintenance?d.accountSummary.nodeInDistress||d.accountSummary.devicesOffline||d.accountSummary.plannedMaintenance?d.accountSummary.plannedMaintenance&&d.accountSummary.nodeInDistress&&d.accountSummary.devicesOffline?e+="PmNodeInDistress":d.accountSummary.plannedMaintenance&&!d.accountSummary.nodeInDistress&&d.accountSummary.devicesOffline?e+="PmNodeInDistress":!d.accountSummary.plannedMaintenance&&d.accountSummary.nodeInDistress&&d.accountSummary.devicesOffline?e+="UndeclaredOutage":d.accountSummary.plannedMaintenance||d.accountSummary.nodeInDistress||!d.accountSummary.devicesOffline?d.accountSummary.plannedMaintenance&&d.accountSummary.nodeInDistress&&!d.accountSummary.devicesOffline?e+="PmNodeInDistress":d.accountSummary.plannedMaintenance||!d.accountSummary.nodeInDistress||d.accountSummary.devicesOffline||(e+="NodeInDistress"):e+="UndeclaredOutage":e+="PmModemsOnline":e+="PmNodeInDistress":"User not logged in"===d.outageStatus?e+="UnauthenticatedUserOutage":("error"===d.outageStatus||"ERROR"===d.outageStatus)&&(e+="NoServiceStatus"),null!=d.accountSummary&&"VOD_HOLD"===d.accountSummary.accountPaymentStatus&&(e="/support/outage/#/PendingVOD",c.unshift({primaryMessage:g,secondaryMessage:i,type:j,outageType:"OUTAGE_ON_ACCOUNT",source:"vod hold",link:e})),null!=d.accountSummary&&d.accountSummary.serviceOutageReported&&("RECENTLY_CLEARED"===d.outageStatus&&"/support/outage/#/"!==e||("RECENTLY_CLEARED"===d.outageStatus&&"/support/outage/#/"===e?e="/support/outage/#/PmModemsOnline":(e="/support/outage/#/PmKnownOutage",i="Outage detected",d.outageStatus="OUTAGE_ON_ACCOUNT",c.unshift({primaryMessage:g,secondaryMessage:i,type:"major",outageType:d.outageStatus,source:"outage",link:e,outageMessage:d.outageMessage})))),null!=d.accountSummary&&"NON_PAY"===d.accountSummary.accountPaymentStatus&&(j="major",e="/support/outage/#/PendingNonPayVOD",i="Your account is past due",c.unshift({primaryMessage:g,secondaryMessage:i,type:j,outageType:"OUTAGE_ON_ACCOUNT",source:"non pay",link:e}));var k=$(location).attr("href"),l=document.referrer,m=k.indexOf("/support"),n=k.substring(m);if(f.currentOutageLink=e,-1===l.indexOf("/outage")&&n!==e);else if(-1!==k.indexOf("/outage")&&-1===k.indexOf("/login/?referer")&&-1===l.indexOf("alerts-and-notifications")){var o=e.split("#");h.path(o[1])}return{alerts:c}});return i},this};return new r}]),angular.module("authenticationHandler",[]).config(["$httpProvider",function(a){var b=["$rootScope","$q",function(a,b){function c(a){return 401===a.status}return function(d){return d.then(function(a){return a},function(d){return c(d)&&a.$broadcast("authenticationHandler:unauthenticated",d),b.reject(d)})}}];a.responseInterceptors.push(b)}]),angular.module("bestBets",["config","oolCookie"]).factory("BestBets",["$http","Config","ooluser",function(a,b,c){var d=function(a,b){var c={isValid:!1,parsedResponse:null};try{var d=angular.fromJson(a);c.isValid=!0,c.parsedResponse=d}catch(e){console.error("ERROR parsing => "+b),console.error(e)}return c},e=function(){var a=this,d=b.getValuesBySelector("endpoint.api.bestBets");a.getOnTonight=function(){var b={deviceType:"web",hubId:c.hubId};return a.makeRequest(d,"GET",b,a.formatOnTonightResponse.bind(this),null)}};return e.prototype={makeRequest:function(b,c,d,e,f){var g={method:c||"GET",url:b,data:d||null,headers:f||null,transformResponse:e||null};return a(g).success(function(a){return a}).error(function(a){return a})},formatOnTonightResponse:function(a){var b=d(a,"BEST BETS"),c=[];if(b.isValid){var e=b.parsedResponse,f=e.body&&e.body.bodyContent?e.body.bodyContent:!1;_.each(f,function(a){_.has(a,"block")&&_.each(a.block,function(a){if(_.has(a,"classifier")&&a.classifier.length){var b={};_.each(a.classifier,function(a){_.has(a,"type")&&"AirDateTime"===a.type&&(b.time=a.content),_.has(a,"type")&&"ProgramTitle"===a.type&&(b.title=a.content)}),c.push({time:b.time,title:b.title})}})})}return c}},new e}]),angular.module("boxHitService",["config","ngResource"]).factory("BoxHit",["$resource","Config",function(a,b){var c=b.getValuesBySelector("endpoint.api.user");return a(c+"boxhit",{},{ping:{method:"GET",isArray:!1}})}]),angular.module("config",["authenticationHandler","commonHeader","commonFooter","bottomDefault","serviceAppointment"]).factory("Config",[function(){var a="/api/",b=window.location.host,c="https://webmail.optimum.net/wm3-beta";/stage/.test(b)&&(c="/Webmail/SSOBroker?target=https://b1sc-r0ks.webmail.optimum.net/");var d=function(){var a="https://voice.optimum.net/";return/dev/.test(b)&&(a="http://dev2.voice.optimum.net"),/stage/.test(b)&&(a="https://stage2.voice.optimum.net"),a},e=function(){var a="/api/login/services/v1/sso/TransferService?target=http%3A%2F%2Frouter.optimum.net%2FbasicSettings.html";return/dev/.test(b)?a="/api/login/services/v1/sso/TransferService?target=http%3A%2F%2Fstage.router.optimum.net%2FbasicSettings.html":/stage/.test(b)&&(a="/api/login/services/v1/sso/TransferService?target=http%3A%2F%2Fstage.router.optimum.net%2FbasicSettings.html"),a},f=function(){return b.indexOf("dev-optimum.net")>-1?"6LehcN8SAAAAABGio3EhxsCI4NvfPMhqPq1JdmbR":"6LdXtuISAAAAAL2b633FAvwjKFoUAucvq0Fkoeql"},g={captcha_key:f(),cookie:{expirationTimeToCheck:1},deprecatedBrowserCheckTime:6048e5,endpoint:{api:{alert:a+"alert/services/v1/",appointment:a+"user/services/v1/appointment/",bestBets:a+"ipadproxy/_public/bestbets.jsp",billpay:a+"billpay/services/v1/billpay/",cablesupport:a+"support/services/v1/",cablesupport_public:a+"support/_public/services/v1/",dvr:a+"onet-webdvr/",epg:a+"epg/",epgImages:"/iptv-proxy/stage.imageproxy.iptv.optimum.net/images/",epgImagesAlt:"/iptv-proxy/epg.images.iptv.optimum.net/images/",faqSearch:"http://optimum.custhelp.com/app/answers/list/search/1/kw/",ipad:a+"ipadproxy/",login:a+"login/services/v1/",map:a+"map/services/v1/",map_public:a+"map/_public/services/v1/",mcafee:a+"login/services/v1/mcafee/",multiAuth:a+"login/services/v1/challenge/",networkLogo:"/iptv-proxy/epg.iptv.optimum.net/logos/optimum.net/",newOnDemand:"/iptv-proxy/vodimages.iptv.optimum.net/",outage:a+"outage/",outage_proxy:a+"outage-proxy/",phone:a+"phone/services/v1/phone/voicemail/",photos:a+"user/services/v1/photos/",preferences:a+"preferencesmanager/services/v1/preferences/",search:a+"search/search/",suggest:a+"search/suggest/",support:a+"support/services/v1/support/",support_public:a+"support/_public/services/v1/support/",supportedDevices:"//andauth.iptv.optimum.net/android/getSupportedDevices.jsp?cb=JSON_CALLBACK",tvListingsDVR:a+"tvlistings-webdvr/",user:a+"user/services/v1/user/",useragent:a+"onet/useragent/",vodimage:"/iptv-proxy/vodimages.iptv.optimum.net/mobile/image/asset/",weather:"/services/weather/today/weather.json",webmail:a+"webmail/",webDVR:a+"tvlistings-webdvr/json/webdvrservicejson.do",wifi:a+"wifi/services/v1/",genesys_onet:a+"onet/genesys/",genesys_endpoint:a+"../cvContactUs/rest/",pricing:a+"user/services/v1/pricing/",vod:a+"vod-webapp/services/v1/vod/"}},serviceAppointment:{bronxId:"07837",bronxOrderType:"TC",timeOutMilliSeconds:"600000"},formValidation:{firstNameInput:{hint:"Enter a first name",errors:{invalidChars:"Contains invalid characters",tooShort:"Input is too short"},success:"Valid first name"},lastNameInput:{hint:"Enter a last name",errors:{invalidChars:"Contains invalid characters",tooShort:"Input is too short"},success:"Valid last name"},zipCodeInput:{hint:"Enter a zip code",errors:{invalidChars:"Numbers only",tooLong:"5 number limit"},success:"Valid zip code"},optimumIdInput:{hint:"Enter an optimumId",errors:{tooShort:"Optimum ID is too short",tooLong:"Optimum ID is too long",beginChars:'Optimum ID cannot begin with "." or "-" or "_"',endChars:'Optimum ID cannot end with "." or "-" or "_"',unavailable:"Optimum ID is not unavailable"},success:"Optimum ID is available"}},imageSize:{net_poster_67x89:"net_poster_67x89",net_poster_109x145:"net_poster_109x145",net_poster_140x187:"net_poster_140x187",net_poster_218x290:"net_poster_218x290",net_poster_222x297:"net_poster_222x297"},link:{contactUs:"http://www.optimum.com/support/contact_us.jsp",supportEmail:"/support/livepage/email",supportLiveChat:"/support/livepage/chat",basePhoneMenuUrl:d(),managedRouterSettings:e(),mapDefault:"http://maps.google.com/",processLogin:"/api/login/services/v1/login/processLogin",processSignout:"/api/login/services/v1/signout",software:{desktop:{osx:{optimumApp:"http://www.optimum.net/laptop",wifiDownload:"https://img.optimum.net/images/feedmill/custFile/cablevision-both/1323301548897/WiFiRegister.dmg"},windows:{optimumApp:"http://www.optimum.net/laptop",wifiDownload:"https://img.optimum.net/images/feedmill/custFile/cablevision-both/1324486982514/setup.exe"}},mobile:{android:{optimumApp:"https://play.google.com/store/apps/details?id=com.optimum.unity.mobile",wifiDownload:"https://play.google.com/store/apps/details?id=com.cv.autosignin&hl=en",optimumDVR:"https://play.google.com/store/apps/details?id=com.optimum.rdvr.mobile",mapsURL:"geo:"},ios:{optimumApp:"https://itunes.apple.com/en/app/optimum/id387231038?mt=8&uo=4",wifiDownload:"https://itunes.apple.com/us/app/optimum-wifi-register/id490698227?mt=8&uo=4",wifiFinder:"https://itunes.apple.com/us/app/optimum-wifi-hotspot-finder/id529899484?mt=8&uo=4",mapsURL:"http://maps.apple.com/"},iosIpad:{optimumApp:"https://itunes.apple.com/us/app/optimum-for-ipad/id424612367?mt=8&uo=4"},kindle:{optimumApp:"http://www.amazon.com/Cablevisions-Systems-Corporation-Optimum-Edition/dp/B0079Q963K/ref=sr_1_1?s=mobile-apps&ie=UTF8&qid=1368543095&sr=1-1"}}},siteControl:"/api/login/services/v1/sso/hostways/transferService?ref=DDNS",speedtest:"http://speedcheck.optimum.net/",webHosting:{manage:"/api/login/services/v1/sso/hostways/transferService",upgrade:"http://www.optimum.com/home-internet-service/internet-speed/"},webmail:c},message:{api:{deviceExists:"Invalid MAC Address: Already in use.",error:"Service not available at this time",noWifiUsage:"No usage in the last thirty days."}},paths:{assets:{fonts:"/assets/fonts",images:"/assets/images"}},thePlatform:{guid:{internet:{aboutHotspots:"29364291514",autoSignin:"29363779604",security:"29358659940"},support:{landingPage:"xwlOU9acAgKO1VpGTqx7cJkR0trSAxlA"}}},timer:{webmail:3e5},webDVR:{allowMultipleDVRLookup:!0},vodTopPicks:{maxItems:10,autoCycleTime:7e3}},h={getValuesBySelector:function(a){var b={};
if("*"===a)b=_.cloneDeep(g);else{var c=_.cloneDeep(g),d=_.cloneDeep(g);_.each(a.split("."),function(a){if(!d.hasOwnProperty(a))throw new Error("unsupported property => "+a);var b=d[a];c=b,d=b}),b=c}return b},select:function(){return this.getValuesBySelector.apply(this,_.toArray(arguments))}},i=window.location.href;return h.isEspanolLang=!1,-1!==i.indexOf("espanol")&&(h.isEspanolLang=!0),h}]),angular.module("cookieLoggerService",[]).factory("CookieLogger",["$http",function(){function a(a){return a&&a.length?a.length:0}var b="/api/support/services/v1/log/cookie",c=function(a,c){var d;d=a.http?["http://www.optimum.net","http://optimum.net","https://www.optimum.net","http://espanol.optimum.net","https://espanol.optimum.net"]:a.nowww?["https://optimum.net","https://www.optimum.net","https://espanol.optimum.net"]:["https://www.optimum.net","https://espanol.optimum.net"];for(var e=function(a){return function(){a.remove()}},f=0;f<d.length;f++){var g=$("<img>"),h=e(g);g.error(h),g.on("load",h),c.host=d[f],g.attr("src",d[f]+b+"?"+$.param(c))}},d=function(a){var b="http:"===window.location.protocol,d="optimum.net"===window.location.hostname,e=_.random(1e6),f={nonce:e,cause:a};c({http:b,nowww:d},f)},e=function(){var b=a(document.cookie.match(/(^|;) *site=/g)),c=a(document.cookie.match(/(^|;) *site=[^n]/g)),e="http:"===window.location.protocol,f="optimum.net"===window.location.hostname;b>1||c>0?d("weird site cookie"):(e||f)&&d("weird URL")};return{logCookies:d,checkSanity:_.once(e)}}]),angular.module("cpcMobileHandler",[]).factory("CpcMobileHandler",[function(){var a=!1,b="",c={isCpcCheck:function(){for(var b=window.location.search.substr(1).split("&"),c={},d=0,e="";e=b[d];d++){var f=b[d].split("=");c[f[0]]=f[1]}var g=decodeURIComponent(c.referer);return a=!1,g.indexOf("cpcmobile")>-1&&(a=!0),a},getCpcMobile:function(){return b=c.getUrlParams("cpcmobile")},getUrlParams:function(a){for(var b=window.location.search.substring(1),c=b.split("&"),d=0;d<c.length;d++){var e=c[d].split("=");if(e[0]===a)return e[1]}return""}};return c}]),angular.module("creditCardTextResource",["payBillUtils","payBillResource"]).factory("CreditCardText",["PayBillService","PayBillUtils",function(a,b){function c(a){if(a.split(" ")&&a.split(" ").length>0&&(a=a.split(" ").join("").split("-").join("")),0===a.length||a.length<5)return a;var b=0,c="";for(b=0;b<a.length;b+=4)endLength=b+3>=a.length?a.length:b+4,b>0&&(c+=" "),c+=a.substring(b,endLength);return c}function d(a){var b={luhn_valid:!1,length_valid:!1};if(a=String(a),a.split(" ")&&a.split(" ").length>0&&(a=a.split(" ").join("")),0===a.length)return b;if(parseInt(a,10)<=10)return b;for(_i=0,_len=e.length;_len>_i;_i++)card=e[_i],a.match(card.pattern)&&(b.card_type=card);return b.card_type&&(is_valid_luhn(a)&&(b.luhn_valid=!0),is_valid_length(a,b.card_type)&&(b.length_valid=!0)),b}var e=[{name:"amex",pattern:/^3[47]/,valid_length:[15]},{name:"visa",pattern:/^4/,valid_length:[16]},{name:"mastercard",pattern:/^5[1-5]/,valid_length:[16]},{name:"discover",pattern:/^(6011|622(12[6-9]|1[3-9][0-9]|[2-8][0-9]{2}|9[0-1][0-9]|92[0-5]|64[4-9])|65)/,valid_length:[16]}];is_valid_luhn=function(a){var b,c,d,e,f,g;for(d=0,g=a.split("").reverse(),c=e=0,f=g.length;f>e;c=++e)b=g[c],b=+b,c%2?(b*=2,d+=10>b?b:b-9):d+=b;return 0===d%10},is_valid_length=function(a,b){for(i=0;i<b.valid_length.length;i++)if(a.length===b.valid_length[i])return!0;return!1};var f={setup:function(a,b,e){$("#"+b).live("blur",function(){a.cardValidated||($("#"+b).removeClass("cards--visa").removeClass("cards--mastercard").removeClass("cards--discover").removeClass("cards--amex").removeClass("cards--invalid"),""!==$("#"+b).val()&&$("#"+b).addClass("cards--invalid")),this.value=c(this.value)}),$("#"+b).live("input propertychange",function(){a.addPayModel.paymentAccountNumber=this.value,f.assessCreditCard(d(this.value),a,b,e)}).live("keydown",function(a){switch(a.keyCode){case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:case 96:case 97:case 98:case 99:case 100:case 101:case 102:case 103:case 104:case 105:case 8:case 9:case 37:case 39:case 46:case 32:a.shiftKey&&(a.preventDefault(),a.stopPropagation());break;case 67:case 86:case 88:var b=a.ctrlKey||a.metaKey;return b?void 0:(a.preventDefault(),a.stopPropagation(),!1);default:return a.preventDefault(),a.stopPropagation(),!1}}).live("keyup",function(){formattedVal=c($(this).val()),scrollPos=this.selectionStart,setScrollPos=!0,scrollPos>=this.value.length&&(setScrollPos=!1),this.value!==formattedVal&&(this.value=formattedVal,setScrollPos&&(this.selectionStart=scrollPos,this.selectionEnd=scrollPos))});var g=$.browser.msie&&parseInt($.browser.version,10)<9;g&&$("#"+b).live("keyup paste",function(){a.addPayModel.paymentAccountNumber=this.value,f.assessCreditCard(d(this.value),a,b,e)}),$("#"+b).live("focusout",function(){d(this.value).luhn_valid&&d(this.value).length_valid&&""!==this.value?$("#creditCardError").addClass("hidden"):$("#creditCardError").removeClass("hidden")}),$("#"+e).live("focusout",function(){0===this.value.length&&a.cardValidated&&(this.value=a.model.payNickName_CC_bk,a.$apply(function(){this.value=a.model.payNickName_CC_bk}))})},assessCreditCard:function(a,c,d,e){if(a){if(c.cardValidated=!1,$("#"+d).removeClass("cards--visa").removeClass("cards--mastercard").removeClass("cards--discover").removeClass("cards--amex").removeClass("cards--invalid"),c.addPayModel.cardType="",nickNameText="",a.card_type)switch(a.card_type.name.toLowerCase()){case"visa":c.addPayModel.cardType="V",nickNameText="Visa",$("#"+d).addClass("cards--visa");break;case"mastercard":c.addPayModel.cardType="M",nickNameText="Mastercard",$("#"+d).addClass("cards--mastercard");break;case"discover":c.addPayModel.cardType="D",nickNameText="Discover",$("#"+d).addClass("cards--discover");break;case"amex":c.addPayModel.cardType="A",nickNameText="Amex",$("#"+d).addClass("cards--amex")}a.length_valid&&a.luhn_valid?c.$apply(function(){c.addPayModel.paymentAccountNumber_CC=nickNameText,c.cardValidated=!0,unformattedText=$("#"+d).val().split(" ").join(""),c.model.payNickname_CC=nickNameText+"-"+unformattedText.substring(unformattedText.length-4,unformattedText.length),c.model.payNickName_CC_bk=c.model.payNickname_CC,c.pmSelected=c.model.payNickname_CC,cardNumber=$("#"+d).val().split(" ").join(""),c.isDebitCardType=!1,c.model.addDebit=!1,c.service.getCreditCardInfo({cardnumber:cardNumber,cardType:c.addPayModel.cardType},function(a){b.handleSuccessfullResponse(a,c,{noClear:!0})&&a.cardType&&"D"===a.cardType&&(c.model.addDebit=!0,c.isDebitCardType=!0,c.showDebitCheck=!1)},function(){})}):c.$apply(function(){c.cardValidated=!1,c.pmSelected="card",c.model.payNickname_CC="",c.model.payNickName_CC_bk=""})}else $("#"+e).val(""),c.$apply(function(){c.model.payNickName_CC_bk="",c.model.payNickname_CC=""})}};return f}]),angular.module("dmcaNoticesService",["config"]).factory("dmcaNoticesService",["$http","Config",function(a,b){function c(a){this.infringementTime=moment(a.acnsSourceInfringementTime,"YYYY-MM-DD HH:mm:ss").toDate(),this.arbitrationFiledDate=a.arbitrationFiledDate?Date.fromISO(a.arbitrationFiledDate):null,this.arbitrationStatus=a.arbitrationStatus,this.abuseIp=a.abuseIp,this.sourceHostname=a.acnsSourceHostname,this.sourceUsername=a.acnsSourceUsername,this.materialTitle=a.acnsMaterialTitle,this.materialFileName=a.acnsMaterialFileName,this.materialURL=a.acnsMaterialURL,this.sourcePort=a.acnsSourcePort,this.sourceApplication=a.acnsSourceApplication,this.sourceNumberOfFiles=a.acnsSourceNumberOfFiles,this.complainantEntity=a.acnsComplainantEntity,this.acnsComplainantId=a.acnsComplainantId,this.complainantId=a.acnsComplainantId,this.ticketId=a.ticketId,this.mouFlag="YES"===a.mouFlag.toUpperCase(),this.incidentLevel=a.incidentLevel,this.receivedDate=Date.fromISO(a.receivedDate),this.noticeId=a.noticeId,this.fileSize=a.acnsMaterialFilesize}var d="dmca/account_notices",e="dmca/ticket/notice",f="dmca/arbitration";return Date.fromISO=function(a){return moment(a).toDate()},{getTickets:function(e,f){var g=b.getValuesBySelector("endpoint.api.user")+d;a.get(g).success(function(a){var b=a.notices;e.call(this,_.map(b,function(a){return new c(a)}))}).error(function(a){console.log("[dmcaNoticesService] Failed to retrieve tickets from end point: "+g),f instanceof Function&&f.call(this,a)})},getTicketsAndTopData:function(e,f){var g=b.getValuesBySelector("endpoint.api.user")+d;a.get(g).success(function(a){console.log("DMCA Response is "+JSON.stringify(a));var b=a.notices,d=_.map(b,function(a){return new c(a)}),f=_.reduce(_.pluck(d,"arbitrationFiledDate"),function(a,b){return!a||b&&b>a?b:a},null);e.call(this,{notices:d,alertToFile:a.alertToFile,canFileChallenge:a.canFileChallenge,id:a.id,daysToFile:a.daysToFile,lastArbitrationDate:f})}).error(function(a){console.log("[dmcaNoticesService] Failed to retrieve tickets from end point: "+g),f instanceof Function&&f.call(this,a)})},getNotice:function(c,d,f){var g=b.getValuesBySelector("endpoint.api.user")+e+"/"+c;a.get(g).success(function(a){d.call(this,a)}).error(function(a){console.log("[dmcaNoticesService] Failed to retrieve ticket detail from end point: "+g),f instanceof Function&&f.call(this,a)})},sendArbitration:function(c,d){var e=b.getValuesBySelector("endpoint.api.user")+f;a.post(e).success(c).error(function(a){console.log("[dmcaNoticesService] Failed to submit an arbitration request from endpoint: "+e),d instanceof Function&&d.call(this,a)})}}}]),angular.module("downloadAssistant",["config"]).factory("navigator",function(){return window.navigator}).factory("DownloadAssistant",["Config","navigator",function(a,b){function c(a){this.name="IllegalStateException",this.message=a,this.toString=function(){return a}}var d=a.getValuesBySelector("*").link.software,e=_.extend(d.desktop,d.mobile),f=[{key:"osx",name:"Mac OS X",predicate:function(){return-1!==b.platform.toLowerCase().indexOf("mac")}},{key:"windows",name:"Windows",predicate:function(){return-1!==b.platform.toLowerCase().indexOf("win")}},{key:"android",name:"Android",predicate:function(){return(-1!==b.platform.toLowerCase().indexOf("android")||-1!==b.userAgent.toLowerCase().indexOf("android"))&&-1===b.userAgent.toLowerCase().indexOf("silk")}},{key:"iosIpad",name:"iOS (iPad)",predicate:function(){return-1!==b.platform.toLowerCase().indexOf("ipad")}},{key:"ios",name:"iOS (iPhone)",predicate:function(){return-1!==b.platform.toLowerCase().indexOf("iphone")||-1!==b.platform.toLowerCase().indexOf("ipod")}},{key:"kindle",name:"Kindle",predicate:function(){return-1!==b.userAgent.toLowerCase().indexOf("silk")}},{key:"linux",name:"Linux",predicate:function(){return-1!==b.platform.toLowerCase().indexOf("linux")&&-1===b.userAgent.toLowerCase().indexOf("android")}}],g=_.head(_.filter(f,function(a){return a.predicate()})),h=function(){if(!g)throw new c("[DownloadAssistant] no platform set (platform detection has failed).")};return{getPlatformURL:function(a,b){h();var c=b?b:g.key;return c in e?e[c][a]:e.windows[a]},getAllPlatformURLs:function(a,b){return _.foldr(f,function(c,d){return d.key in e&&a in e[d.key]&&(g!==d||!b)&&c.unshift({key:d.key,name:d.name,url:e[d.key][a]}),c},[])},getPlatformName:function(){return h(),g.name},detectionFailed:function(){return"undefined"==typeof g},detectionSucceeded:function(){return"undefined"!=typeof g}}}]),angular.module("dvrRecordingModel",["config"]).factory("recordingModel",["Config",function(){return function(a){function b(a){return moment(a.Program.StartTime).format("M/D")}function c(a){var b="";return a.Program.SeasonNumber&&(b+="S"+a.Program.SeasonNumber),a.Program.EpisodeNumber&&(b+=" E"+a.Program.EpisodeNumber),b}function d(a){function b(a){var b=_(a).keys().groupBy(function(a){return _.contains(h.accepted,a)?"accepted":"fallback"}).valueOf();return b.accepted=_.sortBy(b.accepted,function(a){return _.indexOf(h.accepted,a)}),b.fallback=_.sortBy(b.fallback,function(a){return _.indexOf(h.fallback,a)}),b}function c(a){var b=_.first(a.h),c=_.first(a.v);return c?g.preferred=c.ImgUrl:b&&!g.fallback&&(g.fallback=b.ImgUrl),g.preferred?!1:!0}function d(a){var b=_.first(a.h);return g.fallback=g.fallback||(b?b.ImgUrl:""),g.fallback?!1:!0}function e(a){var b=_(a).groupBy(function(a){return a.Width<a.Height?"v":"h"}).defaults({h:[],v:[]}).valueOf();return _.each(b,function(a,c){b[c]=_.sortBy(a,function(a){return-1*a.Width})}),b}var f=_.groupBy(a.ImageList,"Category");if(_.isEmpty(f))return a.thumbIsPreferred=!1,a.thumbUrl=null,void 0;var g={preferred:"",fallback:""},h={accepted:["Poster Art","Banner"],fallback:["Program Logo","Cast Ensemble","Cast in Character"]},i=b(f);_.each(i.accepted,function(a){return c(e(f[a]))}),g.preferred||g.fallback||_.each(i.fallback,function(a){return d(e(f[a]))}),a.thumbIsPreferred=Boolean(g.preferred),a.thumbUrl=g.preferred||g.fallback||null}function e(a){function b(a){return!Boolean(Number(a.format("m")))}var c,d;return c=moment(a.Program.StartTime),d=_.template('<span class="air-date"><%= date %></span> <span class="air-time"><%= time %></span>'),d({date:c.format("M/D"),time:c.format(b(c)?"h A":"h:mm A")})}function f(a){var b=[],c=moment(a.Program.duration),d=moment.duration(c.valueOf()).hours(),e=moment.duration(c.subtract(d,"hour").valueOf()).minutes();return d>0&&b.push(d+"h"),e>0&&b.push(e+"m"),b.join(" ")}function g(a){var b,c,d,e;return b=moment(),c=moment(a.Program.StartTime),d=a.Program.isRecorded,e=c.isBefore(moment().add("days",6))&&c.isAfter(b),d||e}if(_.isUndefined(a.Program))throw"Program attribute is undefined for recording";var h=moment(a.Program.StartTime,"MM-DD-YY HHmmss"),i=moment(a.Program.EndTime,"MM-DD-YY HHmmss");a.Program.StartTime=h.valueOf(),a.Program.EndTime=i.valueOf(),a.Program.ReleaseDate=moment(a.Program.ReleaseDate).valueOf();var j=moment();return a.Program.duration=i.valueOf()-h.valueOf(),a.Program.isRecorded=a.isRecorded,a.Program.isRecording=j.isAfter(h)&&j.isBefore(i),a.Program.isRecordingScheduled=!a.isRecorded,a.isDependable=g(a),a.displayShowTime=e(a),a.displayShowDate=b(a),a.displayDuration=f(a),a.displaySeasonEpisode=c(a),a.isDependable&&d(a),a.Program.EpisodeTitle=a.Program.EpisodeTitle||a.Title,a}}]),angular.module("epgRating",["config","oolCookie"]).factory("EPGRating",["$http","Config","ooluser",function(a,b,c){var d=b.getValuesBySelector("endpoint.api.ipad")+"userratings/",e=b.getValuesBySelector("endpoint.api.ipad")+"setuserratings/",f={se:"E",deviceId:c.deviceId},g={error:[{StatusCode:-1,StatusDescription:"eventId is required"}]},h={error:[{StatusCode:-2,StatusDescription:"starRating (0 <= starRating <= 4) is required"}]};return{get:function(b,c,e){var h,i={};return c=c||angular.noop,e=e||angular.noop,angular.isString(b)&&(b=parseInt(b,10)),!angular.isNumber(b)||isNaN(b)?(h=angular.copy(g),e(h,400,function(){},{}),h):(a.get(d,{params:angular.extend(f,{eventId:b})}).success(function(a,b,d,e){angular.extend(i,a),c(a,b,d,e)}).error(function(a,b,c,d){e(a,b,c,d)}),i)},set:function(b,c,d,i){var j,k={};return d=d||angular.noop,i=i||angular.noop,angular.isString(b)&&(b=parseInt(b,10)),angular.isString(c)&&(c=parseInt(c,10)),!angular.isNumber(b)||isNaN(b)?(j=angular.copy(g),i(j,400,function(){},{}),j):!angular.isNumber(c)||isNaN(c)||Math.floor(c)!==c||0>c||c>4?(j=angular.copy(h),i(j,400,function(){},{}),j):(a.get(e,{params:angular.extend(f,{eventId:b,userRating:c})}).success(function(a,b,c,e){angular.extend(k,a),d(a,b,c,e)}).error(function(a,b,c,d){i(a,b,c,d)}),k)}}}]),angular.module("errorHandler",[]).provider("errorHandler",[function(){var a;return a=!0,severityMap={ServiceError:"major"},{setShouldLog:function(b){return a=b,this},$get:["$rootScope","$injector",function(b,c){function d(a,c){var d=c?c+" "+a:a;e.error(d),b.error={message:d,type:severityMap[c]}}var e=a?c.get("$log"):{error:angular.noop};return d}]}}]),angular.module("miniGuideResource",["config","ngCookies","oolCookie"]).factory("MiniGuide",["$http","dateFilter","Config","$cookies","ooluser","$rootScope","$q",function(a,b,c,d,e,f,g){var h=c.getValuesBySelector("endpoint.api.ipad")+"miniguide/",i=c.getValuesBySelector("endpoint.api.ipad")+"remoteminiguide",j={contentType:"json",deviceType:"Web"},k={getHubId:function(a){return a?angular.isString(e.hubId)?e.hubId:"":angular.isString(e.ehubId)?e.ehubId:""},getItems:function(c,d,l){function m(a){var b;return angular.isString(a)&&(b=a.match(/^(\d{2})(\d{2})(\d{4})T(\d{2})(\d{2})$/))?new Date(b[3],b[1]-1,b[2],b[4],b[5]):a}function n(a){return angular.isString(a)?a.replace(/[^a-z\d\-]/gi,"-"):a}function o(a){var b,c,d,e;if(angular.isObject(a)&&angular.isObject(a.content)&&angular.isArray(a.content.programs))for(b=a.content.programs,c=b.length-1;c>=0;c--)d=b[c],angular.isString(d.st)&&angular.isDate(e=m(d.st))&&(d.startTime=e,angular.isNumber(d.d)&&(d.endTime=new Date(e.getTime()),d.endTime.setMinutes(d.endTime.getMinutes()+d.d)),angular.isNumber(d.eventId)&&(d.href="/tv/program/"+d.eventId+"/"+d.cs+"/"+(angular.isString(d.movies)&&"Y"===d.movies?"movie":"episode")+"/"+n(angular.isString(d.eptitle)&&""!==d.eptitle?d.eptitle:d.title))),angular.isString(d.quals)&&(d.qualifiers=d.quals.split(/,/)),d.episodeTitle=d.eptitle,angular.isUndefined(d.episodeinfo)&&(d.episodeinfo={title:d.episodeTitle})}function p(a){var c;if(angular.isObject(a)){if(angular.isDefined(a.isSD)){angular.isString(k.getHubId(a.isSD))&&""!==k.getHubId(a.isSD)&&(a.hubId=k.getHubId(a.isSD));try{delete a.isSD}catch(d){}}else a.hasOwnProperty("hubId")||angular.isString(k.getHubId(!1))&&""!==k.getHubId(!1)&&(a.hubId=k.getHubId(!1));if(a.hasOwnProperty("hubId")&&(!angular.isString(a.hubId)&&!angular.isNumber(a.hubId)||""===a.hubId))try{delete a.hubId}catch(d){}angular.isString(a.duration)&&a.duration.match(/^\d+$/)&&(a.duration=parseInt(a.duration,10)),angular.isNumber(a.duration)&&angular.isDate(c=m(a.starttime))&&(a.endtime=new Date(c.getTime()),a.endtime.setMinutes(c.getMinutes()+a.duration)),angular.isDate(a.starttime)&&(a.starttime=b(a.starttime,"MMddyyyyTHHmm")),angular.isDate(a.endtime)&&(a.endtime=b(a.endtime,"MMddyyyyTHHmm")),angular.isArray(a.callsigns)&&(a.callsigns=a.callsigns.join(","));try{delete a.duration}catch(d){}}return a}function q(){a.get(h,{params:p(angular.extend({},j,c))}).then(function(a){var b;return angular.isObject(a)&&angular.isString(b=a.data)&&-1!==b.indexOf('<?xml version="1.0" encoding="UTF-8"?><LoginStatus><Status><Code>6</Code><Message>We have performed a scheduled maintenance, please relaunch and log back into the application.</Message></Status></LoginStatus>')?(f.$broadcast("authenticationHandler:unauthenticated",a),g.reject(a)):a}).then(function(a){var b=a.data;o(b),angular.isObject(b.status)&&"0"===b.status.code&&angular.isObject(b.content)&&angular.isArray(b.content.programs)&&b.content.programs.length>0?(angular.extend(t,b),d(b)):l(b)},function(a){l(a.data)})}function r(){a.get(i,{params:p(angular.extend({},j,c))}).then(function(a){var b;return angular.isObject(a)&&angular.isString(b=a.data)&&-1!==b.indexOf('<?xml version="1.0" encoding="UTF-8"?><LoginStatus><Status><Code>6</Code><Message>We have performed a scheduled maintenance, please relaunch and log back into the application.</Message></Status></LoginStatus>')?(f.$broadcast("authenticationHandler:unauthenticated",a),g.reject(a)):a}).then(function(a){o(a.data),angular.extend(t,a.data),d(a.data)},function(a){l(a.data)})}function s(){return-1===document.title.search(/home/i)?!1:!0}var t={};return angular.isFunction(c)&&(angular.isFunction(d)&&(l=d),d=c,c={}),d=d||angular.noop,l=l||angular.noop,e.hasOOLSession&&!s()?q():r(),t}};return k}]),angular.module("moreLikeThisResource",["config","ngCookies","oolCookie"]).factory("MoreLikeThis",["$http","dateFilter","Config","$cookies","ooluser","$rootScope","$q",function(a,b,c,d,e,f,g){var h=c.getValuesBySelector("endpoint.api.ipad")+"morelikethis/",i={get:function(b,c,d){function i(a){return moment(a,"MM-DD-YY HHmm")}function j(a){return angular.isString(a)?a.replace(/[^a-z\d\-]/gi,"-"):a}function k(a){var b,c,d,e,f;if(angular.isObject(a)&&angular.isArray(a.result))for(b=a.result,c=b.length-1;c>=0;c--)d=b[c],angular.isString(d.EndTime)&&moment.isMoment(f=i(d.EndTime))&&(d.endTime=f),angular.isString(d.StartTime)&&moment.isMoment(e=i(d.StartTime))&&(d.startTime=e),d.isMovie=angular.isString(d.ProgramType)&&("TV Movie"===d.ProgramType||"Feature Film"===d.ProgramType||"Short Film"===d.ProgramType),angular.isNumber(d.Id)&&"EVENT"===d.Type&&(d.href="/tv/program/"+d.Id+"/"+d.CallSign+"/"+(d.isMovie?"movie":"episode")+"/"+j(d.Title))}var l={};return c=c||angular.noop,d=d||angular.noop,angular.isNumber(b)||angular.isString(b)&&b.match(/^\d+$/)?e.hasOOLSession?(a.get(h,{params:{eventId:b}}).then(function(a){var b;return angular.isObject(a)&&angular.isString(b=a.data)&&-1!==b.indexOf('<?xml version="1.0" encoding="UTF-8"?><LoginStatus><Status><Code>6</Code><Message>We have performed a scheduled maintenance, please relaunch and log back into the application.</Message></Status></LoginStatus>')||angular.isObject(a)&&angular.isObject(a.data)&&angular.isArray(a.data.error)&&a.data.error.length>0&&1010===a.data.error[0].StatusCode?(f.$broadcast("authenticationHandler:unauthenticated",a),g.reject(a)):a}).then(function(a){var b=a.data;k(b),angular.isArray(b.error)&&b.error.length>0&&angular.isObject(b.error[0])&&"SUCCESS"===b.error[0].StatusDescription&&angular.isArray(b.result)&&b.result.length>0?(angular.extend(l,b),c(b)):d(b)},function(a){d(a.data)}),l):(d({Message:"No session.  Login required.",description:"",debug:{exception:"",exceptionMessage:"",requestScope:""}}),null):(d({Message:"eventId parameter is required",description:"",debug:{exception:"",exceptionMessage:"",requestScope:""}}),null)}};return i}]),angular.module("mostWatchedResource",["config"]).factory("MostWatched",["$http","dateFilter","Config",function(a,b,c){var d=c.getValuesBySelector("endpoint.api.ipad")+"mostwatched/",e={format:"json",hubId:"105"},f=100*Math.floor((new Date).getFullYear()/100),g={getItems:function(b,c,g){function h(a){var b;return angular.isString(a)&&(b=a.match(/^(\d{2})-(\d{2})-(\d{2}) (\d{2})(\d{2})$/))?new Date(f+b[3],b[1]-1,b[2],b[4],b[5]):a}function i(a){return angular.isString(a)?a.replace(/[^a-z\d\-]/gi,"-"):a}function j(a){var b,c,d,e;if(angular.isObject(a)&&angular.isObject(a.result)&&angular.isArray(a.result.MostWatched))for(b=a.result.MostWatched,c=b.length-1;c>=0;c--)d=b[c],angular.isString(d.StartTime)&&angular.isDate(e=h(d.StartTime))&&(d.StartTime=e),angular.isString(d.EndTime)&&angular.isDate(e=h(d.EndTime))&&(d.EndTime=e),angular.isString(d.quals)&&(d.qualifiers=d.quals.split(/,/)),d.isMovie=angular.isString(d.ProgramType)&&("TV Movie"===d.ProgramType||"Feature Film"===d.ProgramType||"Short Film"===d.ProgramType),d.isSeries=angular.isString(d.ProgramType)&&"Series"===d.ProgramType,angular.isNumber(d.EventId)&&(d.href="/tv/program/"+d.EventId+"/"+d.CallSign+"/"+(d.isMovie?"movie":d.isSeries?"series":"episode")+"/"+i(d.Title))}var k={};return angular.isFunction(b)&&(angular.isFunction(c)&&(g=c),c=b,b={}),c=c||angular.noop,g=g||angular.noop,a.get(d,{params:angular.extend(b,e)}).success(function(a){j(a),angular.extend(k,a),c(a)}).error(function(a){g(a)}),k}};return g}]),angular.module("moveTransferService",["ngResource"]).factory("MoveTransferService",["$resource","$http",function(){var a={ebillResponse:{},selectedAccountNum:""},b=function(b){a.ebillResponse=b},c=function(b){a.selectedAccountNum=b},d=function(b){a.sysDate=b},e=function(){return a},f=function(){return a.ebillResponse},g=function(){return a.selectedAccountNum};return{setEBillResponse:b,setSystemDate:d,getModel:e,getEbillResponse:f,setSelectedAccountNum:c,getSelectedAccountNum:g}}]),angular.module("movieCart",["onDemandResource"]).factory("movieCart",["OnDemand",function(a){return a.MovieCart}]),angular.module("networkSettings",["ngResource","config"]).factory("networkSettings",["$resource","Config","$http","$q",function(a,b,c,d){function e(a,b,d,e){return b=b||angular.noop,d=d||angular.noop,e=e||angular.noop,c.post(i,a,{params:{contentType:"json",deviceId:a.deviceId,deviceType:"STB"}}).then(function(a){var c;angular.isObject(a)&&200===a.status&&angular.isObject(c=a.data)&&angular.isObject(c=c.status)&&angular.isString(c=c.message)?"VALID"===c?b(a):"INVALID"===c?d(a):e(a):e(a)})}var f=b.getValuesBySelector("endpoint.api.ipad")+"getNetworkSettings.jsp",g=b.getValuesBySelector("endpoint.api.ipad")+"setNetworkSettings.jsp",h=b.getValuesBySelector("endpoint.api.ipad")+"copyNetworkSettings.jsp",i=b.getValuesBySelector("endpoint.api.ipad")+"validatePIN.jsp",j={contentType:"json",deviceType:"STB"},k=function(){},l=a(g,j);return k.get=function(a,b,e){var g=new k;return angular.isFunction(a)&&(e=b,b=a,a={}),b=b||angular.noop,e=e||angular.noop,c.get(f,{params:angular.extend({},j,a||{})}).then(function(a){return angular.isString(a.data)&&(a.data={message:a.data}),a.status>=200&&a.status<300&&angular.isObject(a.data)&&angular.isObject(a.data.status)&&("0"===a.data.status.code||0===a.data.status.code)?a:d.reject(a)},function(a){return angular.isString(a.data)&&(a.data={message:a.data}),a.status>=200&&a.status<300&&angular.isObject(a.data)&&angular.isObject(a.data.status)&&("0"===a.data.status.code||0===a.data.status.code)?a:d.reject(a)}).then(function(a){angular.extend(g,a.data),b(g,a.headers)},e),g},k.prototype.$save=function(a,b){var c=this;return a=a||angular.noop,b=b||angular.noop,l.prototype.$save.apply(this.content,[function(d){angular.isObject(d.status)&&"SUCCESS"===d.status.message?(angular.extend(c,d),a.apply(this,Array.prototype.slice.apply(arguments))):b.apply(this,Array.prototype.slice.apply(arguments))},b])},k.save=l.save,k.copy=function(a,b,d,e,f){return e=e||angular.noop,f=f||angular.noop,angular.isString(a)&&""!==a?angular.isString(b)&&""!==b?angular.isObject(d)?c.post(h,d,{params:{contentType:"json",sourceDeviceId:a,targetDeviceId:b,deviceType:"STB"}}).success(e).error(f):(f("settings is required"),void 0):(f("to device id is required"),void 0):(f("from device id is required"),void 0)},k.validatePCPIN=function(a,b,c,d,f){return angular.isString(a)&&""!==a?angular.isString(b)&&""!==b?(e({deviceId:a,settings:[{setting:[{value:[b],group:"device",name:"parental_control_pin"}],type:"Parental Controls"}]},c,d,f),void 0):(f("pin is required"),void 0):(f("device id is required"),void 0)},k.validatePurchasePIN=function(a,b,c,d,f){return angular.isString(a)&&""!==a?angular.isString(b)&&""!==b?(e({deviceId:a,settings:[{setting:[{value:[b],group:"device",name:"purchase_pin"}],type:"Purchasing"}]},c,d,f),void 0):(f("pin is required"),void 0):(f("device id is required"),void 0)},k}]),angular.module("onDemandResource",["config","oolCookie","alertModal","l"]).factory("OnDemand",["$http","$q","Config","$log","ooluser","alertModal","l",function(a,b,c,d,e,f,g){function h(){"undefined"!=typeof reporting&&(s.events="event9",reporting.click())}function i(){}function j(a){return angular.isArray(a)?_.map(a,k):(angular.isObject(a)&&(angular.isObject(a.filteredAssetList)&&angular.isArray(a.filteredAssetList.assets)&&a.filteredAssetList.assets.length>0&&(a.filteredAssetList.assets=j(a.filteredAssetList.assets)),angular.isArray(a.assets)&&(a.assets=j(a.assets)),angular.isObject(a.ribbonList)&&angular.isArray(a.ribbonList.ribbons)&&_.each(a.ribbonList.ribbons,function(a){angular.isArray(a.assets)&&(a.carouselItems=_.map(a.assets,function(a){return k(a).toCarouselItem()}))})),void 0)}function k(a){var b;if(angular.isString(a.endDt))try{a.endDate=moment(a.endDt,"MM/DD/YYYY HH:mm:ss").toDate()}catch(c){}return(angular.isNumber(b=a.price)||angular.isString(a.price)&&a.price.match(/^\d+(?:\.\d*)?$/)&&angular.isNumber(b=parseFloat(a.price)))&&(a.priceBadge=0===b?0:"$"+b),_.extend(new i,a)}var l,m,n=c.getValuesBySelector("endpoint.api.ipad")+"vodservice/mobile/getFilters",o=c.getValuesBySelector("endpoint.api.ipad")+"vodservice/mobile/getNewlyOnDemand",p=c.getValuesBySelector("endpoint.api.ipad")+"vodservice/mobile/getRibbons",q=c.getValuesBySelector("endpoint.api.ipad")+"vodservice/mobile/getTopCategories",r=c.getValuesBySelector("endpoint.api.ipad")+"vodservice/mobile/getCategoryDetail",t=c.getValuesBySelector("endpoint.api.ipad")+"vodservice/mobile/getAssetsByFilter",u=c.getValuesBySelector("endpoint.api.ipad")+"vodservice/mobile/getAssetsById",v=c.getValuesBySelector("endpoint.api.vodimage"),w="?"+(new Date).getTime(),x=!1,y={},z={},A=[],B=[],C={ids:[],assets:[],carouselItems:[],stale:(new Date).getTime()},D={},E={},F=function(a){var b,c,d=["MPAA-NC-17"];if(angular.isArray(a))for(b=0;b<a.length;b++)c=a[b],angular.isObject(c)&&(angular.isString(c.rating)&&_.contains(d,c.rating)?(a.splice(b,1),b--):251409===c.id&&(a.splice(b,1),b--));else angular.isObject(a)&&(a.hasOwnProperty("filteredAssetList")?F(a.filteredAssetList):a.hasOwnProperty("assets")?F(a.assets):angular.isObject(a.ribbonList)&&angular.isArray(a.ribbonList.ribbons)&&_.each(a.ribbonList.ribbons,function(a){angular.isArray(a.assets)&&F(a.assets)}))};return m=function(){var f={method:"GET",cache:!1,headers:{"Content-Type":"application/json; charset=utf-8"}},g=angular.extend({},f,{cache:!0}),i=function(b,e,g){var h=c.getValuesBySelector("endpoint.api.ipad")+"moviecartremove/",i={};e=e||angular.noop,g=g||angular.noop,b?(i.assetId=b,a.get(h,_.extend(f,{params:i})).success(function(a,b,c,f){angular.isObject(a)&&angular.isArray(a.error)&&a.error.length>0&&angular.isObject(a.error[0])&&angular.isString(a.error[0].StatusDescription)&&"SUCCESS"===a.error[0].StatusDescription?(d.log("Removed to movie cart"),e(a,b,c,f)):g(a,b,c,f)}).error(function(a,b,c,e){d.error(a,b,c,e),g(a,b,c,e)})):g("Error: No assetId provided")},j={contains:function(a,b,c){angular.isObject(C)&&null!==C&&!C.stale?b(_.where(C.ids,{AssetId:a}).length>0||_.where(C.assets,{id:a}).length>0):j.getItems(function(c){angular.isObject(c)&&angular.isArray(c.ids)&&b(_.where(c.ids,{AssetId:a}).length>0||_.where(c.assets,{id:a}).length>0)},c)},getItems:function(f,h,i,j){function k(a){return _.isObject(a)}var m=c.getValuesBySelector("endpoint.api.ipad")+"moviecart/",n=(new Date).getTime();return f=f||angular.noop,h=h||angular.noop,e.hasOOLSession?(angular.isNumber(C.stale)&&(w="?"+C.stale),a.get(m+w,g).then(function(a){return k(a.data)?a:b.reject(a.data)}).then(function(a){function b(){function b(){C.assets.length>C.ids.length&&(C.assets.length=C.ids.length),C.carouselItems.length>C.ids.length&&(C.carouselItems.length=C.ids.length),_.each(a.data.result.cartElements,function(a,b){if(D.hasOwnProperty(a.AssetId)){if(j&&b>=j)return!1;C.assets[b]=D[a.AssetId],C.carouselItems[b]=D[a.AssetId].toCarouselItem()}})}var c=[];if(x)return d.log("Already hydrating"),void 0;if(x=!0,angular.isObject(a)&&angular.isObject(a.data)&&angular.isObject(a.data.result)&&angular.isArray(a.data.result.cartElements))if(_.each(a.data.result.cartElements,function(a,b){if(!D.hasOwnProperty(a.AssetId)){if(j&&b>=j)return!1;c.push(a.AssetId)}}),c.length>0)l.getByIds(c,function(c){if(angular.isObject(c)&&angular.isArray(c.assets)){for(_.each(a.data.result.cartElements,function(a){var b=_.filter(c.assets,{id:a.AssetId});0===b.length?d.warn("No asset data for asset id",a.AssetId):(D[a.AssetId]=b[0],b.length>1&&d.warn("Found more than one asset for asset id",a.AssetId,b))}),b();A.length>0;)A.pop()(C);B.length=0}else{for(;B.length>0;)B.pop()(c);A.length=0}x=!1},function(){for(x=!1;B.length>0;)B.pop().apply(this,Array.prototype.slice.apply(arguments));A.length=0});else{for(b(),x=!1;A.length>0;)A.pop()(C);B.length=0}}C.stale=C.stale&&(C.stale<n?!1:C.stale),angular.isObject(a)&&angular.isObject(a.data)&&angular.isObject(a.data.result)&&angular.isArray(a.data.result.cartElements)?(C.ids.length=0,_.each(a.data.result.cartElements,function(a){C.ids.push(a)})):(C.ids.length=0,C.assets.length=0,C.carouselItems.length=0),i?(A.push(f),B.push(h)):f(C),b()},function(a){h(a)}),void 0):(h({Message:"No session.  Login required.",description:"",debug:{exception:"",exceptionMessage:"",requestScope:""}}),void 0)},addItem:function(b,e,g){var i=c.getValuesBySelector("endpoint.api.ipad")+"moviecartadd/",k={};
e=e||angular.noop,g=g||angular.noop,b?(k.assetId=b,a.get(i,_.extend(f,{params:k})).success(function(a,b,c,f){var i;angular.isObject(a)&&angular.isArray(a.error)&&a.error.length>0&&angular.isObject(a.error[0])?i=a.error[0]:angular.isObject(a)&&angular.isObject(a.error)&&angular.isObject(a.error.MobileResponse)&&(i=a.error.MobileResponse),angular.isObject(i)&&angular.isString(i.StatusDescription)&&"SUCCESS"===i.StatusDescription?(d.log("Added to movie cart"),h(),C.stale=(new Date).getTime(),j.getItems(),e(a)):g(a,b,c,f)}).error(function(a,b,c,e){d.error(a,b,c,e),g(a,b,c,e)})):g("Error: no assetId provided")},removeMultipleItems:function(a,b,c,d){function e(){var b=null;a.length>0?(b=a.shift(),angular.isObject(b)&&b.hasOwnProperty("id")&&(b=b.id),angular.isString(b)&&b.match(/^\d+$/)&&(b=parseInt(b,10)),angular.isNumber(b)?i(b,function(a,c,f,g){h.removed.push(b),d(h,a,c,f,g),e()},function(a,c,e,g){h.failed.push(b),d(h,a,c,e,g),f(a,c,e,g)}):(h.failed.push(b),d(h,data,status,headers,config),f("Expected asset id to be a Number, numeric String, or Object with 'id' property"))):g()}function f(a,b,d,e){C.stale=(new Date).getTime(),j.getItems(),c(h,a,b,d,e)}function g(){C.stale=(new Date).getTime(),j.getItems(),b(h)}var h={removed:[],failed:[],remaining:[]};b=b||angular.noop,c=c||angular.noop,d=d||angular.noop,angular.isNumber(a)&&(a=[a]),angular.isArray(a)&&a.length>0?(a=angular.copy(a),h.remaining=a,e()):c(h,"Error: No assetId provided")},removeItem:function(a,b,c){b=b||angular.noop,i(a,function(a,c,d,e){C.stale=(new Date).getTime(),j.getItems(),b(a,c,d,e)},c)}};return j}(),i.prototype.getArtwork=function(){return v+this.id+"?deviceName=iPad&artName=VOD%20-%20POSTERS"},i.prototype.cart=function(){var a=this;return angular.isUndefined(this._inCartObject)&&(this._inCartObject={}),m.contains(this.id,function(b){a._inCartObject.inCart=b,a._inCartObject.notInCart=!b}),this._inCartObject},i.prototype.addToCart=function(a,b){var c=this;m.addItem(this.id,function(){c.cart(),angular.isFunction(a)&&a.apply(this,Array.prototype.slice.apply(arguments))},b)},i.prototype.removeFromCart=function(a,b){var c=this;m.removeItem(this.id,function(){c.cart(),angular.isFunction(a)&&a.apply(this,Array.prototype.slice.apply(arguments))},b)},i.prototype.toCarouselItem=function(){var a,b,c=this,d={label:"Add to Cart",icon:"icon-shopping-cart",action:function(){var a=function(){m.addItem(c.id,function(){b.buttons=[e]},function(){f.create({message:g.cart.errorInitiallyAddingItem,ctas:[{label:g.cart.buttonTryAgainSimple,result:"retry"}]}).then(function(b){"retry"===b&&a()})})};a()}},e={label:"Remove",icon:"icon-shopping-cart",action:function(){var a=function(){m.removeItem(c.id,function(){b.buttons=[d]},function(){f.create({message:g.cart.errorRemovingItem,ctas:[{label:g.cart.buttonTryAgainSimple,result:"retry"}]}).then(function(b){"retry"===b&&a()})})};a()}};return angular.isObject(this._carouselItem)?b=this._carouselItem:E.hasOwnProperty(this.id)?b=this._carouselItem=E[this.id]:(b={title:this.title,callsign:this.pcl,artwork:this.getArtwork(),href:"/tv/on-demand/detail/"+this.id+".html",action:function(){document.location=b.href}},this._carouselItem=E[this.id]=b,(angular.isNumber(a=this.price)||angular.isString(this.price)&&this.price.match(/^\d+(?:\.\d*)?$/)&&angular.isNumber(a=parseFloat(this.price)))&&(b.priceBadge=0===a?0:"$"+a),m.contains(this.id,function(a){b.buttons=[a?e:d]}),b)},l={MovieCart:m,getByIds:function(b,c,d){var e={};return c=c||angular.noop,d=d||angular.noop,angular.isNumber(b)&&(b=[b]),angular.isArray(b)&&0!==b.length?(a.post(u,{assetIdList:b,pageNum:1,pageSize:b.length,sortField:"A-Z"}).success(function(a,b,d,f){j(a),angular.extend(e,a),c(a,b,d,f)}).error(function(a,b,c,e){d(a,b,c,e)}),e):(d("Error: no ids provided"),null)},getFilters:function(b,c){var d={};return b=b||angular.noop,c=c||angular.noop,a.get(n).success(function(a,e,f,g){"OK"===a.message&&angular.isObject(a.filterList)&&angular.isArray(a.filterList.filters)?(angular.extend(d,a),b(a,e,f,g)):c(a,e,f,g)}).error(function(a,b,d,e){c(a,b,d,e)}),d},addAssetMethodsToAsset:k,getRibbons:function(b,c){var d={};return b=b||angular.noop,c=c||angular.noop,a.get(p).success(function(a,e,f,g){"OK"===a.message?(F(a),j(a),angular.extend(d,a),b(a,e,f,g)):c(a,e,f,g)}).error(function(a,b,d,e){c(a,b,d,e)}),d},getTopCategories:function(b,c){var d={};return b=b||angular.noop,c=c||angular.noop,a.get(q).success(function(a,e,f,g){"OK"===a.message?(angular.extend(d,a),b(a,e,f,g)):c(a,e,f,g)}).error(function(a,b,d,e){c(a,b,d,e)}),d},getCategoryDetail:function(b,c,d){var e={};return c=c||angular.noop,d=d||angular.noop,angular.isObject(b)?(a.post(r,b).success(function(a,b,f,g){"OK"===a.message?(angular.extend(e,a),c(a,b,f,g)):d(a,b,f,g)}).error(function(a,b,c,e){d(a,b,c,e)}),e):(d("Request object is required."),{})},getByFilters:function(b,c,d){var e,f,g,h={};if(c=c||angular.noop,d=d||angular.noop,angular.isObject(b)&&angular.isDefined(b.categoryId)&&!angular.isNumber(b.categoryId)&&(!angular.isString(b.categoryId)||!b.categoryId.match(/^\d+$/)))try{delete b.categoryId}catch(i){}return!angular.isObject(b)||(!angular.isArray(b.filterIds)||b.filterIds.length<1||!(angular.isNumber(b.filterIds[0])||angular.isString(b.filterIds[0])&&b.filterIds[0].match(/^\d+$/)))&&angular.isUndefined(b.categoryId)?(d("Error: no filterIds nor categoryId provided"),null):(e=_.extend({},{pageSize:"100",pageNum:"1",includeIndex:"true"},b),y.hasOwnProperty(f=angular.toJson(e))?(g=y[f],angular.extend(h,g.data),c(g.data,g.status,g.headers,g.config)):z.hasOwnProperty(f)?(z[f].successes.push(c),z[f].errors.push(d),h=z[f].result):(z[f]={successes:[c],errors:[d],result:h},a.post(t,e).success(function(a,b,c,d){for(F(a),j(a),angular.extend(h,a),y[f]={data:a,status:b,headers:c,config:d};z[f].successes.length>0;)z[f].successes.pop()(a,b,c,d);try{delete z[f]}catch(e){}}).error(function(a,b,c,d){for(;z[f].errors.length>0;)z[f].errors.pop()(a,b,c,d);try{delete z[f]}catch(e){}})),h)},getForNetwork:function(b,c,d){var e={};return c=c||angular.noop,d=d||angular.noop,angular.isString(b)?(b=b.toUpperCase(),a.get(n).success(function(f){var g,h,i;if(angular.isObject(f)&&"OK"===f.message&&angular.isObject(f.filterList)&&angular.isArray(h=f.filterList.filters)){for(g=h.length-1;g>=0;g--)angular.isObject(h[g])&&angular.isString(h[g].filterValue)&&h[g].filterValue.toUpperCase()===b&&(i=h[g].filterId);angular.isUndefined(i)?d("No filter found for callsign "+b,f):a.post(t,{filterIds:[i],pageSize:"100",pageNum:"1"}).success(function(a,b,d,f){F(a),j(a),angular.extend(e,a),c(a,b,d,f)}).error(function(a,b,c,e){d(a,b,c,e)})}else d("Malformed response from filter call",f)}).error(function(a,b,c,e){d(a,b,c,e)}),e):(d("Error: no callsign provided"),null)},getNewlyOnDemand:function(b,c){var d={};return b=b||angular.noop,c=c||angular.noop,a.get(o).success(function(a,e,f,g){"OK"===a.message&&angular.isArray(a.assets)?(F(a),j(a),angular.extend(d,a),b(a,e,f,g)):c(a,e,f,g)}).error(function(a,b,d,e){c(a,b,d,e)}),d}}}]),angular.module("onetCookies",[]).factory("Cookies",[function(){var a={};return a.getCookie=function(a){for(var b=escape(a),c=document.cookie.split(";"),d=c.length,e=0;d>e;e++){var f=$.trim(c[e]);if(0===f.lastIndexOf(b+"=",0))return unescape(f.split("=")[1])}return null},a.setCookie=function(a,b,c){if(!_.isObject(c))throw"Cookies.setCookie options must be provided";var d="",e=c.path;if(_.isUndefined(e))throw"Cookies.setCookie path must be provided. Use null if current path desired";_.isUndefined(c.expires)||(d+="; expires="+c.expires),_.isNull(e)||(d+="; path="+e),document.cookie=escape(a)+"="+escape(b)+d},a.deleteCookie=function(b,c){c.expires=new Date(0).toGMTString(),a.setCookie(b,"",c)},a}]),angular.module("oolCookie",["ngCookies","config","userLogin"]).factory("ooluser",["$cookies","Config","userLogin","$log",function(a,b,c,d){var e="x-ooluser",f={MILLI_TO_SECONDS:1e3,SECONDS_IN_HOUR:3600,SESSION_IN_MILLIS:3888e6},g={},h=function(a){var c=!1,d=b.getValuesBySelector("cookie.expirationTimeToCheck"),e=(new Date).getTime(),g=e/f.MILLI_TO_SECONDS,h=g-a,i=Math.round(h/f.SECONDS_IN_HOUR);return i>=d&&(c=!0),c},i=function(a){var b=new Date(a).toUTCString();return b},j=function(a){var b=window.location.hostname.replace(/^[\d\D]*?([^\.]+\.[^\.]+)\.?$/,"$1"),c=angular.toJson(a),d=(new Date).getTime()+f.SESSION_IN_MILLIS,e=i(d),g=escape("oolp_")+"="+escape(c)+";path=/;domain="+b+";expires="+e;return g},k=function(a){return angular.fromJson(a)},l=function(){return{hasOOLSession:!1}};try{a.oolp_&&!a.ools_?(g=l(),window.location.replace(b.getValuesBySelector("link.processSignout")+"?referer="+encodeURIComponent(window.location))):a.oolp_?(g=angular.fromJson(a.oolp_),g.t&&h(g.t)&&c.refreshOoluserCookie().then(function(a){var b=decodeURIComponent(a.headers()[e]);console.log(b),g=k(b),g.hasOOLSession=!0,document.cookie=j(g)},function(){d.warn("cookie NOT refreshed successfully")}),g.hasOOLSession=!0):g=l()}catch(m){d.error(m),g=l()}return g.isDisconnected=function(a){this.hasOwnProperty("status")&&g.status!==!0?a(this.status):this._userService.isDisconnected().then(function(b){angular.isObject(b)&&b.hasOwnProperty("data")&&b.data.hasOwnProperty("disconnected")?(g.status=b.data.disconnected,document.cookie=j(g),a(b.data.disconnected)):console.log("Disconnected call failed",arguments)},function(){console.log("Disconnected call failed",arguments)})},g}]),angular.module("outageService",["config","oolCookie","userService","predictableJSONP"]).factory("Outage",["$http","Config","ooluser","User","$q","PredictableJSONP",function(a,b,c){var d=function(a){if(void 0===a||"#"===a.substr(0,1))return a;var b=/(.*?)rgb\((\d+), (\d+), (\d+)\)/.exec(a),c=parseInt(b[2],10),d=parseInt(b[3],10),e=parseInt(b[4],10),f=e|d<<8|c<<16;return b[1]+"#"+f.toString(16)},e={Blue:"#19bce4",Purple:"#aa50aa",Teal:"#43d1b9",Orange:"#f58921",Green:"#a8d228",Yellow:"#f8bc00"},f={colorsRGB:{Blue:"rgb(25, 188, 228)",BlueS:"rgb(0, 172, 209)",Purple:"rgb(170, 80, 170)",PurpleS:"rgb(157, 71, 157)",Teal:"rgb(67, 209, 185)",TealS:"rgb(69, 190, 167)",Orange:"rgb(245, 137, 33)",OrangeS:"rgb(240, 122, 27)",Green:"rgb(168, 210, 40)",Yellow:"rgb(248, 188, 0)",YellowS:"rgb(255, 168, 0)"},colors:{Blue:"Blue",Purple:"Purple",Teal:"Teal",Orange:"Orange",Green:"Green",Yellow:"Yellow"}},g=$(".global-header").css("background-color");g=d(g),g===e.Blue?g=f.colors.Blue:g===e.Green?g=f.colors.Green:g===e.Orange?g=f.colors.Orange:g===e.Purple?g=f.colors.Purple:g===e.Teal?g=f.colors.Teal:g===e.Yellow&&(g=f.colors.Yellow);var h=function(){var d=b.getValuesBySelector("endpoint.api.cablesupport");b.getValuesBySelector("endpoint.api.outage_proxy"),angular.fromJson;var e=c.eoid?c.eoid:"",f={GET_OUTAGES:"outage/notification"},h=function(b,c,d,e,f){var g={method:c||"GET",url:b,data:d||null,headers:f||null,transformResponse:e||null};return a(g).success(function(a){return a}).error(function(){return null})};this.logNotificationData=function(a,c,d){var e=b.getValuesBySelector("endpoint.api.cablesupport"),f=e+"/log/servicestatus",g={symptom:a,services:c,confirmOutage:d};return h(f,"POST",g,i,{"Content-Type":"application/json"})};var i=function(a){return a};this.getOutagesPromise=function(){var a=d+f.GET_OUTAGES+"?eoid="+e+"&callback=JSON_CALLBACK"+"&_="+(new Date).getTime();return h(a,"JSONP",null,null,null)},this.getProcessedOutagePromise=_.once(function(){return a.get(d+f.GET_OUTAGES+"?eoid="+e).then(function(a){var b=a.data;return b},function(){var a={outageStatus:"error",accountSummary:null,plannedMaintenance:null,outageMessage:null};return a})});var j={NO_OUTAGE:"No outage",OUTAGE_ON_ACCOUNT:"Service outage",OFFLINE:"Equipment offline",NON_PAY:"Your account is past due",VOD_HOLD:"Your account is past due",PLANNED_MAINTENANCE:"Network maintenance",NODE_DISTRESS:"Brief service interruption detected",RECENTLY_CLEARED:"Service restored","USER NOT LOGGED IN":"Check your service status here",ERROR:""},k={menu:{},alert:{},banner:{"USER NOT LOGGED IN":"Sign in to check your service status.",RECENTLY_CLEARED:"Service restored",NO_OUTAGE:"No outage",OFFLINE:"Equipment offline",OUTAGE_ON_ACCOUNT:"Service outage",NODE_DISTRESS:"Brief service interruptions detected",PLANNED_MAINTENANCE:"Network maintenance",NON_PAY:"Your account is past due",VOD_HOLD:"Your account is past due",ERROR:"Your service status is not available at this time. Please try again later."}},l={ERROR:"Customer_not_authenticated_question_mark.png",OUTAGE_ON_ACCOUNT:"Outage_exclamation_point.png",RECENTLY_CLEARED:"Cleared_outage_thumbs_up.png",NO_OUTAGE:"No_outage_check_mark.png",OFFLINE:"Device_offline_tools.png","USER NOT LOGGED IN":"Customer_not_authenticated_question_mark.png",PLANNED_MAINTENANCE:"maintenance_icon_"+g+".png",NODE_DISTRESS:"node_icon_"+g+".png",NON_PAY:"Outage_exclamation_point.png",VOD_HOLD:"Outage_exclamation_point.png"};this.outageCopy=function(a,b){return k[a][b]||j[b]},this.outageIcon=function(a){var b=l[a];return b?"/assets/images/outage/"+b:null}};return new h}]),angular.module("payBillUtils",["payBillResource"]).factory("PayBillUtils",["$rootScope","PayBillService",function(a,b){var c={success:{general:"Completed successfully.",addPaymentMethod:"Added Payment Method successfully.",updatePaymentMethod:" updated successfully.",deletePaymentMethod:" has been successfully deleted."},error:{general:"This information is not currently available. Please try again later"}},e={normal:{scheduled:{single:{msg:"This payment method is used for a scheduled payment.",option1:"Use another payment method for the scheduled payment.",option2:"Delete the scheduled payment."},multiple:{msg:"This payment method is used for scheduled payments.",option1:"Use another payment method for the scheduled payments.",option2:"Delete the scheduled payments."}},auto:{msg:"This payment method is used for your monthly automatic payments.",option1:"Use another payment method for my automatic payments.",option2:"Cancel my automatic payments."},both:{single:{msg:"This payment method is used for a scheduled payment and your monthly automatic payments.",option1:"Use another payment method for the scheduled payment and monthly automatic payments.",option2:"Delete the scheduled payment and cancel monthly automatic payments."},multiple:{msg:"This payment method is used for scheduled payments and your monthly automatic payments.",option1:"Use another payment method for the scheduled payments and monthly automatic payments.",option2:"Delete the scheduled payments too and cancel monthly automatic payments."}}},lastPayment:{scheduled:{single:{msg:"Deleting this payment method will also delete your scheduled payment."},multiple:{msg:"Deleting this payment method will also delete your scheduled payments."}},auto:{msg:"Deleting this payment method will also delete your future monthly automatic payments."},both:{single:{msg:"Deleting this payment method will also delete your scheduled payment and your future monthly automatic payments."},multiple:{msg:"Deleting this payment method will also delete your scheduled payments and your future monthly automatic payments."}}}},f={computeDaysRemaining:function(a,b,c){var d=a-this.calculateDayDiff(b,c);return d},parseDate:function(a){if(a&&3===a.split("/").length){year=a.split("/")[2],2===a.split("/")[2].length&&(year=parseInt(String((new Date).getFullYear()).substring(0,2)+year,10));var b=new Date(year,parseInt(a.split("/")[0],10)-1,parseInt(a.split("/")[1],10));return b.setHours(0,0,0,0),b}return null},addMonths:function(a,b){var c=new Date(a.getFullYear(),a.getMonth(),a.getDate());return c.setMonth(a.getMonth()+b),c},addDays:function(a,b){var c=new Date(a.getFullYear(),a.getMonth(),a.getDate());return c.setDate(c.getDate()+b),c},dateToString:function(a){return this.checkAppendZero(a.getMonth()+1)+"/"+this.checkAppendZero(a.getDate())+"/"+a.getFullYear()},sortDate:function(a,b){var c=a.payDate,d=b.payDate;return a.date&&b.date&&(c=a.date,d=b.date),f.parseDate(c)>f.parseDate(d)?-1:c===d?a.ledgerSeq&&b.ledgerSeq&&parseInt(a.ledgerSeq,10)>parseInt(a.ledgerSeq,10)?1:-1:1},payMethodType:function(a,b){switch(a.toLowerCase()){case"cc":if(b)switch(b.toLowerCase()){case"v":return"Visa";case"m":return"Master Card";case"a":return"Amex";case"d":return"Discover"}return"Credit Card";case"ba":return"Checking account"}},recordOmniture:function(){s.linkTrackVars="eVar41, events",s.linkTrackEvents="event 2",s.eVar41="Movers",s.events="event 2",reporting.click()},calculateDayDiff:function(a,b){var c=864e5,d=Math.round((b-a)/c);return d},calculateLastDay:function(a,b){var c=new Date(b,a+1,0);return c=c.getDate()},checkAppendZero:function(a){return isNaN(a)||(a=parseInt(a,10)),10>a?"0"+a:String(a)},isEqual:function(a,b){return a&&b||a===b?(a=$.trim(String(a).toUpperCase()),b=$.trim(String(b).toUpperCase()),a!==b?!1:!0):!1},checkValidString:function(a){return a&&""!==a?!0:!1},getURLParameter:function(a){var b=window.location.search.substring(1);if("ppi"===a&&b.substr(0,3)===a)return this.decryptParams(decodeURI(b.substr(4)));for(var c=b.split("&"),d=0;d<c.length;d++){var e=c[d].split("=");if(e[0]===a)return e[1]}return""},clearAllMessages:function(a,b,c){a.mainSuccess=!1,a.successMsg="",a.mainError=!1,a.mainErrorMsg="string"!=typeof a.mainErrorMsg?[]:"",a.popupError=!1,a.popupErrorMsg="",a.popupSuccess=!1,a.popupSuccessMsg="",b&&(a.addError=!1,a.addErrorMsg=""),c&&(a.editError=!1,a.editErrorMsg="",a.deleteError=!1,a.deleteErrorMsg="")},dataStatus:{NOT_STARTED:0,IN_PROGRESS:1,ERROR:2,SUCCESS:3},getDeletePopupMessage:function(){return e},createAutoPayDate:function(a){if(a.dueDate){var b=a.dueDate.split("/").join("").substr(2,2),c=a.sysDate,d=c.split("/").join("").substr(2,2),e=c.split("/").join("").substr(0,2),f=a.paydaysInAdvance,g=a.paydayofMonth;isNaN(g)&&g.length>=3&&(g=g.slice(0,-2),g=Number(g));var h=a.dueDate.split("/").join(""),i=h.substr(2,2),j=h.substr(0,2),k=h.substr(6,2);return i=Number(i),d=Number(d),f&&"advance"===a.transferModel.datePM?(i-=f,d>i&&(12===j?(j=1,k+=1):j=j>e?j:Number(e)+1),d===i&&(i=Number(i)+1),i>d&&(i>b?i=b:j=j>e?j:e),10>j&&(j="0"+String(Number(j))),10>i&&i>0&&(i="0"+String(i))):g&&(g>i?g>d?(i=g,j=j>e?j:e):(j=Number(e)+1,i=b):i>g&&(i=g,10>i&&(i="0"+String(i)),d>i&&(12===j?(j=1,k+=1):(j=Number(e)+1,10>j&&(j="0"+String(j)))),h=j+"/"+i+"/"+k),i===g&&(e>j&&(j=e),h=j+"/"+i+"/"+k)),h=j+"/"+i+"/"+k}},decryptParams:function(a){for(var b=[],c=0;c<a.length;c++){var d=a.charCodeAt(c);b[c]=d>=33&&126>=d?String.fromCharCode(33+(d+14)%94):String.fromCharCode(d)}return b.join("")},getMessageConfig:function(a,b,c,d){return data={message:b,type:a},c&&(data.ctas=[],data.ctas.push(c)),"minor"===a&&(data.icon="warning-sign"),d&&(data.actionAlert=!0),data},alert:function(a,b,c,d){(!d.pageAlerts||d.pageAlerts.length>0)&&(d.pageAlerts=[]),d.pageAlerts.push(this.getMessageConfig(a,b,c,!0)),d.alertFlag=String(d.pageAlerts.length)===d.alertFlag?"_c"+String(d.pageAlerts.length):String(d.pageAlerts.length)},alertObject:function(a,b){for(var c=!1,d=0;d<b.pageAlerts.length;d++)if("success"===b.pageAlerts[d].type){c=!0;break}c&&b.pageAlerts.splice(d,1),b.pageAlerts.push(a),b.alertFlag=String(b.pageAlerts.length)===b.alertFlag?"_c"+String(b.pageAlerts.length):String(b.pageAlerts.length)},addToAlerts:function(a,b,c,d,e){e&&d.pageAlerts&&d.pageAlerts.length>0&&d.pageAlerts[0].actionAlert?(d.pageAlerts[0].type=a,"minor"===a&&(d.pageAlerts[0].icon="warning-sign"),d.pageAlerts[0].message=b,c&&(d.pageAlerts[0].ctas=[],d.pageAlerts[0].ctas.push(c))):d.pageAlerts.push(this.getMessageConfig(a,b,c,e)),d.alertFlag=d.alertFlag===String(d.pageAlerts.length)?"_c"+String(d.pageAlerts.length):String(d.pageAlerts.length)},addErrorToAlerts:function(a,b){b||(b=c.error.general),this.addToAlerts("major",b,null,a,!0),a.pageAlerts.reverse()},addSuccessToAlerts:function(a,b){this.addToAlerts("success",b,null,a,!0),a.pageAlerts.reverse()},formatDate:function(a){return 3===a.split("/").length&&4===a.split("/")[2].length?this.checkAppendZero(a.split("/")[0])+"/"+this.checkAppendZero(a.split("/")[1])+"/"+a.split("/")[2].substring(2,4):a},unFormatDate:function(a){return 3===a.split("/").length&&2===a.split("/")[2].length?this.checkAppendZero(a.split("/")[0])+"/"+this.checkAppendZero(a.split("/")[1])+"/"+"20"+a.split("/")[2]:a},checkUnAuthorized:function(){var a=!0,b=document.cookie;null!==b&&(b=unescape(b));for(var c=b.split(";"),d=0;d<c.length;d++){var e=c[d].split("="),f=e[0];f=f.replace(" ","");var g=e[1];if("oolp_"===f&&g&&""!==g&&(g=JSON.parse(g),g.p&&1===g.p.bp))return!1}return a},pageScope:0,currency:function(a){var b="$0";return null===a||""===a||void 0===a?a:(a=a.toString(),a.split("$").length>0&&(a=a.split("$").join("")),a=parseFloat(a),0===a?b:0>a?"-$"+Math.abs(a).toFixed(2):a>0?"$"+a.toFixed(2):b)},removeChars:function(a,b){return String(a).split(b).join("")},initModel:function(a,b,c){if(model={},this.checkUnAuthorized()&&(window.location="/pay-bill/unauthorized/"),this.pageScope=a,model.mainError=!1,model.mainErrorMsg="",model.addError=!1,model.addErrorMsg="",model.editError=!1,model.editErrorMsg="",model.successMsg="",model.mainSuccess=!1,model.apiError=!1,model.mandatoryAPIData=this.dataStatus.NOT_STARTED,a.currency=this.currency,a.hidePageError=!1,a.pageAlerts=[],a.alertFlag="0",a.model=model,a.stubMode=!1,model.popupError=!1,model.popupErrorMsg="",model.popupSuccess=!1,model.popupSuccessMsg="",b||c){for(a.addNewPayment=!1,model.addDebit=!1,model.monthOptions={0:"MM"},a.isDebitCardType=!1,a.customerName="",model.bankName="",i=1;13>i;i++)model.monthOptions[String(i)]=10>i?"0"+String(i):String(i);for(model.yearOptions={0:"YY"},d=parseInt(String((new Date).getFullYear()).substr(2,2),10),i=d;d+20>i;i++)model.yearOptions[String(i)]=String(i);for(model.stateOption={},stateName=["---","NY","NJ","CT","PA","AL","AK","AZ","AR","CA","CO","DE","DC","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","ME","MA","MI","MN","MS","MO","MT","NE","NV","NH","NM","NC","ND","OH","OK","OR","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"],i=0;i<stateName.length;i++)model.stateOption[String(stateName[i])]=String(stateName[i]);b&&(a.addPayModel={},a.addPayModel.showPayType=!0,a.addPayModel.paymentOption=!1,model.payNickname_BA="",model.paymentTypeOptions={NA:"Select a payment method",BA:"Checking Account",CC:"Credit/Debit Card"}),c&&(a.editPayModel={},a.editPayment=!1,model.deleteError=!1,model.deleteErrorMsg="",a.deletePayment=!1,a.currentPaymentMethod={})}return model},handleErrorResponse:function(b,d){var e=c.error.general;d||(d={}),d.mandatory&&(b.apiError=!0,b.mandatoryAPIData=this.dataStatus.ERROR),d.message&&(e=d.message),d.add?(b.addErrorMsg=e,b.addError=!0):d.edit?(b.editErrorMsg=e,b.editError=!0):d.popup?(b.popupErrorMsg=e,b.popupError=!0):d.deletePopup?(b.deleteErrorMsg=e,b.deleteError=!0):d.mandatory||(b.mainError=!0,d.errorArr||b.mainErrorMsg&&"string"!=typeof b.mainErrorMsg?b.mainErrorMsg.push(e):b.mainErrorMsg=e,a&&a.$$childHead&&(this.addErrorToAlerts(a.$$childHead,e),a.$$childHead.Pagesubmit=!1,a.$$childHead.showSpinner=!1)),d.scroll&&this.scrollToError(d.scroll)},handleSuccessfullResponse:function(a,b,c){model=b.model;var d=function(a){if(c.osc&&c.osc.length&&c.osc.length>0){for(var b=0;b<c.osc.length;b++)if(a===c.osc[b])return!0;return!1}};c||(c={}),c.noClear||this.clearAllMessages(model,!0,!0);var e=0;return a&&(a.responseInfo?e=a.responseInfo:a.status&&(e=a.status)),e&&e.statusCode&&(0===parseInt(e.statusCode,10)||d(parseInt(e.statusCode,10)))?(c.update&&b.updatePayments(),c.popup?model.popupSuccess=!0:c.noClear||(model.mainSuccess=!0),c.scroll&&this.scrollToError(c.scroll),!0):c.summary?!0:(e&&e.message&&e.message.mainmsg?c.message=e.message.mainmsg:e&&e.statusDesc&&(c.message=e.statusDesc),this.handleErrorResponse(model,c),!1)},checkDefaultSuccess:function(a){return a&&(responseObj=null,a.responseInfo?responseObj=a.responseInfo:a.status&&(responseObj=a.status),responseObj.statusDesc&&"the operation completed successfully"!==responseObj.statusDesc)?responseObj.statusDesc:null},handleSuccessMessage:function(a,c){if(c&&a.responseInfo.message){var d=new Date;d.setTime(d.getTime()+12e4);var e="; expires="+d.toGMTString()+"; path=/",f=a.responseInfo.message;document.cookie="confResponse="+escape(JSON.stringify(f))+e,""===f&&b.clear_cookie("confResponse")}},identifyResponseType:function(a){var b=null;return b="00000"===a?"success":"000017"===a?"failure":"partial"},identifyPayMethodType:function(a,b,c){var d={payMethodName:"",hasAutoPay:!1,hasOTP:!1,hasMultipleOTP:!1,hasScheduledAutoPay:!1,noOfOTP:0,isLast:!1,deleteMessageType:""};if(a&&b&&c&&b.paymentMethods){if(d.payMethodName=a,1===b.paymentMethods.length&&(d.isLast=!0),b.hasAutoPay)for(var e=0;e<b.paymentMethods.length;e++)if(b.paymentMethods[e].payMethodName===a&&b.paymentMethods[e].isAutoPayment){d.hasAutoPay=!0;break}c.scheduledAutoPayment&&c.scheduledAutoPayment.payNickname===a&&(d.hasScheduledAutoPay=!0);var f=c.scheduledOTPayments;d.noOfOTP=$.grep(f,function(b){return b.payNickname===a}).length,d.noOfOTP>0&&(d.hasOTP=!0,d.noOfOTP>1&&(d.hasMultipleOTP=!0))}return d},computeActiveAcctEbillInfo:function(a,b){var c;if(b&&b.ebillInformationOutputs)for(var d=0;d<b.ebillInformationOutputs.length;d++)if(b.ebillInformationOutputs[d].accountNum===a){c=b.ebillInformationOutputs[d];break}return c},computeFromAcctEbillInfo:function(b){var c;if(a.acctDetail){var d=this.getObjInArrayByValue(a.acctDetail,"active",!0),e=d.accountType;if(b&&b.ebillInformationOutputs&&d){if(2===e||3===e)return activeAcctEbillInfo;for(var f=0;f<b.ebillInformationOutputs.length;f++)if(b.ebillInformationOutputs[f].isFrom!==!0);else{c=b.ebillInformationOutputs[f];var g=this.getObjInArrayByValue(a.acctDetail,"accountNumber",c.accountNumber);if(0===e&&2===g.accountType||1===e&&3===g.accountType)return c}}}return c},computeToAcctEbillInfo:function(a){var b;if(a&&a.ebillInformationOutputs)for(var c=0;c<a.ebillInformationOutputs.length;c++)if(a.ebillInformationOutputs[c].isFrom===!1){b=a.ebillInformationOutputs[c];break}return b},getObjInArrayByValue:function(a,b,c){var d;if(a)for(var e=0;e<a.length;e++)if(console.log(e),a[e][b]===c){d=a[e];break}return d},getPayMethodClassifier:function(a){return a.deleteMessageType=a.isLast?"lastPayment":"normal",a.hasAutoPay&&a.hasOTP?(a.deleteMessageType+="_both",a.deleteMessageType+=a.noOfOTP>1?"_multiple":"_single"):!a.hasAutoPay&&a.hasOTP?(a.deleteMessageType+="_scheduled",a.deleteMessageType+=a.noOfOTP>1?"_multiple":"_single"):a.hasAutoPay&&!a.hasOTP&&(a.deleteMessageType+="_auto"),a},getDeleteMessages:function(a){var b={msg:null,option1:null,option2:null};if(a.deleteMessageType)switch(a.deleteMessageType){case"normal_scheduled_single":b=e.normal.scheduled.single;break;case"normal_scheduled_multiple":b=e.normal.scheduled.multiple;break;case"normal_auto":b=e.normal.auto;break;case"normal_both_single":b=e.normal.both.single;break;case"normal_both_multiple":b=e.normal.both.multiple;break;case"lastPayment_scheduled_single":b=e.lastPayment.scheduled.single;break;case"lastPayment_scheduled_multiple":b=e.lastPayment.scheduled.multiple;break;case"lastPayment_auto":b=e.lastPayment.auto;break;case"lastPayment_both_single":b=e.lastPayment.both.single;break;case"lastPayment_both_multiple":b=e.lastPayment.both.multiple}return b},isEmail:function(a){var b=/^([a-zA-Z0-9_\.\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;return b.test(a)},checkForCancel:function(){utils.isPrevDomainSame()?history.go(-1):window.location.href="/pay-bill"},truncateName:function(a){var b=25;return isMobile()&&(b=20),a&&a.length>b?(nameArr=a.split("-"),nameArr&&nameArr.length>0&&!isNaN(nameArr[nameArr.length-1])&&nameArr[nameArr.length-1].length<=4?a.substring(0,b-8)+"...-"+nameArr[nameArr.length-1]:a.substring(0,b-3)+"..."):a},truncateBPLandingName:function(a){var b=20;isMobile()&&(b=20);var c=$("#checkTablet").is(":visible");return c||(b=8),a&&a.length>b?(nameArr=a.split("-"),nameArr&&nameArr.length>0&&!isNaN(nameArr[nameArr.length-1])&&nameArr[nameArr.length-1].length<=4?a.substring(0,b-8)+"...-"+nameArr[nameArr.length-1]:a.substring(0,b-3)+"..."):a},scrollToError:function(a){var b=($("div"),$("#"+a));b&&$("html, body").animate({scrollTop:40},"slow")},formatAccountNumber:function(a){var b=13;if(null==a||a.toString().length!==b)return a;var c=/^(\d{5})(\d{6})(\d{2}$)/.exec(a);return a=c[1]+"-"+c[2]+"-"+c[3]},unFormatAccountNumber:function(a){return a&&a.split(" ")&&a.split(" ").length>0&&(a=a.split(" ").join("").split("-").join("")),a},getReferrerDomain:function(){var a="";return document.referrer&&(a=document.referrer.split("/").slice(2,3).join("/")),a},isPrevDomainSame:function(){var a=this.getReferrerDomain(),b=!1;return document.domain&&a?document.domain.toUpperCase()===a.toUpperCase()&&(b=!0):(-1!==navigator.appVersion.indexOf("MSIE 7")||-1!==navigator.appVersion.indexOf("MSIE 8"))&&(b=!0),b},get_cookie:function(a){var b=a+"=",c="";return document.cookie.length>0&&(offset=document.cookie.indexOf(b),-1!==offset&&(offset+=b.length,end=document.cookie.indexOf(";",offset),-1===end&&(end=document.cookie.length),c=unescape(document.cookie.substring(offset,end)))),c},clear_cookie:function(a){document.cookie=a+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/"},changeInputType:function(a,b){var c={from:"text",to:"tel"},d=$("#"+a),e=d.html();b=b?$.extend({},c,b):c,"number"===b.to&&b.min&&b.max&&(b.to+='" min="0" max="10000'),d&&e&&e.split('type="'+b.from+'"').join('type="'+b.to+'"')},clearAddPayForm:function(a){a.addPayModel.routNum="",a.addPayModel.paymentAccountNumber_BA="",a.model.nameOnAccount_BA=a.customerName,a.model.saveAddtoProfile_BA=!1,a.model.payNickname_BA="",a.model.nameOnAccount_CC=a.customerName,$("#cardInputField").val(""),$("#cardInputField").removeClass("cards--visa").removeClass("cards--mastercard").removeClass("cards--discover").removeClass("cards--amex").removeClass("cards--invalid"),a.model.addMonth="0",a.model.addYear="0",a.cardValidated=!1,a.model.saveAddtoProfile_CC=!1,a.model.addDebit=!1,a.isDebitCardType=!1,a.showDebitCheck=!1,a.model.payNickname_CC="",$("#addCCPayName").val(""),a.model.isDiffBilling=!1,a.addPayModel.addrLine1="",a.addPayModel.addrLine2="",a.addPayModel.city="",a.addPayModel.state="---",a.addPayModel.zip="",a.model.addError=!1},reloadPersistedPage:function(){window.onpageshow=function(a){a.persisted&&window.location.reload()}},roundOff:function(a){return"-"===a.substring(0,1)?(a=a.substring(2),a=Number(a).toFixed(2),a="$"+a+" "+"cr"):"$"===a.substring(0,1)&&(a=a.substring(1),a=Number(a).toFixed(2),a="$"+a),a}};return f}]),angular.module("payBillResource",["config"]).factory("PayBillService",["$http","Config","$rootScope",function(a,b,c){function e(a,b){return a&&a.length>b?!0:!1}function f(a){return isNaN(a)&&(a=parseInt(a,10)),10>a?"0"+a:String(a)}function g(a){if(a&&3===a.split("/").length){year=a.split("/")[2],2===a.split("/")[2].length&&(year=parseInt(String((new Date).getFullYear()).substring(0,2)+year,10));var b=new Date(year,parseInt(a.split("/")[0],10)-1,parseInt(a.split("/")[1],10));return b.setHours(0,0,0,0),b}return null}var h=b.getValuesBySelector("endpoint.api.billpay"),j={system:"Portal"},k=function(){},l={responseInfo:{statusCode:"00000",statusDesc:"the operation completed successfully",statusType:"AMSS",message:null},ebillInformationOutputs:[{accountNum:"07801-275546-03",isFrom:!0,capAmount:2,classCodeInd:!1,fixAmount:44.44,hasAutoPay:!0,isDuedate:"1",hasOTScheduled:!0,isPaperBill:!0,mailNotifyInd:!0,manualBlockInd:!1,payDayOfMonth:4,payDaysInAdvance:null,paymentMethods:[{accountType:"CC",addrLine1:"11 COZY LN",addrLine2:null,cardType:"D",city:"NORTHPORT",expDate:"0214",isAutoPayment:!0,isDefault:!0,nameOnAccount:"Brian Connolly",payMethodName:"Discover-9424",paymentAccountNumber:"9424",state:"NY",zip:"11768"},{accountType:"CC",addrLine1:"11 COZY LN",addrLine2:null,cardType:"D",city:"Northport",expDate:"0115",isAutoPayment:!1,isDefault:!1,nameOnAccount:"Brian Connolly",payMethodName:"Discover-1117",paymentAccountNumber:"1117",state:"NY",zip:"11768"},{accountType:"CC",addrLine1:"11 COZY LN",addrLine2:null,cardType:"D",city:"Northport",expDate:"0115",isAutoPayment:!1,isDefault:!1,nameOnAccount:"Brian Connolly",payMethodName:"Visa-1111",paymentAccountNumber:"1117",state:"NY",zip:"11768"},{accountType:"CC",addrLine1:"11 COZY LN",addrLine2:null,cardType:"D",city:"Northport",expDate:"0115",isAutoPayment:!1,isDefault:!1,nameOnAccount:"Brian Connolly",payMethodName:"Visa-1010",paymentAccountNumber:"1117",state:"NY",zip:"11768"}],scheduledAutoAmount:482.48,scheduledAutoDate:"11/24/2013",scheduledOTAmount:1.1,scheduledOTDate:"10/29/2013",email:"savanp@amdocs.com",tcInd:!1},{accountNum:"07801-275546-30",isFrom:!1,capAmount:null,classCodeInd:!1,fixAmount:44.44,hasAutoPay:!1,hasOTScheduled:!1,isPaperBill:!1,mailNotifyInd:!1,manualBlockInd:!1,payDayOfMonth:4,payDaysInAdvance:null,paymentMethods:[],scheduledAutoAmount:null,scheduledAutoDate:null,scheduledOTAmount:null,scheduledOTDate:null,email:null,tcInd:!0}],apOptOut:!1,discoDate:"10/24/2013",mtAknowInd:null,pmOptOut:null},m={getBillSummaryReturn:null,payments:[]},n={responseInfo:{statusCode:"00000",statusDesc:"the operation completed successfully",statusType:"AMSS",message:null},scheduledAutoPayment:{},scheduledOTPayments:[]},o={responseInfo:{statusCode:"00000",statusDesc:"The operation completed successfully",statusType:"Session",message:null},accounts:[{accountNumber:"123",accountType:"0",active:!0},{accountNumber:"345",accountType:"1",active:!1},{accountNumber:"234",accountType:"2",active:!1},{accountNumber:"345",accountType:"3",active:!1}]},p={responseInfo:{statusCode:"00055",currMonAutoPayDate:"11-11-2013"}},q={responseInfo:{statusCode:"00000",statusDesc:"This could be the result of your credit limit being exceeded, or the credit card is no longer valid.\n If you feel your Payment Method is correct, please try your payment again later.",statusType:"Consolidated AMSS",message:{mainmsg:"This could be the result of your credit limit being exceeded, or the credit card is no longer valid. If you feel your Payment Method is correct, please try your payment again later.",intro:"Oops.  We are unable to process your request.",outro:"If you are still experiencing difficulty, contact us at Customer Support.",additionalInfo:null,linkText:"Contact Us",linkURL:"/support/contact-us/"}},confirmNumber:null},r={accountNumber:"0780127554630",csrId:null,recentOTPAmount:null,recentOTPDate:null,currentBalance:0,amountDue:0,dueDate:"10/29/2013",systemDate:"10/24/2013",dueDays:0,currentStatementDate:"10/07/2013",nextStatementDate:"11/07/2013",customerType:"R",defaultPmNickname:null,pastDue:"",pastDueAmount:0,hasScheduledPayment:null,scheduledPayDate:null,scheduledPayAmount:0,scheduledPayNickname:null,scheduledPayCapFailure:"N",hasRecentPayment:"N",recentPayAmount:0,recentPayDate:null,recentPayFailure:"N",recentPayFailureReason:null,creditCardExpiring:null,creditCardExpired:null,hasAutoPay:"N",billCycleStartDate:"10/08/2013",billCycleEndDate:"11/07/2013",payByMailAddress:"P.O. Box 371378",payByMailCity:" Pittsburgh",payByMailState:" PA",payByMailZip:" 15250-7378",hasPaymentMethod:"N",hasAutoPmtMethod:"N",wipDiscoReason:"5",nonPayDisconnect:"N",statementBalance:0,status:{statusCode:"0000",statusDesc:"description",canAccessBillPay:"Y"}},s={getBillSummaryReturn:{responseInfo:null,billStatements:[{billAmount:"$162.94",billCloseDate:"03/15/2014",billDueDate:"03/30/2014",documentKey:"07862201403C241405016R",inserts:[],payments:[]}]},payments:[]},t={statementSummary:{account:"786224140501",name:"HOBOKEN DEPT OF ENVIR",addressLine1:"124 GRAND ST 1ST FL",addressLine2:"HOBOKEN NJ 07030",addressLine3:null,billingPeriod:{text:["Billing Period"],date:null,date1:"03/06/14",date2:"04/15/14"},includedPaymentsReceivedBy:{text:"Includes Payments Received By",date:"03/10/14"},previousBalance:{text:"Last Bill Balance",amount:"$0.00"},payments:{text:"Payments ",amount:"$0.00"},unpaidBalance:{content:["\n",{name:"Text",declaredType:"java.lang.String",scope:"javax.xml.bind.JAXBElement$GlobalScope",value:"$50.00",nil:!1,typeSubstituted:!1,globalScope:!0},"\n",{name:"Amount",declaredType:"java.lang.String",scope:"javax.xml.bind.JAXBElement$GlobalScope",value:"$0.00",nil:!1,typeSubstituted:!1,globalScope:!0},"\n"]},newChargesAmount:{content:["\n",{name:"Text",declaredType:"java.lang.String",scope:"javax.xml.bind.JAXBElement$GlobalScope",value:"03/30/14",nil:!1,typeSubstituted:!1,globalScope:!0},"\n",{name:"Text",declaredType:"java.lang.String",scope:"javax.xml.bind.JAXBElement$GlobalScope",value:"03/30/14",nil:!1,typeSubstituted:!1,globalScope:!0},"\n",{name:"Amount",declaredType:"java.lang.String",scope:"javax.xml.bind.JAXBElement$GlobalScope",value:"$162.94",nil:!1,typeSubstituted:!1,globalScope:!0},"\n"]},totalAmountDue:{content:["\n",{name:"Text",declaredType:"java.lang.String",scope:"javax.xml.bind.JAXBElement$GlobalScope",value:"$162.94",nil:!1,typeSubstituted:!1,globalScope:!0},"\n",{name:"Amount",declaredType:"java.lang.String",scope:"javax.xml.bind.JAXBElement$GlobalScope",value:"$162.94",nil:!1,typeSubstituted:!1,globalScope:!0},"\n"]}},serviceDetails:{message:null,detailGroup:[{name:"Internet",service:[{startDate:"03/06/14",endDate:null,sumcode:"09B01203",serviceName:"Installation",amount:"$46.95",description:null},{startDate:"03/16/14",endDate:"04/15/14",sumcode:"09B03038",serviceName:"Optimum Online",amount:"$59.95",description:"24-month Price Guarantee effective until 03/15/2016."},{startDate:"03/16/14",endDate:"04/15/14",sumcode:"09B02113",serviceName:"Ultra 50",amount:"$19.95",description:null},{startDate:"03/16/14",endDate:"04/15/14",sumcode:"09B02387",serviceName:"Static IP",amount:"$10.00",description:"(1 usable IP address) (Requires Boost Plus or Ultra)"}],totalAmount:{text:"Total Internet",amount:"$136.85"}},{name:"Partial Month Activity",service:[{startDate:"03/07/14",endDate:"03/15/14",sumcode:"09B02346",serviceName:"Optimum Online",amount:"$17.40",description:null},{startDate:"03/07/14",endDate:"03/15/14",sumcode:"09B02343",serviceName:"Ultra",amount:"$5.79",description:null},{startDate:"03/07/14",endDate:"03/15/14",sumcode:"09B02347",serviceName:"Add'l Internet",amount:"$2.90",description:null}],totalAmount:{text:"Total Partial Month Activity",amount:"$26.09"}}],subtotalNewCharges:"$162.94",unpaidBalance:{content:["$0.00"]},newChargesAmount:{content:["$162.94"]},totalAmountDue:{content:["$162.94"]}}},u={address1:"65 THIRD AV",address2:null,city:"NEW HYDE PK",state:"NY",zip:"11040",customerName:"Joseph Avitabile",status:{statusCode:"0000",statusDesc:"SUCCESS",canAccessBillPay:null}},v={status:"SUCCESS",domain:"http://optimum.web.sundaysky.com",path:"/create",query:"?id=159257D0A080G078445&statement=5&archetype=0&pon=1&poff=0&theme=2&lang=en",message:""},w={nameOnAccount:"Please enter your full name",creditCard:"Please enter a valid credit card number",payNickname:"Please enter a nickname",addrLine1:"Please enter an address",city:"Please enter a city",zip:"Please enter a valid zip code",routNum:"Incorrect format:<br>Please enter a valid routing number",accountNumber:"Please enter a valid account number",nameForAccount:"Please enter valid name for account",emailId:"Please enter a valid email id",dueAmount:"Please enter more than amount due",otherAmount:"Minimum payment of $1 is required",morethanotherAmount:"Please enter dollars and cents, separated by a period"},x={latestBill:"This is your latest billing statement, but may not reflect recent account activity after this bill was issued.",billingPeriod:"Lorem ipsum dolor sit amet",paymentReceived:"Lorem ipsum dolor sit amet",paymentsThankYou:"Lorem ipsum dolor sit amet",remainingBalance:"Lorem ipsum dolor sit amet",totalMonthlySavings:"Lorem ipsum dolor sit amet",remainingBalanceSubtotal:"Lorem ipsum dolor sit amet",payments:"Lists payments that you've made.  Recent payments may not be reflected here ",additionalOutlet:"This is for receiving premium channels on additional outlets in your home.",onDemand:"Shows On Demand and Pay Per View Purchase",tax_fees:"This section lists any applicable taxes and fees for services provided.",sports:"A monthly sports programming surcharge that is a direct result of continually rising sports programming costs.",mutltiPdtDsct:"A monthly discount given to customers who maintain the required levels of TV, Phone, and Internet service.",otherActivity:"Any credits and/or debits to your account.",partialMnthActvty:"Charges and/or credits for any change, addition or removal of service that occurred during your billing cycle."},y={success:{general:"Completed successfully.",addPaymentMethod:"Added payment method successfully.",updatePaymentMethod:" updated successfully.",deletePaymentMethod:" has been successfully deleted.",deleteOther:{changeScheduled:"Your scheduled payment will now use ",changeScheduledMulti:"Your scheduled payments will now use ",changeAuto:"All future monthly automatic payments will now use ",deleteScheduled:"Your scheduled payment has been deleted.",deleteScheduledMulti:"Your scheduled payments have been deleted.",deleteAuto:"All future monthly automatic payments have been cancelled",changeBoth:"All future monthly automatic payments and scheduled payment will now use ",changeBothMulti:"All future monthly automatic payments and scheduled payments will now use ",deleteBoth:"All future monthly automatic payments and scheduled payment have been cancelled",deleteBothMulti:"All future monthly automatic payments and scheduled payments have been cancelled"},deletePayment:"Payment deleted successfully.",acctActivityMsg:"Visit the <a href = '/pay-bill/account-activity' class = 'color-secondary'>Account activity</a> page to manage scheduled payments.",optout:{autoPayDefault:"You have successfully cancelled automatic payments.",paperlessBilling:"You have successfully cancelled paperless billing.  Your next available statement will be mailed to your billing address."},emailUpdate:"Your email preferences have been successfully updated."},error:{general:"This information is not currently available. Please try again later",optout:{automaticPayments:"Cannot opt out of autopay because this option is not set for this account. Click on cancel to continue.",paperlessBilling:"Cannot opt out of paperless billing because this option is not set for this account. Click on cancel to continue.",noOption:"No opt out of service selected. Click on cancel to continue."},paymentOptions:{invalidPayment:"Sorry, this payment is invalid. Please click on cancel to continue.",autopayUpdate:"Incorrect values cannot update the scheduled auto pay payment. Please click on cancel to continue."},defaultPayFailure:{responseInfo:{statusCode:"<<errorCode>>",statusDesc:"We are unable to process your request at this time.",statusType:"Consolidated AMSS",message:{mainmsg:"We seem to be experiencing technical difficulties. Please try again later.",intro:"We are unable to process your request at this time.",outro:"If you continue to experience difficulty, please contact us at customer support.",additionalInfo:null,linkText:"Contact Us",linkURL:"/support/contact-us/"}}}}};
validateZip=function(a){return a&&5===a.length&&!isNaN(a)?!0:!1};var z={stubMode:!1,requestInProgress:!1,currentServiceEnd:"",get_cookie:function(a){var b=a+"=",c="";return document.cookie.length>0&&(offset=document.cookie.indexOf(b),-1!==offset&&(offset+=b.length,end=document.cookie.indexOf(";",offset),-1===end&&(end=document.cookie.length),c=unescape(document.cookie.substring(offset,end)))),c},clear_cookie:function(a){document.cookie=a+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/"},services:{EBILL_INFO:"ebillinfo",BP_GLOBAL:"bpGlobal",SUMMARY:"summary",BILL_FILE:"billfile",CARD_INFO:"cardinfo",BANK_INFO:"bankinfo",CREATE_PM:"createpaymethod",UPDATE_PM:"updatepaymethod",REMOVE_PM:"removepaymethod",OT_PAYMENT:"submitotpayment",UPDATE_OT_PAYMENT:"updateotpayment",REMOVE_OT_PAYMENT:"removeotimepayment",CREATE_AUTO_PAYMENT:"createautopayment",UPDATE_AUTO_PAYMENT:"updateautopayment",UPDATE_SCH_AUTO:"updateScheduledAutoPayment",REMOVE_AUTO_PAYMENT:"removeautopayment",SCHEDULED_PAYMENTS:"scheduledpayments",SERVICE_ADDRESS:"serviceAddress",UPDATE_COMM:"updateprefcom",UPDATE_COMM_NEW:"updateprefcomNew",CREATE_AUTO_NEW:"createautopaymethodNew",UPDATE_AUTO_NEW:"updateAutoPayNew",OT_PAYMENT_NEW:"submitotpaymentNew",UPDATE_OT_PAYMENT_NEW:"updateotpaymentNew",UPDATE_SCH_AUTO_NEW:"updateScheduledAutoPaymentNew",VIDEO_BILL:"sundaysky/statement",MOVE_TRANSFER:"moveTransferPaymentSettings",TOGGLE_ACCOUNT:"toggleAccount",GET_XML:"xmlbillfile",GET_XMLSUM:"xmlsummary",GET_PAYMENT_HISTORY:"getPaymentHistory"},accountNumber:function(a){k(a)},getTodayDate:function(){return d=new Date,d.getMonth()+1+"/"+d.getDate()+"/"+d.getFullYear()},getFirstDate:function(){return d=new Date,d.getMonth()+1+"/01/"+d.getFullYear()},dateToString:function(a){return a.getMonth()+1+"/"+a.getDate()+"/"+a.getFullYear()},checkTrailingZero:function(a){return f(a)},getTotalDaysInMonth:function(a,b){return a=parseInt(a,10),b=parseInt(b,10),new Date(b,a,0).getDate()},initModel:function(){for(model={},model.monthOptions={0:"MM"},model.yearOptions={0:"YY"},model.stateOption={},model.personal={},model.mainError=!1,model.mainErrorMsg="",model.addError=!1,model.addErrorMsg="",model.editError=!1,model.editErrorMsg="",model.paymentTypeOptions={BA:"Checking Account",CC:"Credit/Debit Card"},i=1;13>i;i++)model.monthOptions[String(i)]=String(i);for(d=parseInt(String((new Date).getFullYear()).substr(2,2),10),i=d;d+20>i;i++)model.yearOptions[String(i)]=String(i);for(stateName=["---","NY","NJ","CT","PA","AL","AK","AZ","AR","CA","CO","DE","DC","FL","GA","HI","ID","IL","IN","IA","KS","KY","LA","ME","MD","ME","MA","MI","MN","MS","MO","MT","NE","NV","NH","NM","NC","ND","OH","OK","OR","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY"],i=0;i<stateName.length;i++)model.stateOption[String(stateName[i])]=String(stateName[i]);for(personalType=["Personal","Business"],i=0;i<personalType.length;i++)model.personal[personalType[i][0]]=String(personalType[i]);return model},getPaymentMethod:function(a,b){model=b.model,b.model.editError=!1,b.model.editErrorMsg="",model.isEditDiffBilling=!1;for(var c=0;c<b.activeAcctEbillInfo.paymentMethods.length;c++)if(paymentMethod=b.activeAcctEbillInfo.paymentMethods[c],paymentMethod.payMethodName.toLowerCase()===a.toLowerCase())return b.editPayModel.payType=paymentMethod.accountType,b.editPayModel.nameOnAccount=paymentMethod.nameOnAccount,b.editPayModel.oldPayNickname=a,b.editPayModel.newPayNickname=a,b.editPayModel.cardAccountNumber=paymentMethod.paymentAccountNumber.substring(paymentMethod.paymentAccountNumber.length-4,paymentMethod.paymentAccountNumber.length),b.editPayModel.displayCardNumber="Ending in "+b.editPayModel.cardAccountNumber,b.editPayModel.isDefault=paymentMethod.isDefault,"CC"===b.editPayModel.payType?(paymentMethod.expDate&&4===paymentMethod.expDate.length&&(month=parseInt(paymentMethod.expDate.substring(0,2),10),model.editMonth=String(month),model.editYear=String(paymentMethod.expDate.substring(2,4)),b.editPayModel.addrLine1=paymentMethod.addrLine1,b.editPayModel.addrLine2=paymentMethod.addrLine2),b.editPayModel.city=paymentMethod.city,b.editPayModel.state=paymentMethod.state,b.editPayModel.zip=paymentMethod.zip,b.editPayModel.debitCapable=paymentMethod.debitCapable,b.editPayModel.methodType=paymentMethod.methodType):b.editPayModel.newPayNickname=a,paymentMethod},get_addData:function(a){var b={};return model=a.model,b.system="Portal",this.get_cookie("wg")&&(b.isWalledGarden=!0),b.payType=a.addPayModel.payType,"BA"===b.payType?(b.paymentAccountNumber=a.addPayModel.paymentAccountNumber_BA,b.accountType=a.model.personalType,b.nameOnAccount=a.model.nameOnAccount_BA,b.routNum=a.addPayModel.routNum,b.payNickname=a.model.payNickname_BA):(b.paymentAccountNumber=$("#cardInputField").val().split(" ").join(""),b.nameOnAccount=a.model.nameOnAccount_CC,b.payNickname=$("#addCCPayName").val(),b.expDate=f(a.model.addMonth)+"/"+a.model.addYear,b.methodType="C",a.model.addDebit&&(b.methodType="D"),b.isDebitCapable=a.isDebitCardType?!0:!1,b.cardType=a.addPayModel.cardType,model.isDiffBilling&&(b.addrLine1=a.addPayModel.addrLine1,b.addrLine2=a.addPayModel.addrLine2,b.city=a.addPayModel.city,b.state=a.addPayModel.state,b.zip=a.addPayModel.zip)),0===a.numPaymentMethods&&(b.defaultInd=1),b},get_autopayData:function(a,b){var c={};return c.payNickname=a.pmSelected,c.isTCAccepted=a.model.tcAcceptanceStatus,"due"!==a.model.amountPM?c.fixAmount=String(a.otherAmount).split("$").join(""):a.model.maxAmount&&(c.capAmount=String(a.maxAmount).split("$").join("")),"advance"===a.model.datePM?c.payDaysInAdvance=a.model.dueDateSelected:b?c.payDayOfMonth=a.model.dateOnMonthSelected:c.payDay=a.model.dateOnMonthSelected,c},get_editData:function(a){var b={system:"Portal",defaultInd:1};return b.payNickname=a.editPayModel.oldPayNickname,b.nameOnAccount=a.editPayModel.nameOnAccount,b.payType=a.editPayModel.payType,b.payNickname!==a.editPayModel.newPayNickname&&(b.newPayNickname=a.editPayModel.newPayNickname),b.defaultInd=a.editPayModel.isDefault?1:0,"CC"===b.payType&&(b.expDate=f(model.editMonth)+"/"+a.model.editYear,b.addrLine1=a.editPayModel.addrLine1,b.addrLine2=a.editPayModel.addrLine2,b.city=a.editPayModel.city,b.state=a.editPayModel.state,b.zip=a.editPayModel.zip,a.editPayModel.debitCapable&&(b.methodType=a.editPayModel.methodTypeStatus?"D":"C")),b},get_deleteData:function(a){var b={};return angular.extend(b,j),b.payNickname=a,b},get_otData:function(a,b,c){var d={};return angular.extend(d,j),c||b||(d.isTCAccepted=a.model.tcAcceptanceStatus),this.get_cookie("wg")&&(d.isWalledGarden=!0),a.showAddPM?(currentPM=a.model.paymentMethodOptions[a.model.paymentMethod],angular.extend(d,this.get_addData(a)),delete d.payNickname,"Add account"===currentPM&&a.model.bankName&&(d.companyName=a.model.bankName)):d.payNickname=a.pmSelected,c||(d.isImmediate=0),"now"===a.dateSelected?(c||(d.isImmediate=1),d.payDate=a.systemDate):(d.payDate=a.dateSelected,d.payDate!==a.systemDate||c?g(d.payDate)<g(a.systemDate)&&(d.payDate=a.systemDate,c||(d.isImmediate=1)):d.isImmediate=1),b&&(d.paymentID=a.paymentID),a.amountSelected&&(d.payAmount=String(a.amountSelected).split("$").join("")),a.isIntlPostPaid&&(d.isIntlPostPaid=a.isIntlPostPaid),d},getValidationError:function(a){return w[a]},resetEditBtn:function(a){a.showDebitCheck=!0,a.model.addDebit=!0},getServerResponses:function(){return y},getToolTipsValues:function(){return x},validate_addForm:function(a){switch(a.model.addError=!1,a.model.addErrorMsg="",a.addPayModel.payType){case"CC":if(!e(a.model.nameOnAccount_CC,0))return a.model.addErrorMsg=w.nameOnAccount,a.model.addError=!0,!1;if(!a.cardValidated)return a.model.addErrorMsg=w.creditCard,a.model.addError=!0,!1;if(!e($("#addCCPayName").val(),0))return a.model.addErrorMsg=w.payNickname,a.model.addError=!0,!1;if(a.model.isDiffBilling){if(!e(a.addPayModel.addrLine1,0))return a.model.addErrorMsg=w.addrLine1,a.model.addError=!0,!1;if(!e(a.addPayModel.city,0))return a.model.addErrorMsg=w.city,a.model.addError=!0,!1;if(!validateZip(a.addPayModel.zip))return a.model.addErrorMsg=w.zip,a.model.addError=!0,!1}break;case"BA":if(!e(a.addPayModel.routNum,0)||isNaN(a.addPayModel.routNum)||9!==a.addPayModel.routNum.length)return a.model.addErrorMsg=w.routNum,a.model.addError=!0,!1;if(!e(a.addPayModel.paymentAccountNumber_BA,3)||isNaN(a.addPayModel.paymentAccountNumber_BA))return a.model.addErrorMsg=w.accountNumber,a.model.addError=!0,!1;if(!e(a.model.nameOnAccount_BA,0))return a.model.addErrorMsg=w.nameOnAccount,a.model.addError=!0,!1;if(!e(a.model.payNickname_BA,0))return a.model.addErrorMsg=w.payNickname,a.model.addError=!0,!1}return!0},validate_editForm:function(a){if(a.model.editError=!1,a.model.editErrorMsg="",!e(a.editPayModel.nameOnAccount,0))return a.model.editErrorMsg=w.nameOnAccount,a.model.editError=!0,!1;if(!e(a.editPayModel.newPayNickname,0))return a.model.editErrorMsg=w.payNickname,a.model.editError=!0,!1;switch(a.editPayModel.payType){case"CC":if(!e(a.editPayModel.addrLine1,0))return a.model.editErrorMsg=w.addrLine1,a.model.editError=!0,!1;if(!e(a.editPayModel.city,0))return a.model.editErrorMsg=w.city,a.model.editError=!0,!1;if(!validateZip(a.editPayModel.zip))return a.model.editErrorMsg=w.zip,a.model.editError=!0,!1;break;case"BA":}return!0},checkAddForm:function(a){switch(model=a.model,a.addPayModel.payType){case"CC":if(a.addPaymentBtnClicked)return!0;if(e(a.model.nameOnAccount_CC,0)&&a.cardValidated&&"0"!==model.addMonth&&"0"!==model.addYear){if(!a.model.isDiffBilling)return!1;if(e(a.addPayModel.addrLine1,0)&&e(a.addPayModel.city,0)&&e(a.addPayModel.zip,0)&&"---"!==a.addPayModel.state)return!1}break;case"BA":if(a.addPaymentBtnClicked)return!0;if(a.validRoutingNo&&e(a.addPayModel.routNum,0)&&e(a.addPayModel.paymentAccountNumber_BA,0)&&e(a.model.nameOnAccount_BA,0)&&e(a.model.payNickname_BA,0))return!1}return!0},checkEditForm:function(a){return editPayModel=a.editPayModel,model=a.model,a.editPaymentBtnClicked?!0:(valid=!1,changed=!1,"CC"===editPayModel.payType?(e(editPayModel.newPayNickname,0)&&e(editPayModel.nameOnAccount,0)&&"0"!==model.editMonth&&"0"!==model.editYear&&(model.isEditDiffBilling?e(editPayModel.addrLine1,0)&&e(editPayModel.city,0)&&"---"!==editPayModel.state&&e(editPayModel.zip,0)&&(valid=!0):valid=!0),editPayModel.newPayNickname!==a.currentPaymentMethod.payMethodName||editPayModel.nameOnAccount!==a.currentPaymentMethod.nameOnAccount||a.currentPaymentMethod.expDate!==f(model.editMonth)+""+model.editYear?changed=!0:model.isEditDiffBilling&&(editPayModel.addrLine1!==a.currentPaymentMethod.addrLine1||editPayModel.addrLine2!==a.currentPaymentMethod.addrLine2&&""!==editPayModel.addrLine2||editPayModel.city!==a.currentPaymentMethod.city||editPayModel.state!==a.currentPaymentMethod.state||editPayModel.zip!==a.currentPaymentMethod.zip)&&(changed=!0),editPayModel.methodTypeStatus!==a.currentPaymentMethod.originalCardType&&(changed=!0)):e(editPayModel.newPayNickname,0)&&e(editPayModel.nameOnAccount,0)&&(valid=!0,(editPayModel.newPayNickname!==a.currentPaymentMethod.payMethodName||editPayModel.nameOnAccount!==a.currentPaymentMethod.nameOnAccount)&&(changed=!0)),valid&&changed?!1:!0)},getSundaySkyStatement:function(a,b,c){return this.stubMode?(b(v),void 0):this.handleGetService({},b,c,this.services.VIDEO_BILL+"/"+a)},getPaymentMethods:function(a,b,c){return this.stubMode?(b(l),void 0):this.handleGetService(a,b,c,this.services.EBILL_INFO)},getSummary:function(a,b,c){return this.stubMode?(b(m),void 0):this.handleGetService(a,b,c,this.services.SUMMARY)},getBPGlobal:function(a,b,c){return this.stubMode?(b(r),void 0):this.handleGetService(a,b,c,this.services.BP_GLOBAL)},getBillFileURL:function(a,b,c){return b?c?"/pay-bill/bill-insert/index.html?bi="+b:h+this.services.BILL_FILE+"?system=Portal&insertID="+b:a?h+this.services.BILL_FILE+"?system=Portal&billID="+a:"/pay-bill/bill-insert"},getBillFile:function(a,b,c){return this.handleGetService(a,b,c,this.services.BILL_FILE)},getCreditCardInfo:function(a,b,c){return this.handleGetService(a,b,c,this.services.CARD_INFO)},getBankInfo:function(a,b,c){return params={routingnumber:a},this.handleGetService(params,b,c,this.services.BANK_INFO)},createPaymentMethod:function(a,b,c){return this.validate_addForm(c)?(data=this.get_addData(c),this.stubMode?(data.payMethodName=data.payNickname,data.accountType=data.payType,data.paymentAccountNumber=data.paymentAccountNumber.substring(data.paymentAccountNumber.length-4,data.paymentAccountNumber.length),c.ebillInfo.paymentMethods.push(data),a(q),void 0):this.handlePostService(data,a,b,this.services.CREATE_PM)):!1},updatePaymentMethod:function(a,b,c){return this.validate_editForm(c)?(data=this.get_editData(c),this.stubMode?(paymentMethod=getPaymentMethod(c.editPaymentName,c),paymentMethod.nameOnAccount=data.nameOnAccount,a(q),void 0):this.handlePostService(data,a,b,this.services.UPDATE_PM)):!1},makeDefaultPM:function(a,b,c,d){if(paymentMethod=this.getPaymentMethod(a,d),d.editPayModel.isDefault=!0,data=this.get_editData(d),!this.stubMode)return this.handlePostService(data,b,c,this.services.UPDATE_PM);for(paymentMethod.isDefault=!0,loop=0;loop<d.ebillInfo.ebillInformationOutputs.length;loop++)if(d.ebillInfo.ebillInformationOutputs[loop].isFrom)for(var e=0;e<d.ebillInfo.ebillInformationOutputs[loop].paymentMethods.length;e++)paymentMethod1=d.ebillInfo.ebillInformationOutputs[loop].paymentMethods[e],paymentMethod1.payMethodName.toLowerCase()!==a.toLowerCase()&&(paymentMethod1.isDefault=!1)},removePaymentMethod:function(a,b,c,d){return data=this.get_deleteData(c),this.stubMode?(d.ebillInfo.paymentMethods=d.ebillInfo.paymentMethods.filter(function(a){return a.payMethodName!==c}),a(q),void 0):this.handlePostService(data,a,b,this.services.REMOVE_PM)},submitOTPayment:function(a,b,c){return data=this.get_otData(c),this.stubMode?(a(q),void 0):this.handlePostService(data,a,b,this.services.OT_PAYMENT)},get_modalTransferData:function(a){var b={};return b.system="Portal",b.pmNickNames=a.payMethodsStr,b.isAutoPayTransfer=a.autoPayTransfer,a.autoPayTransfer&&(b.autoPayNickname=a.autoPayNickName),a.updatePayMethodFlag?("advance"===a.transferModel.datePM&&(b.autoPayDaysInAdvance=a.transferModel.dueDateSelected),"dom"===a.transferModel.datePM&&(b.autoPayDayOfMonth=a.transferModel.dateOnMonthSelected),"due"===a.transferModel.amountPM&&(b.autoPayCapAmount=String(a.transferModel.maxAmountValue).split("$").join("")),"other"===a.transferModel.amountPM&&(b.autoPayFixAmount=String(a.transferModel.otherAmount).split("$").join(""))):("advance"===a.transferModel.datePM&&(b.autoPayDaysInAdvance=a.autoPayDaysInAdvance),"dom"===a.transferModel.datePM&&(b.autoPayDayOfMonth=a.autoPayDayOfMonth),"other"===a.transferModel.amountPM&&(b.autoPayFixAmount=String(a.fixAmt).split("$").join(""))),b.isUpdatePrefComm=!1,null===a.transferModel.emailAddress||""===a.transferModel.emailAddress?b.isUpdatePrefComm=!1:a.transferModel.emailAddress===a.fromAcctEbillInfo.email&&a.fromAcctEbillInfo.mailNotifyInd||(b.isUpdatePrefComm=!0),b.isUpdatePrefComm&&(b.email=a.transferModel.emailAddress,b.mailNotifyInd=!0,b.origMailNotifyInd=a.toAcctEbillInfo.mailNotifyInd,b.origPaperBillInd=a.toAcctEbillInfo.isPaperBill,b.origEmail=a.toAcctEbillInfo.email,b.paperBillInd=a.toAcctEbillInfo.isPaperBill),this.get_cookie("wg")&&(b.isWalledGarden=!0),b.mtAknowInd=a.ackTransferFlag,c.dueAmount>0?(b.isCreateRecPay=!0,b.initialPayAmount=String(c.dueAmount).split("$").join("")):b.isCreateRecPay=!1,b},toggleAccount:function(a,b,c){var d={};return this.stubMode?(a(o),void 0):(c&&(d.accountType=c),this.handlePostService(d,a,b,this.services.TOGGLE_ACCOUNT))},xmlbillFile:function(a,b,c){return this.stubMode?(b(t),void 0):this.handleGetService(a,b,c,this.services.GET_XML)},xmlSummary:function(a,b){var c={};return c.csrid=123456,c.system="Portal",this.stubMode?(a(s),void 0):this.handleGetService(c,a,b,this.services.GET_XMLSUM)},submitMoveTransfer:function(a,b,c){return data=this.get_modalTransferData(c),console.log(data),this.stubMode?(a(p),void 0):this.handlePostService(data,a,b,this.services.MOVE_TRANSFER)},submitOptOut:function(a,b,c){var d={};return d.system="Portal",d.apOptOut=c.transferModel.apOptOut,d.pmOptOut=c.transferModel.pmOptOut,console.log(d),this.stubMode?(a(p),console.log(apOptOut),void 0):this.handlePostService(d,a,b,this.services.MOVE_TRANSFER)},submitMayBeLater:function(a,b,c){return this.stubMode?(a(p),console.log(c),void 0):this.handlePostService(c,a,b,this.services.MOVE_TRANSFER)},submitOTPaymentNew:function(a,b,c){return data=this.get_otData(c),model=c.model,addPayModel=c.addPayModel,c.showAddPM&&(model.saveAddtoProfile_CC&&"CC"===addPayModel.payType||model.saveAddtoProfile_BA&&"BA"===addPayModel.payType)?(data.isCreatePayMethod=!0,angular.extend(data,this.get_addData(c))):data.isCreatePayMethod=!1,this.stubMode?(a(q),void 0):this.handlePostService(data,a,b,this.services.OT_PAYMENT_NEW)},updateOTPayment:function(a,b,c){return data=this.get_otData(c,!0),this.stubMode?(a(q),void 0):this.handlePostService(data,a,b,this.services.UPDATE_OT_PAYMENT)},updateOTPaymentNew:function(a,b,c){return data=this.get_otData(c,!0),model=c.model,addPayModel=c.addPayModel,c.showAddPM&&(model.saveAddtoProfile_CC&&"CC"===addPayModel.payType||model.saveAddtoProfile_BA&&"BA"===addPayModel.payType)?(data.isCreatePayMethod=!0,angular.extend(data,this.get_addData(c))):data.isCreatePayMethod=!1,this.stubMode?(a(q),void 0):this.handlePostService(data,a,b,this.services.UPDATE_OT_PAYMENT_NEW)},removeOTPayment:function(a,b,c){return this.stubMode?(a(q),void 0):(data={paymentID:c},this.handlePostService(data,a,b,this.services.REMOVE_OT_PAYMENT))},scheduleAutoPay:function(a,b,c){return data=this.get_autopayData(c),this.stubMode?(a(q),void 0):this.handlePostService(data,a,b,this.services.CREATE_AUTO_PAYMENT)},scheduleAutoPayNew:function(a,b,c){return data=this.get_autopayData(c),data.isCreatePayMethod=c.showAddPM,c.showAddPM&&angular.extend(data,this.get_addData(c)),data.isCreateRecPay=c.createRecPay,c.amountSelected&&(data.initialPayAmount=String(c.amountSelected).split("$").join("")),angular.extend(data,this.get_otData(c)),data.isUpdatePrefComm=!1,c.emailAddress===c.activeAcctEbillInfo.email&&c.activeAcctEbillInfo.mailNotifyInd||(data.isUpdatePrefComm=!0),data.isUpdatePrefComm&&(data.email=c.emailAddress,data.origMailNotifyInd=c.activeAcctEbillInfo.mailNotifyInd,data.origPaperBillInd=c.activeAcctEbillInfo.isPaperBill,data.origEmail=c.activeAcctEbillInfo.email,data.mailNotifyInd=!0,data.paperBillInd=c.activeAcctEbillInfo.isPaperBill),this.stubMode?(a(q),void 0):this.handlePostService(data,a,b,this.services.CREATE_AUTO_NEW)},updateAutoPay:function(a,b,c){return data=this.get_autopayData(c,!0),this.stubMode?(a(q),void 0):this.handlePostService(data,a,b,this.services.UPDATE_AUTO_PAYMENT)},updateAutoPayNew:function(a,b,c){return data=this.get_autopayData(c,!0),data.isCreatePayMethod=c.showAddPM,c.hasOwnProperty("hasCapChanged")&&(data.hasCapChanged=c.hasCapChanged),c.showAddPM&&angular.extend(data,this.get_addData(c)),data.isUpdatePrefComm=!1,c.emailAddress===c.activeAcctEbillInfo.email&&c.activeAcctEbillInfo.mailNotifyInd||(data.isUpdatePrefComm=!0),data.isUpdatePrefComm&&(data.email=c.emailAddress,data.origMailNotifyInd=c.activeAcctEbillInfo.mailNotifyInd,data.origPaperBillInd=c.activeAcctEbillInfo.isPaperBill,data.origEmail=c.activeAcctEbillInfo.email,data.mailNotifyInd=!0,data.paperBillInd=c.activeAcctEbillInfo.isPaperBill),this.stubMode?(a(q),void 0):this.handlePostService(data,a,b,this.services.UPDATE_AUTO_NEW)},swapDateFormat:function(a){if("string"==typeof a&&""!==a){var b=a.split("/");return 3===b.length?b[1]+"/"+b[0]+"/"+b[2]:2===b.length?b[1]+"/"+b[0]:a}return a instanceof Date?a.getDate()+"/"+a.getMonth()+"/"+a.getFullYear():a},updateScheduledAutoPay:function(a,b,c){return scope=0,c&&(scope=c.scope),data=this.get_otData(scope,!1,!0),this.stubMode?(a(q),void 0):this.handlePostService(data,a,b,this.services.UPDATE_SCH_AUTO)},updateScheduledAutoPayNew:function(a,b,c){return scope=0,c&&(scope=c.scope),data=this.get_otData(scope,!1,!0),model=scope.model,addPayModel=scope.addPayModel,scope.showAddPM&&(model.saveAddtoProfile_CC&&"CC"===addPayModel.payType||model.saveAddtoProfile_BA&&"BA"===addPayModel.payType)?(data.isCreatePayMethod=!0,angular.extend(data,this.get_addData(scope))):data.isCreatePayMethod=!1,this.stubMode?(a(q),void 0):this.handlePostService(data,a,b,this.services.UPDATE_SCH_AUTO_NEW)},removeAutoPay:function(a,b,c,d){return data={},c&&(data.removeScheduledInd=!0),d&&(data.unregisterAutoPayInd=!0),this.handlePostService(data,a,b,this.services.REMOVE_AUTO_PAYMENT)},scheduledPayments:function(a,b){return this.stubMode?(a(n),void 0):this.handleGetService(j,a,b,this.services.SCHEDULED_PAYMENTS)},serviceAddress:function(a,b){return this.stubMode?(a(u),void 0):this.handleGetService(j,a,b,this.services.SERVICE_ADDRESS)},updateCommunication:function(a,b,c){return this.handlePostService(a,b,c,this.services.UPDATE_COMM)},updateCommunicationNew:function(a,b,c){return this.handlePostService(a,b,c,this.services.UPDATE_COMM_NEW)},checkSuccess:function(a){return a.responseInfo&&a.responseInfo.statusCode&&0===parseInt(a.responseInfo.statusCode,10)?!0:!1},getErrorMessage:function(a){return a&&a.responseInfo&&a.responseInfo.statusDesc?a.responseInfo.statusDesc:y.error.general},handlePostService:function(b,c,d,e){var f={};return this.requestInProgress=!0,this.currentServiceEnd=e,console.log(h+e),a({method:"POST",url:h+e,headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:function(a){angular.extend(a,j);var b=[];for(var c in a)(void 0!==a[c]||"defaultInd"===c||"isImmediate"===c)&&b.push(encodeURIComponent(c)+"="+encodeURIComponent(a[c]));return b.join("&")},data:b,timeout:12e4}).success(function(a){this.currentServiceEnd="",this.requestInProgress=!1,angular.extend(f,a),c(a)}).error(function(a,b,c,e){this.currentServiceEnd="",this.requestInProgress=!1,d(a,b,c,e)}),f},handleGetService:function(b,c,d,e){var f={};return this.requestInProgress=!0,this.currentServiceEnd=e,a.get(h+e,{params:angular.extend(b,j)}).success(function(a){this.requestInProgress=!1,angular.extend(f,a);try{e===z.services.BP_GLOBAL&&a&&a.csrId&&angular.extend(j,{csrid:a.csrId})}catch(b){}c(a)}).error(function(a,b,c,e){this.requestInProgress=!1,d(a,b,c,e)}),f}};return z}]),angular.module("phoneService",["config","oolCookie"]).factory("Phone",["$http","Config","ooluser",function(a,b,c){var d=function(){var d=b.getValuesBySelector("endpoint.api.phone"),e=angular.fromJson,f={GET_MESSAGES:"messages",VOICEMAIL_COUNTER:"counter",GET_STATUS:"status"},g={GET_MESSAGES:"messages",VOICEMAIL_COUNTER:"counter"},h={NEW:"new",READ:"read"},i="YYYY-MM-DD HH:MM:SS",j=c.eoid?c.eoid:"",k=function(a,b){var c={isValid:!1,parsedResponse:null};try{var d=e(a);c.isValid=!0,c.parsedResponse=d}catch(f){console.error("ERROR parsing => "+b),console.error(f)}return c},l=function(a){var b=k(a,g.WIFI_USAGE),c=null;if(b.isValid){var d=b.parsedResponse;c={count:d.count||0,type:d.type,updated:d.updated}}return c},m=function(a){var b=k(a,g.WIFI_USAGE),c=null;if(b.isValid){var d=[],e=b.parsedResponse;if(e._embedded&&e._embedded.messages){for(var f=e._embedded.messages,j=0,l=f.length;l>j;j++){var m=f[j],n=m.flag.split("|");d.push({id:m.messageid,from:m.from,subject:m.subject,timestamp:moment(m.timestamp,i).unix(),date:m.timestamp,size:m.size,isNew:_.contains(n,h.NEW)?!0:!1,wasRead:_.contains(n,h.READ)?!0:!1})}c={messages:d,messageCount:e.messageCount,phoneNumber:e.tnber}}}return c},n=function(b,c,d,e,f){var g={method:c||"GET",url:b,data:d||null,headers:f||null,transformResponse:e||null};return a(g).success(function(a){return a}).error(function(){return console.error("ERROR, unexpected response status"),null})};return this.getVoicemailCounter=function(){var a=d+f.VOICEMAIL_COUNTER+"?eoid="+j;return n(a,"GET",{"X-Requested-With":"XMLHttpRequest"},l,null)},this.getMessages=function(){var a=d+f.GET_MESSAGES+"?eoid="+j;return n(a,"GET",{"X-Requested-With":"XMLHttpRequest"},m,null)},this.getStatus=function(){var a=d+f.GET_STATUS+"?eoid="+j;return n(a,"GET",{"X-Requested-With":"XMLHttpRequest"})},this};return new d}]),angular.module("photosResource",["config"]).factory("PhotosService",["Config","ooluser","$http",function(a,b,c){var d=a.getValuesBySelector("endpoint.api.photos");angular.fromJson;var e={GET_APIKEY:"apikey",POST_PAIR:"pair_fb/:optimumId/:userId"},f={hello:function(){alert("hello")},getApiKey:function(){return c({url:d+e.GET_APIKEY,method:"GET"})},pairAccounts:function(a,f){return c({url:d+e.POST_PAIR.replace(/:optimumId/,b.optimumId).replace(/:userId/,a),method:"POST",params:{accessToken:f}})}};return f}]),angular.module("predictableJSONP",[]).factory("PredictableJSONP",["$http",function(a){var b=function(){this.jsonp=function(b,c,d){if(window[b])throw"Name "+b+" already in use!";var e=a.jsonp(c,d),f=angular.callbacks.counter-1,g=angular.callbacks["_"+f];return window[b]=function(a){g(a),delete window[b]},e}};return new b}]),angular.module("preferences",["config","oolCookie"]).factory("Preferences",["$http","$q","Config","ooluser",function(a,b,c){var d=function(){var a=this,b=c.getValuesBySelector("endpoint.api.preferences"),d={"Content-Type":"application/json"},e={"Content-Type":"application/x-www-form-urlencoded"};a.getModules=function(){var c=b+"get/funmod";return a.makeRequest(c,"GET",null,a.formatModulesResponse,d)},a.setModules=function(c){var d=b+"set/funmod",f={homeFunc1:c.homeFunc1,homeFunc2:c.homeFunc2};return a.makeRequest(d,"POST",a.formatModulesRequest(f),null,e)}};return d.prototype={makeRequest:function(b,c,d,e,f){var g={method:c||"GET",url:b,data:d||null,headers:f||null,transformResponse:e||null};return a(g).success(function(a){return a}).error(function(){return null})},formatModulesResponse:function(a){var b={},c={Cart:"cart",DVR:"dvr",New_On_Demand:"onDemand",Whats_on_Tonight:"onTonight",Voicemail:"voiceMail",Webmail:"webMail",WiFI_Usage:"wifiUsage"};if(!a)return b;try{return a=angular.fromJson(a),b.left=c[a.homeFunc1],b.right=c[a.homeFunc2],b}catch(d){console.error("ERROR (Preferences Service): error transforming response")}},formatModulesRequest:function(a){var b,c={},d={cart:"Cart",dvr:"DVR",onDemand:"New_On_Demand",onTonight:"Whats_on_Tonight",voiceMail:"Voicemail",webMail:"Webmail",wifiUsage:"WiFI_Usage"};try{return c.homeFunc1=d[a.homeFunc1],c.homeFunc2=d[a.homeFunc2],b="homeFunc1="+c.homeFunc1+"&"+"homeFunc2="+c.homeFunc2}catch(e){console.error("ERROR (Preferences Service): error transforming request")}}},new d}]),angular.module("pricingService",["config","ngResource","ngCookies"]).factory("Pricing",["$http","$resource","Config","$cookies",function(a,b,c){var d=c.getValuesBySelector("endpoint.api.pricing"),e={getBasicPricing:"get_pricing"},f=function(){this.getBroadcastBasicPrice=_.once(function(){return a.get(d+e.getBasicPricing).then(function(a){var b=a.data;return b},function(){var a={price:"Not available. Try again later."};return a})})};return new f}]),angular.module("programDetailsImage",["config"]).factory("programDetailsImage",["Config",function(a){function b(a){this.attributes=_.extend(this.defaults,a)}var c=a.getValuesBySelector("endpoint.api.epgImages"),d=_.template(c+"<%= programId %>?deviceType=Web&artName=<%= artName %>"),e={"Small Desktop":"net_poster_67x89",Mobile:"net_poster_109x145","Medium Desktop":"net_poster_140x187","Mobile Retina":"net_poster_218x290","Large Desktop":"net_poster_222x297"};return b.prototype={url:function(){var a=_.extend(this.attributes,{artName:this.getArtName()});return d(a)},defaults:{size:"Medium Desktop"},getArtName:function(){return e[this.attributes.size]}},function(a){return new b(a)}}]),angular.module("program",["config"]).factory("Event",["$http","Config",function(a,b){var c=function(){},d=_.template(b.getValuesBySelector("endpoint.api.ipad")+"eventdetails.jsp?contentType=json&eventId=<%= id %>");return c.get=function(b,e,f){e=e||angular.noop,f=f||angular.noop;var g=_.extend(new c,b);return a.get(d(g)).then(function(a){return _.extend(g,a.data.content),e(g)},function(a){return f(a)}),g},c}]).factory("Program",["$log",function(a){function b(a){this.attributes=a}return b.prototype={get:function(a){var b="get"+_.str.classify(a);return this[b]&&_.isFunction(this[b])?this[b]():this._getDeep(a.split("."))},_getDeep:function(a){return _.reduce(a,function(a,b){return a[b]},this.attributes)},getEpisodeTitle:function(){var a=this.attributes;return a.episodeTitle||a.episodeinfo.title},getChannelNumber:function(){var b=this.attributes,c=b.num||(b.channel||{}).number;return void 0===c&&a.warn("Channel number undefined"),c},getChannelCallsign:function(){var b=this.attributes,c=b.cs||(b.channel||{}).callSign;return void 0===c&&a.warn("Channel callsign undefined"),c},getStart:function(){return this.attributes.starttime||this.attributes.startTime},getEnd:function(){return this.attributes.endTime||this.attributes.end_time},hasSeries:function(){return this.attributes.hasSeries||!this.isMovie()},isMovie:function(){return this._hasMovieCategory()||this._hasMovieFlag()},_hasMovieCategory:function(){var a=["FEATURE_FILM","SHORT_FILM","TV_MOVIE"];return _.contains(a,this.attributes.programtype)},_hasMovieFlag:function(){return"Y"===this.attributes.movies},toRecording:function(){return{scope:this.hasSeries()?"episode":"movie",title:this.attributes.title,episode:this.get("episode.title"),call_sign:this.get("channel.callsign"),channel_num:this.get("channel.number"),start_time:moment(this.get("start")),end_time:moment(this.get("end"))}}},b}]),angular.module("requestACreditService",["config"]).factory("requestACredit",["$http","Config",function(a,b){var c=function(){};return c.makeRequest=function(b,c,d,e,f){return a({method:c,url:b,data:d,transformResponse:e,headers:f}).success(function(a){return a}).error(function(a){return console.error("[Credit Request Service] makeRequest, call failed with. HTTP"),console.error(a),null})},c.fetchCreditData=function(a){var d=b.getValuesBySelector("endpoint.api.cablesupport"),e=d+"/creditrequest/creditrequest",f=c.makeRequest(e,"POST",a,null,{"Content-Type":"application/json"});return f},c}]),angular.module("searchResource",["config","miniGuideResource","errorHandler","oolCookie"]).factory("formattedResponseTransformer",[function(){return function(a,b,c){return function(d){var e,f;return _.isString(d)?(e=d.split("\n"),f=[],transformed=_.reduce(e,function(c,d,e){var g=$.trim(d).split(a);return _.forEach(g,function(a,d){var g;_.isDefined(b[e])?(g=b[e][d],c[g]=a):f.push(a)}),c},{}),c&&(transformed[c]=f.join(" ")),transformed):d}}}]).factory("SearchService",["$http","Config","MiniGuide","formattedResponseTransformer",function(a,b,c,d){function e(b,c){var d=a({url:b,method:"GET",params:c}).success(function(a){return a}).error(function(a){return a});return d}function f(a,b){var c="";return c="gsa"===a?b+"gsa":"google"===a?b+"google":b+"veveo"}function g(a){function b(a){return/^<html>/.test(a)}var c;return _.isString(a)?b(a)?c:a:c}var h=b.getValuesBySelector("endpoint.api.suggest"),i=b.getValuesBySelector("endpoint.api.search"),j=b.getValuesBySelector("endpoint.api.tvListingsDVR"),k=5,l=12,m={getHubId:function(){return k},setHubId:function(a){k=a,console.log("hubid set to : "+a)},setPN:function(a){l=a},getSuggestions:function(a,b){var c=f(b,h);return e(c,{q:a})},getSearchSupport:function(a){var b=i+"gsa";return e(b,{q:a,site:"support"})},suggestSupport:function(a){var b=h+"gsa";return e(b,{q:a,site:"support"})},onDemandFolderSearch:function(a,b,c){var d=i+"veveo";return e(d,{q:a,folder:b,id:c,isFolderSearch:!0,hub:k,pn:l})},onDemandPageSearch:function(a,b){var c=i+"veveo";return e(c,{q:a,folder:b,hub:k,pn:l})},getSearchResult:function(a,b){var c,d="";return"gsa"===b?(d=i+"gsa",c={q:a}):"google"===b?(d=i+"google",c={q:a}):(d=i+"veveo",c={q:a,hub:k,pn:l}),e(d,c)},getNextorPrevpage:function(a,b,c){var d="";return d="gsa"===b?c?i+"gsaNextPage":i+"gsaPrevPage":"google"===b?c?i+"googleNextPage":i+"googlePrevPage":i+"veveo",e(d,{url:escape(a)})},getNextorPrevSupportpage:function(a,b,c){var d="";
return d="gsa"===b?c?i+"gsaNextPage":i+"gsaPrevPage":"google"===b?c?i+"googleNextPage":i+"googlePrevPage":i+"veveo",e(d,{url:escape(a),site:"support"})},searchPageWise:function(a,b,c){var d=f(b,i);return e(d,{q:a,start:c})},searchSupportPagesWise:function(a,b,c){var d=f(b,i);return e(d,{q:a,start:c,site:"support"})},getDvrDetails:function(){var b,c,e;b=d(",",[["cidx","adminUser","custType","displayECM"],["hasOOL","hasDVR","hasWebDVR"],["favoriteDVR"]],"sDVRs"),c={Y:!0,N:!1},e=function(a){return _.reduce(a,function(a,b,d){return a[d]=_.isDefined(c[b])?c[b]:b,a},{})};var f=a.get(j+"userWebDVRDetailsECM.jsp?time=1").then(function(a){var c=e(b(_.str.trim(a.data)));return c},function(a){var b=g(a.data);return b?b:"DVR error--"});return f}};return m}]),angular.module("serverUserAgentService",["config"]).factory("ServerUserAgent",["$http","Config","$q",function(a,b){var c=b.getValuesBySelector("endpoint.api.useragent"),d=function(){this.getServerUserAgent=_.once(function(){return a({method:"GET",url:c}).then(function(a){return a.data},function(){return""})})};return new d}]),angular.module("serviceAppointmentUtils",["ngResource"]).factory("ServiceAppointmentUtils",["$resource","$http",function(){var a=["8:00am","8:15am","8:30am","8:45am","9:00am","9:15am","9:30am","9:45am","10:00am","10:15am","10:30am","10:45am","11:00am","11:15am","11:30am","11:45am","12:00pm","12:15pm","12:30pm","12:45pm","1:00pm","1:15pm","1:30pm","1:45pm","2:00pm","2:15pm","2:30pm","2:45pm","3:00pm","3:15pm","3:30pm","3:45pm","4:00pm","4:15pm","4:30pm","4:45pm","5:00pm","5:15pm","5:30pm","5:45pm","6:00pm","6:15pm","6:30pm","6:45pm","7:00pm","7:15pm","7:30pm","7:45pm","8:00pm","8:15pm","8:30pm","8:45pm","9:00pm","9:15pm","9:30pm","9:45pm","10:00pm","10:15pm","10:30pm","10:45pm","11:00pm","11:15pm","11:30pm","11:45pm","12:00am"],b={xmlToJSON:function(a){"string"==typeof a&&(a=$.parseXML(a));var b={};if(1===a.nodeType){if(a.attributes.length>0)for(var c=0;c<a.attributes.length;c++){var d=a.attributes.item(c);b[d.nodeName]=d.nodeValue}}else 3===a.nodeType&&(b=a.nodeValue);if(a.hasChildNodes())for(var e=0;e<a.childNodes.length;e++){var f=a.childNodes.item(e),g=f.nodeName;if("undefined"==typeof b[g])b[g]=this.xmlToJSON(f);else{if("undefined"==typeof b[g].push){var h=b[g];b[g]=[],b[g].push(h)}b[g].push(this.xmlToJSON(f))}}return b},truncateName:function(a){var b=23;return isMobile()&&(b=20),a&&a.length>b?(nameArr=a.split("-"),nameArr&&nameArr.length>0&&!isNaN(nameArr[nameArr.length-1])&&nameArr[nameArr.length-1].length<=4?a.substring(0,b-8)+"...-"+nameArr[nameArr.length-1]:a.substring(0,b-3)+"..."):a},errorCodeToMsg:function(a){for(var b=0;b<c.error.length;b++)if(c.error[b]===a)return b+1},getAppointmentResponse:function(){return c},noofdays:function(a,b){var c;return 4===a||6===a||9===a||11===a?c=30:(c=31,2===a&&(c=0!==b/4-parseInt(b/4,0)?28:0!==b/100-parseInt(b/100,0)?29:0!==b/400-parseInt(b/400,0)?28:29)),c},getDaysFromNumber:function(a){var b="";if(6>a||a>0)switch(a){case 0:b="Sun";break;case 1:b="Mon";break;case 2:b="Tue";break;case 3:b="Wed";break;case 4:b="Thur";break;case 5:b="Fri";break;case 6:b="Sat"}return b},parseAppointments:function(a){for(var b=[],c={},d=0;d<a.length;d++){var e=a[d].quotaGroupDayOfWeek,f=getWeekDayFull(e),g=a[d].quotaGroupDay.split("-"),h=getMonthName(g[1]),i=g[2],j=a[d].slotTimeDesc.split("-"),k=a[d].slotTime,l="",m="";j.length>1&&(l=g[0]+g[1]+g[2]+"-"+k,m=f+" "+h+" "+i+" "+a[d].slotTimeDesc,c.displayTime=m,c.timeToken=l)}return b.push(c),b},getMonthName:function(a){var b="";if(a>0||13>a)switch(a){case 1:case 1:case"1":case"01":b="January";break;case 2:case 2:case"2":case"02":b="February";break;case 3:case 3:case"3":case"03":b="March";break;case 4:case"4":case 4:case"04":b="April";break;case 5:case"5":case 5:case"05":b="May";break;case 6:case"6":case 6:case"06":b="June";break;case 7:case"7":case 7:case"07":b="July";break;case 8:case"8":case 8:case"08":b="August";break;case 9:case"9":case 9:case"09":b="September";break;case 10:case"10":b="October";break;case 11:case"11":b="November";break;case 12:case"12":b="December"}return b},getTimeLineMapping:function(b){for(var c=0;c<a.length;c++)if(a[c]===b)return c+1;return 0}};getWeekDayFull=function(a){var b="";switch(a){case"Sun":b="Sunday";break;case"Mon":b="Monday";break;case"Tue":b="Tuesday";break;case"Wed":b="Wednesday";break;case"Thu":b="Thursday";break;case"Fri":b="Friday";break;case"Sat":b="Saturday"}return b};var c={success:{general:"Completed successfully.",appointmentReschedule:"Appointment rescheduled successfully.",cancelAppointment:"Your appointment has been cancelled",thankyouMsg:"Thank you.Ut wisi enim ad minim veniam, quis nostrud exerci tation ullamcorper",nextAppMsg:"You're the next stop. We'll let you know when he or she is on the way.",nextAppMsgforListPage:"You're the next appointment",technicianArrived:"The technician has arrived."},error:{1:"System error has occurred.",2:"Account does not exist.",3:"DDPID does not exist.",4:"CRMID does not exist.",5:"DDPID is not authorized.",6:"CRMID is not authorized.",7:"No such appointment.",9:"Account pin missing or is incorrect.",10:"No such Time token exists.",11:"Desired Time is no longer available.",CancelAppointment:"Current appointment cannot be canceled.",RescheduleAppointment:"Current appointment cannot be rescheduled.",rescheduleDate:"Please select a valid date to reschedule appointment",installationWindow:"Please select a valid installation window to reschedule appointment",general:"Error occurred while getting appointment slots, Kindly close this window and try again.",ViewDetails:"Error occurred while fetching details for the selected appointment.",pacError:"Error occurred while fetching details using PAC. Please try again.",errorModalHeader:"There is a connection error.",errorModalAlertText:"Cannot connect to server",errorModalDesc:"We are unable to connect to server due to internal error. Please try after sometime.",errMsg:"Error occurred while fetching appointment details.",cancelErrMsg:"Error occurred while cancelling appointment.",errCalenderPage:"We are sorry.........lorem ipsum.",generalError:"We're sorry. Your request cannot be processed at this time.",generalErrorMsg:"Oops. It's too close to your appointment to reschedule.",generalErrorMsgCancel:"Oops. It's too close to your appointment to cancel.",oneHourErrorMsg:"This operation is no more valid, kindly close this window and refresh the underlying page.",oneHourErrorMsgonTMT:"This view is no more applicable to the appointment, kindly close the window and refresh the underlying page.",oneHourErrorMsgDetailPage:"This operation is no more valid, Please refresh the underlying page.",timeOutMsg:"Your session has timed out."},AppointmentType:{SRO:"SRO",TC:"TC"}};return getMonthName=function(a){var b="";if(a>0||13>a)switch(a){case 1:case"1":b="January";break;case 2:case"2":b="February";break;case 3:case"3":b="March";break;case 4:case"4":b="April";break;case 5:case"5":b="May";break;case 6:case"6":b="June";break;case 7:case"7":b="July";break;case 8:case"8":b="August";break;case 9:case"9":b="September";break;case 10:case"10":b="October";break;case 11:case"11":b="November";break;case 12:case"12":b="December"}return b},b}]),angular.module("serviceAppointment",["ngResource","config","serviceAppointmentUtils"]).factory("ServiceAppointment",["$resource","$http","Config","ServiceAppointmentUtils",function(a,b,c,d){var e=c.getValuesBySelector("endpoint.api.appointment"),f={getAppointments:"get_appointments",cancelAppointment:"cancel_appointments",getTimeLine:"get_timeLine",validateNewCustomer:"validate_newCustomerLogin",rescheduleAppointment:"reschedule_appointments",getAppointmentSlots:"get_availableTimeSlots"},g=d,h={handleGetService:function(a,c,d){b.get(e+d).success(function(b){a(b)}).error(function(a,b,d,e){c(a,b,d,e)})},handlePostService:function(a,c,d,f){b({method:"POST",url:e+f,data:a,headers:{"Content-Type":"application/x-www-form-urlencoded","cache-control":"no-cache"}}).success(function(a){c(a)}).error(function(a,b,c,e){d(a,b,c,e)})},validateAccountJSON:function(a,b,c){var d=f.validateNewCustomer;return this.handlePostService(a,b,c,d)},getAppointmentsJSON:function(a,b,c){var d={appointmentDetails:{AccountNumber:a}},e=f.getAppointments;return this.handlePostService(d,b,c,e)},getAppointmentCountforHeader:function(a,b,c){var d={appointmentDetails:{AccountNumber:a,PacFlag:!1}},e=f.getAppointments;return this.handlePostService(d,b,c,e)},parseAppointments:function(a){var b=[],c=a;if(null!==c)for(var d=0;d<c.length;d++){var e={},f="";e.APPOINTMENTTOKEN=c[d].appointmentToken,e.APPOINTMENTTYPE=c[d].appointmentType,e.CANRESCHEDULE=c[d].canReschedule,e.CANCANCEL=c[d].canCancel;for(var g=c[d].displayTime,h=g.split(","),i=$.trim(h[2]).split("-"),j=i.length,k=0;j>k;k++){var l="",m=i[k].substring(i[k].length-2,i[k].length),n=m.toLowerCase();if(2!==i[k].split(":").length){n=":00"+n;var o=i[k].substring(0,i[k].length-2)+n;l=o}else l=i[k].substring(0,i[k].length-2)+n;k!==j-1&&(l+=" - "),f+=l}var p=$.trim(f.split("-")[0]),q=p.substring(p.length-2,p.length).toLowerCase(),r=p.split(":");finaltime="pm"===q&&"12"!==r[0]||"am"===q&&"12"===r[0]?12+parseInt(r[0],10):r[0],e.TIME=f;var s=$.trim(g.split(",")[0])+" "+$.trim(g.split(",")[1]),t=new Date(s),u=new Date;e.isToday=t.toDateString()===u.toDateString()?!0:!1;var v=s.split(" ")[0];e.DAY=v,e.DATE="0"===s.split(" ")[2].substring(0,1)?s.split(" ")[1].substring(0,1).toUpperCase()+s.split(" ")[1].substring(1).toLowerCase()+" "+s.split(" ")[2].substring(1)+", "+s.split(" ")[3]:s.split(" ")[1].substring(0,1).toUpperCase()+s.split(" ")[1].substring(1).toLowerCase()+" "+s.split(" ")[2]+", "+s.split(" ")[3],new Date,r[1].split(" ");var w=new Date(e.DATE+" "+finaltime+":"+$.trim(r[1].substring(0,r[1].length-2))+":00");if(e.TASKCODE=c[d].taskCodesList,e.TITLE=c[d].appointmentTitle,("SRO"===e.TITLE||"Completed"===c[d].appointmentStatus)&&(e.doNotShowStatusMsg=!0),null!==c[d].estimatedDuration&&c[d].estimatedDuration.length>0){e.labelDuration="Estimated duration: ",e.duration=c[d].estimatedDuration;var x=c[d].pacDuration,y=Math.floor(x/60),z=x%60,A="";isNaN(y)||isNaN(z)||(A=1===y&&0===z?" an hour":1===y&&1===z?y+" hour "+z+" minute":1===y&&z>1?y+" hour "+z+" minutes":y>1&&1===z?y+" hours "+z+" minute":0===z?y+" hours":0===y?z+" minutes":y+" hours "+z+" minutes"),e.pacDuration=A}else e.duration="";if(e.StatusFlag=!1,null!==c[d].appointmentStatus)if("Completed"===c[d].appointmentStatus)e.StatusFlag=!0,e.StatusDetail="Completed",e.StatusMsg="Your "+e.APPOINTMENTTYPE+" appointment is complete";else if("Started"===c[d].appointmentStatus)e.StatusFlag=!0,e.StatusDetail="Started",e.StatusMsg="The technician has arrived";else if("Pending"===c[d].appointmentStatus&&c[d].nextAppointment)e.StatusFlag=!0,e.StatusDetail="Next",e.StatusMsg="You're the next appointment";else if("Pending"===c[d].appointmentStatus&&null!=c[d].eta){e.ETA=c[d].eta;var B=new Date;if(w.getTime()-B.getTime()<72e5){e.StatusFlag=!0;var C=e.ETA.toLowerCase(),D=C.split("-");e.StatusMsg="The technician will arrive today between "+D[0]+"and"+D[1]}else c[d].nextAppointment&&(e.StatusFlag=!0,e.StatusDetail="Next",e.StatusMsg="You're the next appointment")}b.push(e)}return b},cancelAppointment:function(a,b,c,d){var e={appointmentDetails:{appointmentToken:b,optimumId:a,AccountNumber:"0787210119001"}},g=f.cancelAppointment;return this.handlePostService(e,c,d,g)},rescheduleAppointment:function(a,b,c,d,e){var g={appointmentDetails:{appointmentToken:b,optimumId:a,desiredTimeToken:c,AccountNumber:"0787210511601"}},h=f.rescheduleAppointment;return this.handlePostService(g,d,e,h)},handleError:function(){},getTechTimeLine:function(a,b,c){var d=f.getTimeLine,e={appointmentDetails:{appointmentToken:a,accountNumber:"0787210119001"}};return this.handlePostService(e,b,c,d)},checkSuccessStatusCode:function(a){var b={};return a.errorCode&&0!==a.errorCode?(a.errorCode,b.error=!0,b.message=g.getAppointmentResponse().error.errMsg):(b.error=!1,b.message=""),b},getAvailableTimeSlots:function(a,b,c,d,e,g){var h={appointmentDetails:{appointmentToken:a,appointmentTitle:b,taskCodeList:c,appointmentDate:d}},i=f.getAppointmentSlots;return this.handlePostService(h,e,g,i)},getAppointmentResponse:function(){return stubAppointmentResponse},parseTime:function(a){var b=a.split(" "),c=b[0].split(":"),d=0;d=c[1]>=0&&c[1]<=14?"00":c[1]>=15&&c[1]<=29?"15":c[1]>=30&&c[1]<=44?"30":"45";var e=c[0]+":"+d+b[1];return e},parseAppointmentTime:function(a){var b,c=$.trim(a),d=c.substring(0,c.length-2),e=c.slice(-2);if(-1===d.indexOf(":"))d+=":00",b=d+e;else{var f=d.split(":")[0],g=d.split(":")[1];g=g>=0&&14>=g?"00":g>=15&&29>=g?"15":g>=30&&44>=g?"30":"45",b=f+":"+g+e}return b},get15HourCorpId:function(){return c.getValuesBySelector("serviceAppointment.bronxId")},get15HourOrderType:function(){return c.getValuesBySelector("serviceAppointment.bronxOrderType")},getTimeOutMilliSeconds:function(){return c.getValuesBySelector("serviceAppointment.timeOutMilliSeconds")}};return h}]),angular.module("CableTheftResource",["config"]).factory("CableTheftService",["$http","Config",function(a,b){var c=b.getValuesBySelector("endpoint.api.cablesupport"),d=b.getValuesBySelector("endpoint.api.support"),e=b.getValuesBySelector("endpoint.api.map"),f={success:{general:"Completed successfully."},error:{general:"Service not available at this time."}},g={suspectInfoMethod:function(a,b,c){var d={};return d.SuspectInfo={},d.SuspectInfo.FirstName=c.firstName,d.SuspectInfo.LastName=c.lastName,d.SuspectInfo.AddressLine1=c.address1,d.SuspectInfo.AddressLine2=c.address2,d.SuspectInfo.City=c.city,d.SuspectInfo.State=c.states.selected,d.SuspectInfo.Description=c.natureOfTheft,this.handlePostService(d,a,b,"theft/")},addressInfoMethod:function(a,b,c){var d=e;return this.handleGetService(d,a,b,c,"/map/geolocate/")},callUsInfoMethod:function(a,b,c){var e=d;return this.handleGetService(e,a,b,c,"number/")},getServerResponses:function(){return f},handlePostService:function(b,d,e,f){var g={};return a({method:"POST",url:c+f,headers:{"Content-Type":"application/json","X-Requested-With":"XMLHttpRequest"},data:b}).success(function(a){angular.extend(g,a),d(a)}).error(function(a){e(a)}),g},handleGetService:function(b,c,d,e,f){var g={};return a.get(b+f,{}).success(function(a){angular.extend(g,a),d(a)}).error(function(a,b,c,d){e(a,b,c,d)}),g}};return g}]),angular.module("supportService",["config"]).factory("Support",["$http","Config",function(a,b){var c=b.getValuesBySelector("endpoint.api.support_public"),d=b.getValuesBySelector("endpoint.api.user"),e={SUPPORT_NUMBER:c+"number/"},f="device/stb",g=function(){var b=function(b,c,d,e,f){var g={method:c||"GET",url:b,data:d||null,headers:f||null,transformResponse:e||null};return a(g).success(function(a){return a}).error(function(){return console.error("ERROR, unexpected response status"),null})},c=function(b,c,d,e){var f={};return a.get(e).success(function(a){angular.extend(f,a),c(a)}).error(function(a,b,c,e){d(a,b,c,e)}),f};this.getUserEquipments=function(a,b,e){var g=d+f;return console.log("API URL is : "+g),c(a,b,e,g)},this.getSupportNumber=function(a){var c=e.SUPPORT_NUMBER+(a||"");return b(c,"GET",null,null,null)}};return new g}]),angular.module("TutorialResource",["config"]).factory("TutorialService",["$http","Config",function(a,b){var c=b.getValuesBySelector("endpoint.api.cablesupport_public"),d={success:{general:"Completed successfully."},error:{general:"Service not available at this time."}},e={tutorial:function(a,b,c){return console.log("inside tutorila function"),this.handleGetService(b,c,"tutorialvideos/categories/"+a)},getStandAloneVideoInfo:function(a,b,c){return console.log("inside tutorila function"),this.handleGetService(b,c,"tutorialvideos/tutorialvideo/"+a)},getStandAloneFeaturedVideo:function(a,b,c){return console.log("inside tutorila function"),this.handleGetService(b,c,"tutorialvideos/categories/Featured/"+a)},getServerResponses:function(){return d},getSSLProxyFeedUrl:function(a){var b="";return a&&a.length>0&&(b=a,a.indexOf("http://")>-1&&(b=a.replace("http://","https://"))),b},getSSLProxyUrl:function(a){var b="";return a&&a.length>0&&a.indexOf("http://")>-1&&(b=a.replace("http://","/cdn/")),b},handleGetService:function(b,d,e){var f={};return console.log("inside get srvice : CACHEABLE_TUTORIAL_API_URL +serviceEnd : "+c+e),a.get(c+e).success(function(a){angular.extend(f,a),b(a)}).error(function(a,b,c,e){d(a,b,c,e)}),f}};return e}]),angular.module("supportedDevices",["config","oolCookie"]).factory("SupportedDevices",["$resource","Config","$rootScope","$q",function(a,b){var c=b.getValuesBySelector("endpoint.api.supportedDevices");return a(c,{},{query:{method:"JSONP",isArray:!0}})}]),angular.module("troubleshootService",["config"]).factory("troubleshoot",["$http","Config",function(a,b){var c=function(){this.logTroubleshootData=function(a,c,e,f){var g=b.getValuesBySelector("endpoint.api.cablesupport"),h=g+"/log/troubleshoot",i={troubleshootingStep:a,troubleshootingActions:c,customerTerm:e,service:f};return d(h,"POST",i,null,{"Content-Type":"application/json"})},this.modemLookup=function(){var a=b.getValuesBySelector("endpoint.api.cablesupport"),e=a+"/device/modemlookup";return d(e,"GET",null,c,{"Content-Type":"application/json"})},this.stbLookup=function(){var a=b.getValuesBySelector("endpoint.api.cablesupport"),e=a+"/device/stblookup";return d(e,"GET",null,c,{"Content-Type":"application/json"})},this.modemReset=function(a){var e=b.getValuesBySelector("endpoint.api.cablesupport"),f=e+"/device/modemreset",g={modems:[{macAddress:a}]};return console.log(g),d(f,"POST",g,c,{"Content-Type":"application/json"})};var c=function(a){return a};this.troubleshootReportIssueChat=function(a,c,e,f,g){var h=b.getValuesBySelector("endpoint.api.cablesupport"),i=h+"/rightnow/reportserviceissue",j={name:a,email:c,phone:g,productName:e,comments:f};return d(i,"POST",j,null,{"Content-Type":"application/json"})},this.troubleshootReportIssueEmail=function(a,c,e,f){var g=b.getValuesBySelector("endpoint.api.cablesupport"),h=g+"/rightnow/reportserviceissue",i={name:a,email:c,phone:e,productName:"Email - Report an Issue",comments:f};return d(h,"POST",i,null,{"Content-Type":"application/json"})};var d=function(b,c,d,e,f){return a({method:c,url:b,data:d,transformResponse:e,headers:f}).success(function(a){return a}).error(function(a){return console.error("[Troubleshoot Service] makeRequest, call failed with. HTTP"),console.error(a),null})}};return new c}]),angular.module("tvListings",["config","miniGuideResource","errorHandler","oolCookie"]).factory("formattedResponseTransformer",[function(){return function(a,b,c){return function(d){var e,f;return _.isString(d)?(e=d.split("\n"),f=[],transformed=_.reduce(e,function(c,d,e){var g=$.trim(d).split(a);return _.forEach(g,function(a,d){var g;_.isDefined(b[e])?(g=b[e][d],c[g]=a):f.push(a)}),c},{}),c&&(transformed[c]=f.join(" ")),transformed):d}}}]).factory("dvrUser",["TVListings","errorHandler","ooluser",function(a,b,c){var d={synced:!1,optimumId:c.optimumId,isPrimary:function(){return c.primary},isSecondary:function(){return!this.isPrimary()},webdvr:{areTermsAccepted:!0,areTermsRead:!1},hasHDBox:!1};return a.getUserDvrDetails(function(a){d.webdvr.areTermsAccepted=a.hasWebDVR,d.synced=!0,d.hasHDBox=-1!==a.sDVRs.indexOf("|HD|")},function(a){b(a)}),d}]).factory("TVListings",["$http","Config","MiniGuide","formattedResponseTransformer",function(a,b,c,d){var e=b.getValuesBySelector("endpoint.api.tvListingsDVR"),f=e+"popup/",g={error:[{StatusCode:-1,StatusDescription:"eventId is required"}]},h={getUserLineup:function(b,c){function d(a){return _.isString(a)?{lineupId:parseInt(_.str.trim(a),10)}:a}return a.get(e+"userLineup.jsp?time=1").then(function(a){b(d(a.data))},function(a){c(_.isObject(a)?a.data:a.toString())})},getUserDvrDetails:function(b,c){var f,g,h,i;return f=this,g=d(",",[["cidx","adminUser","custType","displayECM"],["hasOOL","hasDVR","hasWebDVR"],["favoriteDVR"]],"sDVRs"),h={Y:!0,N:!1},i=function(a){return _.reduce(a,function(a,b,c){return a[c]=_.isDefined(h[b])?h[b]:b,a},{})},a.get(e+"userWebDVRDetailsECM.jsp?time=1").then(function(a){var c=i(g(_.str.trim(a.data)));b(c)},function(a){var b=f.parseError(a.data);c(b?b:f.getUserDvrDetails.defaultError)})},getValidDirectProviderUrl:function(b,d,e,f,g){var i={};return angular.isFunction(d)||arguments.length<2?(f=d,g=e,d=!0,e=c.getHubId(!d)):(angular.isFunction(e)||arguments.length<3)&&(g=f,f=e,e=c.getHubId(!d)),f=f||angular.noop,g=g||angular.noop,h.get(b,d,e,function(b){angular.isObject(b)&&angular.isObject(b.online)&&angular.isString(b.online.directProviderUrl)&&""!==b.online.directProviderUrl?a.get(b.online.directProviderUrl,{cache:!0}).success(function(){i.url=b.online.directProviderUrl,f(b)}).error(function(){g()}):g()},g),i},get:function(b,d,e,h,i){var j,k={};return angular.isFunction(d)||arguments.length<2?(h=d,i=e,d=!0,e=c.getHubId(!d)):(angular.isFunction(e)||arguments.length<3)&&(i=h,h=e,e=c.getHubId(!d)),angular.isString(e)&&e.match(/^\d+$/)&&(e=parseInt(e,10)),d!==!0&&d!==!1&&(d=!0),angular.isNumber(e)||(e=c.getHubId(!d)),h=h||angular.noop,i=i||angular.noop,angular.isString(b)&&(b=parseInt(b,10)),!angular.isNumber(b)||isNaN(b)?(j=angular.copy(g),i(j,400,function(){},{}),j):(a.get(f,{params:{programId:b,hubId:e,isHd:d}}).success(function(a,b,c,d){angular.extend(k,a),h(a,b,c,d)}).error(function(a,b,c,d){i(a,b,c,d)}),k)},parseError:function(a){function b(a){return/^<html>/.test(a)}var c;return _.isString(a)?b(a)?c:a:c}};return h.getUserDvrDetails.defaultError="Unable to retrieve DVR user information.",h}]),angular.module("userLogin",["config","cookieLoggerService"]).factory("userLogin",["$http","Config","CookieLogger",function(a,b,c){var d=b.getValuesBySelector("endpoint.api.login"),e=d+"login/processLogin",f=d+"login/redirect",g=d+"profile/ooluser",h=d+"reauth",i={},j=function(b,c,d,e,f){var g={method:c||"GET",url:b,data:d||null,headers:f||null,transformResponse:e||null};return a(g).success(function(a){return a}).error(function(){return console.error("ERROR, unexpected response status"),null})};return i.authenticate=function(b,d,f,g,i,j){var k={id:b,password:d,referer:f,remember:!!g};j&&(k.area=j);var l=i?h:e;return a.post(l,k).then(function(a){return a.data.redirect_to},function(a){console.log("http post login error:",a),0===a.status?c.logCookies("different origin or network error on login"):405===a.status&&c.logCookies("HTTP 405 on login");var b=a.data.status,d={code:b.replace("LOGIN_RESP_FAILURE_","")};throw"TEMP_BAN"===d.code?d.ban_info=a.data.ban_info:"BAD_CREDENTIALS"===d.code&&(d.attempts_remaining=a.data.ban_info.attempts_remaining,d.failed_attempts=a.data.ban_info.failed_attempts),d})},i.redirect=function(a){return window.location=f+"?to="+a,window.location},i.refreshOoluserCookie=function(){return j(g)},i}]),angular.module("userService",["config","ngResource","ngCookies","oolCookie"]).factory("User",["$http","$resource","Config","$cookies","ooluser",function(a,b,c,d,e){var f,g=c.getValuesBySelector("endpoint.api.user"),h=c.getValuesBySelector("endpoint.api.multiAuth"),i={QNA_SYNC:"qna-sync",ACCOUNT_INFO:"accountinfo",ACCOUNT_INFO_BTM:"accountinfo/btm",CPC:"optimumid/:optimumId/cpc",IMS:"optimumid/:optimumId",OPTIMUM_IDS:"optimumid/:optimumId",GET_OPTIMUM_IDS:"optimumid",GET_TRANSFER_ACCOUNT_INFO:"transfer/account",TRANSFER_ACCOUNT_MOVE:"transfer/move",DISCO_CHECK:"disco-check",DELETE_IMS:"optimumid/:optimumId/delete",PREMIUM_TIER_DEVICE:"premiumtier/device",PREMIUM_TIER_USER:"premiumtier",SECURITY_SUITE:"secpac/order",SPAM_SCRUB:"spamscrub",SDP_POST:"user/:optimumId/sdp",CHALLENGE_QUESTIONS:"challenge_questions",BEHIND_THE_MODEM:"behind-the-modem",BEHIND_ANY_MODEM:"accountinfo/btm",BEHIND_TRUSTED_IP:"trusted-ip",CREATE_ID_TOKEN:"create-id-primary/token",OPTIMUM_ID_EXISTS:"optimumid/{optumumId}/exists",CHANGE_PASSWORD:"optimumid/:optimumId/password",CHALLENGE_INFO:"optimumid/:optimumId/challenge",CHALLENGE_INFO_POST:"optimumid/:optimumId/challenge/:questionId",CHALLENGE_INFO_UPDATE:"/user/optimumid/:optimumId/challenge/:questionId",CHALLENGE_ANSWER:"optimumid/:optimumId/challenge/check",VERIFY_TEMP_PASS:"optimumid/:optimumId/verifytemporarypassword",VERIFY_ACCOUNT:"optimumid/:optimumId/verifyaccountnumber",CHALLENGE_ANSWER_MULTIAUTH:h+"check",CUST_INFO:"custinfo",RECOVER_ID:"recoverid",RECOVER_OPTIONS:"password_reset/recovery_options",SEND_TEMPORARY_PASS:"password_reset/send_temporary_pass",PRIVACY_SETTINGS:"privacy/settings",KAPTCHA_VALIDATE:"/KaptchaValidate.jsp",TRANSFER_ACCOUNT_PREFILL:"transfer/account/prefill",OPTIMUMID_BLOCKED:"optimumid/:optimumId/isOptimumIdBlocked",USERID_BLOCKED:"optimumid/:optimumId/isUserIdBlocked",GRACECOUNT_GET:"roadblock/graceCount",GRACECOUNT_INSERT_UPDATE:"roadblock/insertUpdateCount",DISCO_ACCOUNT_NUMBER:"transfer/verifyDiscoAccountNumber"},j="",k="",l="success",m="provisioned",n="processed",o=angular.fromJson,p={BEHIND_THE_MODEM:"behindTheModem",OPTIMUM_ID:"optimumId",PREMIUM_TIER_DEVICE:"premiumTierDevice",PREMIUM_TIER_USER:"premiumTierUser",PRIVACY_SETTINGS:"privacyPreferences",SECURITY_SUITE:"secutiySuite",SIMPLE_RESPONSE:"simpleResponse",TRANSFER_ACCOUNT_INFO:"transferAccountInfo",TRANSFER_ACCOUNT_MOVE:"transferAccountMove",TRANSFER_ACCOUNT_PREFILL:"transferAccountPrefill"},q=b(g+i.IMS,{optimumId:"@id"},{query:{method:"GET",params:{optimumId:""},isArray:!1},get:{method:"GET",params:{},isArray:!1},current:{method:"GET",params:{optimumId:f},isArray:!1},save:{method:"POST",params:{},isArray:!1}}),r=b(g+i.CPC,{optimumId:"@id"},{get:{method:"GET",isArray:!1},save:{method:"POST",params:{},isArray:!1}});q.prototype.getCPC=r.prototype.$get,delete q.prototype.$current,angular.isUndefined(f)&&(q.current=function(a,b,c,d){var e=null,f={Code:400,Message:"No ooluser.optimumId in cookie"};switch(arguments.length){case 4:e=d;break;case 3:case 2:if(isFunction(b)){if(isFunction(a)){e=b;break}e=c}break;case 1:break;case 0:break;default:throw"Expected between 0-4 arguments [params, data, success, error], got "+arguments.length+" arguments."}return angular.isFunction(e)&&e(f,400,function(){},{}),f});var s=function(){var b=function(a,b){var c={isValid:!1,parsedResponse:null};try{var d=o(a);d.Code||(c.isValid=!0,c.parsedResponse=d)}catch(e){console.error("ERROR parsing => "+b),console.error(e)}return c},c=function(a){var c=b(a,p.SECURITY_SUITE),d=null;if(c.isValid){var e=c.parsedResponse,f=e.rsnCode||"",g=e.status||"",h=f.toLowerCase(),i=g.toLowerCase(),j=i!==l||h!==n&&h!==m?!1:!0;d={code:f,status:g,success:j,url:e.url}}return d},d=function(a){var c=b(a,p.OPTIMUM_ID),d=null;if(c.isValid){for(var e=c.parsedResponse,f=e._embedded.ids,g=[],h=0,i=f.length;i>h;h++){var j=f[h];g.push({firstName:j.first_name,lastName:j.last_name,isPrimary:j.is_primary,isBillpaySecondary:j.is_billpay_secondary,isParentalControlsSecondary:j.is_parental_controls_secondary,isOptimumVoiceSecondary:j.is_optimum_voice_secondary,isOVP:j.is_ovp,isCSO:j.is_cso,isOAC:j.is_oac,isOACADM:j.is_oacadm,id:j.id})}d={allowedRemaining:e.allowed_remaining,ids:g,packages:e.packages}}return d},f=function(a){var c=b(a,p.OPTIMUM_ID),d=null;if(c.isValid){var f=c.parsedResponse,g=e.p;d={ids:[{firstName:f.fname,lastName:f.lname,isPrimary:!1,isBillpaySecondary:1===g.bp?!0:!1,isParentalControlsSecondary:1===g.pc?!0:!1,isOptimumVoiceSecondary:1===g.ovps?!0:!1,id:f.id}]}}return d},k=function(a){var c=b(a,p.PREMIUM_TIER_USER),d=null;if(c.isValid){var e=c.parsedResponse,f=e.webhosting,g=e.ddns;d={hasWebhosting:f,hasDDNS:g}}return d},q=function(a){var c=b(a,p.PREMIUM_TIER_DEVICE),d=null;if(c.isValid){for(var e=c.parsedResponse,f=e._embedded&&e._embedded.devices?e._embedded.devices:[],g=[],h=0,i=f.length;i>h;h++){var j=f[h];g.push({macAddress:j.macAddress,portStatus:{port25:{isEnabled:j.port25},port80:{isEnabled:j.port80}}})}d=g}return d},r=function(a){var c=b(a,p.BEHIND_THE_MODEM),d=null;if(c.isValid){var e=c.parsedResponse;d={isBehindTheModem:e.BehindTheModem,accountNumber:e.AccountNo}}return d},s=function(a){var c=b(a,p.TRANSFER_ACCOUNT_INFO),d=null;if(c.isValid){var e=c.parsedResponse;d={accountNumber:e.account_number,idLimit:e.optimumIdLimit||0,newAccountIds:e.newAccountOptimumIds||[],serviceLevel:e.newAccountServiceLevel||"",currentAccountIds:e.currentAccountOptimumIds||[],status:e.status||"",message:e.message||""}}return d},t=function(a){var c=b(a,p.TRANSFER_ACCOUNT_MOVE),d=null;if(c.isValid){var e=c.parsedResponse;d=e}return d},u=function(a){var c=b(a,p.TRANSFER_ACCOUNT_MOVE),d=null;if(c.isValid){var e=c.parsedResponse;return e}return d},v=function(a){var c=b(a,p.TRANSFER_ACCOUNT_PREFILL),d=null;if(c.isValid){var e=c.parsedResponse;d={accountNumber:e.account_number||"",isPrimary:e.primary||!1,status:e.status.toUpperCase()}}return d},w=function(b,c,d,e,f){return a({method:c,url:b,data:d,transformResponse:e,headers:f}).success(function(a){return a}).error(function(a){return console.error("[User Service] makeRequest, call failed with. HTTP"),console.error(a),null})},x=function(a){var c=b(a,p.PRIVACY_INFO),d=null;if(c.isValid){var e=c.parsedResponse,f=e.recommendations,g=e.promotions;d={recommend:f,promo:g}}return d};return this.postRecoverId=function(a,b,c){var d=g+i.RECOVER_ID,e={type:a};return"accountinfo"===a&&c?(e.lname=c.lname,e.phone=c.phone,e.account_number=b):e.value=b,w(d,"POST",e,null,{"Content-Type":"application/json"})},this.qnaSync=function(){var a=g+i.QNA_SYNC;return w(a,"POST",null,null,null)},this.setSpamScrubOption=function(a){var b=g+i.SPAM_SCRUB,c="spamOption="+a;return w(b,"POST",c,null,{"Content-Type":"application/x-www-form-urlencoded"})},this.getSpamScrubOption=function(){var a=g+i.SPAM_SCRUB;return w(a,"GET",null,null)},this.getOptimumIds=function(a,b){var c=g+i.GET_OPTIMUM_IDS,e={};return c+=a?"/"+a:"",e=a?f:d,c+="?useCache="+(b?"true":"false"),c+="&fields=package",w(c,"GET",null,e,null)},this.getSecuritySuiteDownloadUrl=function(){var a=g+i.SECURITY_SUITE;return w(a,"POST",null,c,null)},this.getIMS=function(a){var b=g+i.IMS.replace(/:optimumId/,a);return w(b,"GET",angular.isNumber(j)?{cache:j}:null,null,null)},this.getChallengeInfoByToken=function(a,b){var c=g+i.CHALLENGE_INFO.replace(/:optimumId/,a)+"?token="+b;return w(c,"GET",{token:b},null,null).then(function(c){var d=_.map(c.data.questions,function(a){return{id:a.questionId,question:a.question}});return{questions:d,required:c.data.required,id:a,token:b}},function(){throw"UNRECOVERABLE_ERROR"})},this.getUserChallengeQuestions=function(b){var c=(new Date).getTime(),d=i.CHALLENGE_INFO.replace(/:optimumId/,b)+"?cachebreak="+c;return a.get(g+d)},this.isUserIdBlocked=function(b){var c=h+i.USERID_BLOCKED.replace(/:optimumId/,b);return a.get(c)},this.IsOptimumIdBlocked=function(a){var b={optimumId:a},c=g+i.OPTIMUMID_BLOCKED.replace(/:optimumId/,a);return w(c,"POST",b,null,{"Content-Type":"application/json"})},this.postUpdateSecurityQuestion=function(a,b,c){var d=i.CHALLENGE_INFO_UPDATE.replace(/:optimumId/,a);d=i.CHALLENGE_INFO_UPDATE.replace(/:questionId/,b);var e={questionId:b,answer:c};return w(d,"POST",e,null,{"Content-Type":"application/json"})},this.getPremiumTierDevice=function(){var a=g+i.PREMIUM_TIER_DEVICE;return w(a,"GET",null,q,null)},this.setPremiumTierDevice=function(a,b,c){var d=g+i.PREMIUM_TIER_DEVICE+"/"+a,e={_links:{self:{href:"/user/premiumtier/device/"+a}},"mac-address":a,port80:c,port25:b};return w(d,"POST",e,null,{"Content-Type":"application/json"})},this.getPremiumTierUser=function(){var a=g+i.PREMIUM_TIER_USER;return w(a,"GET",null,k,null)},this.setPremiumTierUser=function(a,b){var c=g+i.PREMIUM_TIER_USER,d="1=1";a.ddns?d+="&ddns=enabled":b.ddns&&(d+="&ddns=disabled"),a.webhosting?d+="&webhosting=enabled":b.webhosting&&(d+="&webhosting=disabled");var e={"Content-Type":"application/x-www-form-urlencoded"};return w(c,"POST",d,null,e)},this.getRecoveryOptions=function(a,b,c){var d={optimumId:a,challenge:b,answer:c},e=g+i.RECOVER_OPTIONS;return w(e,"POST",d,null,{"Content-Type":"application/json"}).then(function(a){return{email:a.data.email,phone:a.data.phone,emailHint:a.data.emailHint,phoneHint:a.data.phoneHint,token:a.data.token}
},function(a){if(a.status>=500)throw"UNRECOVERABLE_ERROR";throw a.data.errorCode})},this.getKaptchaKey=function(){var b,c=new Date;console.log("Sending request to get kaptcha key!!!");var d=a.get(i.KAPTCHA_VALIDATE+"?cachebrk="+c.getTime()).then(function(a){return a||console.log("Getting invalid response from KaptchaValidate.jsp=="+a),console.log("Getting success response from KaptchaValidate.jsp=="+a.data),b=a.data},function(a){return console.log("Getting Error response from KaptchaValidate.jsp=="+a.data),b="kaptcha_error"});return d},this.sendTemporaryPassword=function(a,b,c){var d={token:c};"email"===a?(d.email=b,d.phone=""):"phone"===a&&(d.email="",d.phone=b);var e=g+i.SEND_TEMPORARY_PASS;return w(e,"POST",d,null,{"Content-Type":"application/json"}).then(function(a){if(!a.data.status)throw new Error("Incorrect value for reset method")},function(a){if(400===a.status)throw"BAD_REQUEST";if(429===a.status)throw"THROTTLED";throw"UNRECOVERABLE_ERROR"})},this.verifyTemporaryPassword=function(a,b){var c={tempPass:b},d=g+i.VERIFY_TEMP_PASS.replace(/:optimumId/,a);return w(d,"POST",c,null,{"Content-Type":"application/json"}).then(function(a){var b=a.data.message;if("SUCCESS"===b)return a.data.token;throw"BAD_ANSWER"},function(a){if(a.status>=500)throw"UNRECOVERABLE_ERROR";throw"NOT_AUTHORIZED"})},this.checkSecurityQuestions=function(a,b,c){var d={token:b,questions:_.map(c,function(a){return{questionId:a.id,answer:a.answer}})},e=g+i.CHALLENGE_ANSWER.replace(/:optimumId/,a);return w(e,"POST",d,null,{"Content-Type":"application/json"}).then(function(a){var b=a.data.message;if("SUCCESS"===b)return a.data.token;throw"BAD_ANSWER"},function(a){if(a.status>=500)throw"UNRECOVERABLE_ERROR";throw"NOT_AUTHORIZED"})},this.verifyAccountNumber=function(a,b,c){var d={token:b,accountNumber:c},e=g+i.VERIFY_ACCOUNT.replace(/:optimumId/,a);return w(e,"POST",d,null,{"Content-Type":"application/json"}).then(function(a){var b=a.data.message;if("SUCCESS"===b)return a.data.token;throw"BAD_ANSWER"},function(a){if(a.status>=500)throw"UNRECOVERABLE_ERROR";throw"NOT_AUTHORIZED"})},this.checkSecurityQuestionUntrustedIP=function(a,b){var c={questionId:a,answer:b},d=i.CHALLENGE_ANSWER_MULTIAUTH;return w(d,"POST",c,null,{"Content-Type":"application/json"}).then(function(a){var b=a.data.message;"SUCCESS"!==b&&console.error("[User Service] checkSecurityQuestionUntrustedIP -  FAILED 200, Unkown response body from service: ",a.data)},function(a){throw console.error("[User Service] checkSecurityQuestionUntrustedIP - FAILED "+a.status+", response: ",a),a})},this.changePasswordAfterQuestions=function(a,b,c){var d={newPass:c,token:b},e=g+i.CHANGE_PASSWORD.replace(/:optimumId/,a);return w(e,"POST",d,null,{"Content-Type":"application/json"}).then(function(a){return a},function(a){switch(a.status){case 400:throw{code:"BAD_PASS",message:a.data.Message};case 401:throw{code:"UNAUTHORIZED",message:""};default:throw{code:"UNKNOWN_ERROR",message:""}}})},this.deleteOptimumId=function(a){var b=g+i.GET_OPTIMUM_IDS+"/"+a;return w(b,"DELETE",null,null,null)},this.saveEntitlements=function(a){var b=g+i.GET_OPTIMUM_IDS+"/"+this.id+"/sdp";console.log("Changed Entitlement=="+a);var c={_links:{self:{href:"/user/optimumid/"+this.id+"/sdp"}},entitlements:{is_billpay_secondary:this.isBillpaySecondary,is_parental_controls_secondary:this.isParentalControlsSecondary}};return"isOptimumVoiceSecondary"===a&&(c.entitlements.is_optimum_voice_secondary=this.isOptimumVoiceSecondary),w(b,"POST",c,null,null)},this.getIsBehindTheModem=function(){var a=g+i.BEHIND_THE_MODEM;return w(a,"GET",null,r,null)},this.getIsBehindAnyModem=function(){var a=g+i.BEHIND_ANY_MODEM;return w(a,"GET",null,null,null)},this.getPrivacySettings=function(){var a=g+i.PRIVACY_SETTINGS;return w(a,"GET",null,x,null)},this.setPrivacySettings=function(a,b){var c=g+i.PRIVACY_SETTINGS,d={_links:{self:{href:"/user/privacy/settings"}},recommendations:a,promotions:b};return w(c,"POST",d,null,null)},this.getTransferAccountInfo=function(a,b,c){var d=g+i.GET_TRANSFER_ACCOUNT_INFO,e={_links:{self:{href:"/user/transfer/account/"}},account_number:a,lname:b,phone:c};return w(d,"POST",e,s,{"Content-Type":"application/json"})},this.transferAccountMove=function(a,b,c,d,e,f){var h=g+i.TRANSFER_ACCOUNT_MOVE,j={_links:{self:{href:"/user/transfer/move"}},account_number:a,lname:b,phone:c,moveOptimumIds:d,primaryOptimumId:e,deleteOptimumIds:f};return w(h,"POST",j,t,{"Content-Type":"application/json"})},this.discoCheck=function(){var a=g+i.DISCO_CHECK;return w(a,"GET",null,u)},this.getTransferAccountPrefill=function(){var a=g+i.TRANSFER_ACCOUNT_PREFILL;return w(a,"GET",null,v)},this.getSanitizedPrincipal=function(a){return $.trim(a.replace(/@.*/,"").toLowerCase())},this};return this.verifyDiscoAccountNumber=function(b,c){var d=g+i.DISCO_ACCOUNT_NUMBER;return a.get(d+"?accountNumber="+b+"&token="+c)},s.query=q.query,s.get=q.get,s.current=q.current,s.getChallengeQuestions=function(b){var c={};return"undefined"!=typeof b&&(c["X-OOL-Token"]=b),a.get(g+i.CHALLENGE_QUESTIONS,{headers:c})},s.getBehindTheModem=function(){return a.get(g+i.BEHIND_THE_MODEM)},s.getBehindTrustedIp=function(){return a.get(g+i.BEHIND_TRUSTED_IP)},s.isDisconnected=function(){return a.get(g+i.DISCO_CHECK)},s.getBtmAccountInfo=function(){return a.get(g+i.ACCOUNT_INFO_BTM)},s.getGraceCount=function(){return a.get(g+i.GRACECOUNT_GET)},s.insertUpdateGraceCount=function(){return a.get(g+i.GRACECOUNT_INSERT_UPDATE)},s.getCreateIdToken=function(b,c,d){var e={AccountNo:b,LastName:c,HomePhoneNo:d},f=function(a){return angular.toJson(a)};return a.post(g+i.CREATE_ID_TOKEN,e,{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},transformRequest:f})},s.getAccountInfo=function(){var b=g+"accountinfo";return a.get(b)},s.getOptimumIds=function(b){var c=g+"optimumid/?fields=package";return"undefined"==typeof b||b||(c+="&useCache=false"),a.get(c)},s.getIMS=function(b){return a.get(g+"optimumid/"+b)},s.getCPC=function(b){return a.get(g+"optimumid/"+b+"/cpc"+(angular.isNumber(k)?"?cache="+k:""))},s.setCPC=function(b,c){return k=(new Date).getTime(),a.post(g+"optimumid/"+b+"/cpc",c)},s.postIMS=function(b,c){return j=(new Date).getTime(),a.post(g+"optimumid/"+b,c)},s.updatePassword=function(b,c){return a.post(g+"optimumid/"+b+"/password",c)},s.changePrimaryName=function(b){return a.post(g+"name_change",b)},s.getOptimumIdExists=function(b,c){var d=g+i.OPTIMUM_ID_EXISTS.replace(/\{optumumId\}/,b);return a.get(d,{headers:{"X-OOL-Token":c}})},s.createOptimumId=function(b,c,d,e,f,h,j,k,l,m,n,o,p){var q=i.OPTIMUM_IDS.replace(/:optimumId/,b),r={_links:{self:{href:"/user/"+q}},id:b,userType:c,fname:d,lname:e,zipcode:f,passwd:h,enable_billpay:m,enable_parental_controls:n,enable_optimum_voice:o,passwd_reset:[{type:"email",value:"undefined"==typeof j?"":j},{type:"phone",value:"undefined"==typeof k?"":k}],questions:[]};for(var s in l)r.questions.push({_links:{self:{href:"/user/"+q+"/challenge/"+s}},questionId:s,answer:l[s]});var t=function(a){return angular.toJson(a)},u={};return u=p?{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8","X-OOL-Token":p}:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},a.put(g+q,r,{headers:u,transformRequest:t})},s.getCustInfo=function(b){var c={};return"undefined"!=typeof b&&(c["X-OOL-Token"]=b),a.get(g+i.CUST_INFO,{headers:c})},s.postChallengeQuestions=function(b,c,d){var e=i.CHALLENGE_INFO.replace(/:optimumId/,b),f={_links:{self:{href:"/user/"+e+"/challenge"}},questions:[],deleteGrace:d};for(var h in c)f.questions.push({questionId:h,answer:c[h]});var j=function(a){return angular.toJson(a)};return a.post(g+e,f,{headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},transformRequest:j})},e._userService=s,s}]),angular.module("vod",["config"]).factory("Vod",["$http","Config",function(a,b){var c=b.getValuesBySelector("endpoint.api.vod");return{getTopPicks:function(){return a({method:"GET",url:c+"getTopPicks"})}}}]),angular.module("weather",["ngResource","config","jssi"]).factory("Weather",["$resource","Config","CacheKeyURL",function(a,b,c){var d=c(b.getValuesBySelector("endpoint.api.weather")+"?zip=@Zipcode@");return a(d,{},{})}]),angular.module("webdvrResource",["ngResource","config","oolCookie","dvrRecordingModel"]).value("WebDVRs",[]).factory("WebDVR",["$resource","$http","$q","Config","ooluser","WebDVRs","recordingModel",function(a,b,c,d,e,f,g){function h(a){return Math.floor(moment().valueOf()/a)}angular.toJson,angular.fromJson;var i=e.optimumId||"",j=d.getValuesBySelector("endpoint.api.dvr")+"json/webdvrservicejson.do",k=d.getValuesBySelector("endpoint.api.dvr")+"epg/webdvrRequest.jsp",l=d.getValuesBySelector("webDVR.allowMultipleDVRLookup"),m=a(j,{},{});return m.create=function(a){return new m(a)},m.prototype.$get=function(a,d){function e(a){return{method:"getBoxState",boxSerialNumber:a.boxSerialNumber,boxMACAddress:""}}function f(a){return a.errorMsg}function g(a){return"SUCCESS"===a.data.errorMsg}a=a||angular.noop,d=d||angular.noop;var h=this;return b.get(j,{params:e(h),cache:!1}).then(function(a){return g(a)?a:c.reject(f(a.data))}).then(function(b){var c=b.data.boxData;return c.boxSerialNumber=b.data.boxSerialNumber,c.boxMACAddresponses=b.data.boxMACAddresponses,c.homeId=b.data.homeId,_.extend(h,c),a(h)},function(a){return reporting.setAttrs({prop35:"Error at DVR box information check"}),reporting.sendAttrs(!0),d(a)}),this},m.query=function(a,c,d){var g={method:"getAlias"};return a=a||angular.noop,c=c||angular.noop,e.hasOOLSession?(d&&(g.killable=!0),b.get(j,{params:g,cache:!0}).then(function(b){f.length=0,angular.forEach(b.data.stb,function(a){f.push(m.create(a))}),a(f)},function(a){var b;angular.isObject(a)?angular.isObject(a.data)?b=a.data.Message:angular.isString(a.data)&&(b=a.data):b=a,c(b)}),f):(c({Message:"No session.  Login required.",description:"",debug:{exception:"",exceptionMessage:"",requestScope:""}}),void 0)},m.queryMultipleDVRs=function(a,b,c){function d(b){_.each(b,function(b){var c=b.SchProgElement;c.isRecorded=!1,c=g(c),f.length<a&&c.isDependable&&f.push(c)})}var e=4,f=[];return angular.isString(a)&&a.match(/^\d$/)&&(a=parseInt(a,10)),angular.isFunction(a)&&(c=b,b=a,a=e),(!angular.isNumber(a)||1>a)&&(a=e),angular.isFunction(b)||(b=angular.noop),angular.isFunction(c)||(c=angular.noop),l?m.query(function(e){var g,h=0,i=function(){h<g.length&&f.length<a?g[h].query({scheduled:!0},function(a){d(a),h++,i()},function(a){c(a)}):angular.isFunction(b)&&b(f)};e.length?(g=_.map(e,function(a){return a.recording(!0)}),i()):b(f)},function(a){c(a)},!0):m.prototype.recording.call(null,!0).query({scheduled:!0},function(a){d(a),b(f)},function(a){c(a)}),f},m.prototype.recording=function(e){var f=this,g={},l=a(j,{},g);return l.create=function(a){var b=a.RecordedProgElement?"RecordedProgElement":"SchProgElement",c=a[b];return c.id=_.uniqueId(),angular.isArray(c.ImageList)&&_.each(c.ImageList,function(a){angular.isObject(a)&&angular.isString(a.ImgUrl)&&(a.ImgUrl=a.ImgUrl.replace(/^http:\/\/([^\/]+)/,"/iptv-proxy/$1/"))}),new l(a)},l.parseError=function(a){function b(a){return-1!==a.search(/^<html>/)}var c;if(_.isString(a)&&b(a))return c;var d;return _.isString(a)&&(a.indexOf(":")>0?d=$.trim(a).split(": ")[1]:a.indexOf("|")>0&&(d=$.trim(a).split("|")[1])),"null"===d?c:d},l.prototype.$save=function(a,d,e){function g(a){return l.parseError(a)}function h(a){return-1!==$.trim(a.data).search(/SUCCESS$/)}void 0===e?(e=d||angular.noop,d=a||angular.noop):(a=a||{},d=d||angular.noop,e=e||angular.noop);var i=this,j=_.extend(_.clone(i),a,{request_type:"REQUEST_RECORDING",serial_number:f.boxSerialNumber});return b.post(k,null,{params:j}).then(function(a){return h(a)?a:c.reject(g(a.data))},function(){return c.reject()}).then(function(){return d(i)},function(a){return reporting.setAttrs({prop35:"Error scheduling recording"}),reporting.sendAttrs(!0),e(a)}),this},l.query=function(a,c,g){a=a||{},c=c||angular.noop,g=g||angular.noop;var j=[],k={request_type:a.scheduled?"GET_SCHEDULED_RECORDINGS":"GET_RECORDED_PROGRAMS",isVODRequest:"FALSE",os:"6.0",isLinearRequest:15,optimum_id:i,hubId:4,deviceType:"Web",artName:"net_poster_67x89",deviceId:"2288baff6e7835065fbb696130d0111d1d739173",cacheId:a.cacheId||h(3e4)};return null!==f&&(k.serial_number=f.boxSerialNumber),e&&(k.killable=!0),b.get(d.getValuesBySelector("endpoint.api.dvr")+"epg/DVRRequest.jsp",{params:k}).then(function(b){var d=a.scheduled?b.data.result.SchProgMap:b.data.result.RecordedProgList;j.length=0,angular.forEach(_.filter(d,function(a){var b=a.RecordedProgElement?"RecordedProgElement":"SchProgElement",c=a[b];return c.Title&&angular.isObject(c.Program)&&c.Program.callsign&&c.Program.StartTime&&c.Program.EndTime?!0:!1}),function(a){j.push(l.create(a))}),c(j)},function(a){g(a.data.StatusMessage),reporting.setAttrs({prop35:"Error scheduling recording"}),reporting.sendAttrs(!0)}),j},l.destroyAll=function(a,c,d){c=c||angular.noop,d=d||angular.noop;var e,g,h;e=[],g=!!a[0].RecordedProgElement,h=g?"RecordedProgElement":"SchProgElement";var i=_.map(a,function(a){var b,c,d,e,f;return b=a[h].Program,c="MM-DD-YY HHmmss",d=moment(b.StartTime,c).valueOf(),e=moment(b.EndTime,c).valueOf(),f=e-d,{isRecorded:g,program:{callSign:b.callsign,startTime:d,endTime:e,programLength:f,channelNumber:b.ChannelNumber}}}),k={method:g?"eraseMultipleRecordingsRecorded":"eraseMultipleRecordingsScheduled",arguments:{boxSerialNumber:f.boxSerialNumber,boxMACAddress:"",programs:i}};return b.post(j,k).then(function(a){if("null"!==a.data){var b=g?a.data.recordedProgram:a.data.scheduledProgram;if(void 0!==b&&"undefined"!==b){var f=0;angular.forEach(i,function(a){angular.forEach(b,function(b){return b.program.callSign===a.program.callSign&&b.program.startTime===a.program.startTime&&b.program.channelNumber===a.program.channelNumber&&b.program.programLength===a.program.programLength?(d(b.title),reporting.setAttrs({prop35:"Error cancelling or deleting a recording"}),f++,!1):void 0})}),f>0?reporting.sendAttrs(!0):c(e)}else d(a.data.errorMsg),reporting.setAttrs({prop35:"Error cancelling or deleting a recording"}),reporting.sendAttrs(!0)}else d("Please try again later"),reporting.setAttrs({prop35:"Error cancelling or deleting a recording"}),reporting.sendAttrs(!0)},function(a){d(a.data.errorMsg),reporting.setAttrs({prop35:"Error cancelling or deleting a recording"}),reporting.sendAttrs(!0)}),e},l.destroySingle=function(a,c,d){c=c||angular.noop,d=d||angular.noop;var e,g,h,i,k,l,m=[],n=[];e="YYYYMMDD HHmmss",g=moment(a.start_time,e).valueOf(),h=moment(a.end_time,e).valueOf(),l=moment(a.startTime,"MM-DD-YY HHmm").valueOf(),k=a.call_sign,i=h-g;var o={isRecorded:!1,program:{callSign:k,startTime:l,endTime:h,programLength:i}};n.push(o);var p={method:"eraseMultipleRecordingsScheduled",arguments:{boxSerialNumber:f.boxSerialNumber,boxMACAddress:"",programs:n}};return b.post(j,p).then(function(a){if("null"!==a.data){var b=a.data.scheduledProgram;angular.forEach(b,function(a){m.push(a)}),c(m)}else d("Sorry, we are not able to cancel at this moment. Please try again later"),reporting.setAttrs({prop35:"Error cancelling or deleting a recording"}),reporting.sendAttrs(!0)},function(a){d(a.data.errorMsg)}),m},l},m.setBoxAlias=function(a,c){return b.post(j,{method:"setAlias",arguments:{boxSerialNumber:a,boxAlias:c}})},m.getAllAlias=function(){return b.get(j,{params:{method:"getAlias",arguments:{}}})},m.setFavorite=function(a,c){return b.post(j,{method:"setFavorite",arguments:{optimumId:a,boxSerialNumber:c,boxMACAddress:""}})},m.setBlacklist=function(a,c){return b.post(j,{method:"setBlacklist",arguments:{boxSerialNumber:a,blacklists:c}})},m.signup=function(a,c){return b.post(j,{method:"signup",arguments:{}}).then(function(b){a(b.data)},function(a){c(a.data)})},m.gteSDHDMapping=function(){var a={request_type:"GET_SD_HD_MAP",serial_number:""};return b.get(k,{params:a})},m}]),angular.module("webmailService",["config","oolCookie"]).factory("Webmail",["$http","$rootScope","Config","ooluser",function(a,b,c,d){var e=c.getValuesBySelector("endpoint.api.webmail"),f={WEBMAIL_DETAILS:e+"Webmail/Webmail_Details"},g=d.eoid?d.eoid:"";subjectLines=function(a,c){var d=/<\s*[a-z0-9!#$%&'*+\/=?\^_`{|}~\-]+(?:\.[a-z0-9!#$%&'*+\/=?\^_`{|}~\-]+)*@(?:[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9\-]*[a-z0-9])?\s*>/i,e=["answered","flagged","draft","deleted","seen","forwarded","unseen"],f=[],g={webmail:[],wasSuccessful:!0};if(a&&a.length){for(var h=0,i=a.length;i>h;h++){var j=a[h];j&&(j[1].split(" "),f.push({from:j[2].replace(d,""),subject:j[0],body:"",date:moment(j[1],"MM/DD/YY HH:mm a"),status:j[3]&&_.contains(e,j[3].toLowerCase())?j[3].toLowerCase():"seen"}))}g.messageCount=c||0,g.webmail=f,g.wasSuccessful=!0,g.dateFormat={calendar:{lastDay:"[Yesterday]",sameDay:"h:mm a",nextDay:"M/D",lastWeek:"dddd",nextWeek:"M/D",sameElse:"M/D"}}}else g.wasSuccessful=!1;b.$emit("webmailDetailsResponse",g)},mailReady=function(){b.$emit("webmailDetailsResponse",{wasSuccessful:!1})};var h=function(){var b=function(b){return a({method:"JSONP",url:b})};return this.getEmailDetails=function(){var a=f.WEBMAIL_DETAILS+"?eoid="+g;return b(a)},this};return new h}]),angular.module("wifiService",["config","oolCookie"]).factory("Wifi",["$http","Config","ooluser",function(a,b,c){var d=function(){var d=b.getValuesBySelector("endpoint.api.wifi"),e=angular.fromJson,f={ADD_DEVICE:"device/addDevice",DELETE_DEVICE:"device/deleteDevice",DEVICE_INFORMATION:"device/reg",OOLTIER_INFORMATION:"device/regstatus",SESSION_USAGE:"getSessionUsage",UPDATE_DEVICE:"device/updateDevice"},g="success",h={DEVICE_INFORMATION:"deviceInformation",SIMPLE:"simpleResposne",WIFI_USAGE:"wifiSessionUsage"},i=1048576,j=86400,k={MTD:"MTD",LAST_THIRTY_DAYS:"LAST_THIRTY_DAYS"},l=c.eoid?c.eoid:"",m=function(a,b){var c={isValid:!1,parsedResponse:null};try{var d=e(a);c.isValid=!0,c.parsedResponse=d}catch(f){console.error("ERROR parsing => "+b),console.error(f)}return c},n=function(a){var b=m(a,h.SIMPLE),c=null;if(b.isValid){var d=b.parsedResponse,e=parseInt(d.status,10),f=d.message.toLowerCase(),i=0===e&&f===g?!0:!1;c={message:f,status:e,success:i}}return c},o=function(a){var b=m(a,h.WIFI_USAGE),c=null;if(b.isValid&&b.parsedResponse.usage){var d=b.parsedResponse.usage,e=d.total,f=parseInt(e["@bytes"],10),g=parseInt(e["@seconds"],10),l=Math.round(g/j),n=1>l?1:l,o=d["@timePeriod"]===k.LAST_THIRTY_DAYS?"30":n;c={usage:{total:{bytes:f,bytesInMB:parseInt((f/i).toFixed(0),10),locations:parseInt(e["@activeSessions"],10),devices:parseInt(e["@devices"],10),seconds:g,days:o}},hasUsage:f>0?!0:!1}}return c},p=function(a){var b=m(a,h.DEVICE_INFORMATION),c=null;if(b.isValid&&b.parsedResponse._embedded){for(var d=b.parsedResponse._embedded.devices,e=[],f=0,g=d.length;g>f;f++){var i=d[f],j=i.email&&i.macAddress&&i.name&&i.type;j&&e.push({email:i.email,macAddress:i.macAddress,name:i.name,type:i.type,registeredBy:i.registeredBy})}c={devices:e,registrationStatus:b.parsedResponse._embedded.registrationStatus}}return c},q=function(a){var b=m(a,h.DEVICE_INFORMATION),c=null;return b.isValid&&b.parsedResponse._embedded&&(c={registrationStatus:b.parsedResponse._embedded.registrationStatus}),c},r=function(b,c,d,e,f){var g={method:c||"GET",url:b,data:d||null,headers:f||null,transformResponse:e||null};return a(g).success(function(a){return a}).error(function(){return console.error("ERROR, unexpected response status"),null})};return this.addDevice=function(a){var b=d+f.ADD_DEVICE;return r(b,"PUT",a,n,{"Content-Type":"application/json"})},this.deleteDevice=function(a){var b=d+f.DELETE_DEVICE;return r(b,"DELETE",a,null,{"Content-Type":"application/json"})},this.getDeviceInformation=function(){var a=(new Date).getTime(),b=d+f.DEVICE_INFORMATION+"?cachebreak="+a;return r(b,null,null,p,null)},this.getSessionUsage=function(){var a=d+f.SESSION_USAGE+"?timePeriod="+k.LAST_THIRTY_DAYS+"&eoid="+l;return r(a,null,null,o,null)},this.updateDevice=function(a){var b=d+f.UPDATE_DEVICE;return r(b,"POST",a,n,{"Content-Type":"application/json"})},this.getOOLTierInformation=function(){var a=(new Date).getTime(),b=d+f.OOLTIER_INFORMATION+"?cachebreak="+a;return r(b,null,null,q,null)},this};return new d}]);